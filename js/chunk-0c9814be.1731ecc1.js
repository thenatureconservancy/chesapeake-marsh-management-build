(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0c9814be","chunk-59f29c8d"],{"0dfa":function(e,a,t){"use strict";t.d(a,"a",(function(){return d})),t.d(a,"b",(function(){return u})),t.d(a,"c",(function(){return c})),t.d(a,"d",(function(){return s})),t.d(a,"e",(function(){return o}));var r=t("8188"),n=t("5996"),l=t("9786");async function i(e){const a=e.spatialReference;if(a.isWGS84)return e.clone();if(a.isWebMercator)return Object(l["e"])(e);const t=n["a"].WGS84;return await Object(r["f"])(a,t),Object(r["j"])(e,t)}function u(e,a){if(!s(e,a)){const t=e.typeKeywords;t?t.push(a):e.typeKeywords=[a]}}function s(e,a){var t;return!(null==(t=e.typeKeywords)||!t.includes(a))}function o(e,a){const t=e.typeKeywords;if(t){const e=t.indexOf(a);e>-1&&t.splice(e,1)}}async function c(e){const a=e.clone().normalize();let t;if(a.length>1)for(const r of a)t?r.width>t.width&&(t=r):t=r;else t=a[0];return i(t)}const d={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table"}},"15ec":function(e,a,t){"use strict";t.d(a,"a",(function(){return l})),t.d(a,"b",(function(){return i}));var r=t("e041"),n=t("0224");function l(e){return{origin:"portal-item",url:Object(r["M"])(e.itemUrl),portal:e.portal||n["a"].getDefault(),portalItem:e,readResourcePaths:[]}}function i(e){return{origin:"portal-item",messages:[],writtenProperties:[],url:e.itemUrl?Object(r["M"])(e.itemUrl):null,portal:e.portal||n["a"].getDefault(),portalItem:e}}},2698:function(e,a,t){"use strict";function r(e){return e&&"getAtOrigin"in e&&"originOf"in e}t.d(a,"a",(function(){return r}))},"4cf4":function(e,a,t){"use strict";t.r(a),t.d(a,"fetchFeatureService",(function(){return m})),t.d(a,"fromUrl",(function(){return o}));var r=t("2eab"),n=t("ce50"),l=t("b2b2"),i=t("e041"),u=t("54b4"),s=t("a0b4");async function o(e){var a;const r=null==(a=e.properties)?void 0:a.customParameters,n=await y(e.url,r),l={...e.properties,url:e.url};if(!n.sublayerIds)return null!=n.layerOrTableId&&(l.layerId=n.layerOrTableId,l.sourceJSON=n.sourceJSON),new n.Constructor(l);const i=new(0,(await t.e("chunk-2d0c8892").then(t.bind(null,"54fc"))).default)({title:n.parsedUrl.title});return d(i,n,l),i}function c(e,a){return e?e.find(e=>e.id===a):null}function d(e,a,t){function r(e,r){const n={...t,layerId:e,sublayerTitleMode:"service-name"};return Object(l["k"])(r)&&(n.sourceJSON=r),new a.Constructor(n)}a.sublayerIds.forEach(t=>{const n=r(t,c(a.sublayerInfos,t));e.add(n)}),a.tableIds.forEach(t=>{const n=r(t,c(a.tableInfos,t));e.tables.add(n)})}async function y(e,a){let t=Object(u["e"])(e);if(Object(l["j"])(t)&&(t=await f(e,a)),Object(l["j"])(t))throw new n["a"]("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:e});const{serverType:r,sublayer:i}=t;let s;const o={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"};switch(r){case"MapServer":s=null!=i?"FeatureLayer":v(e,a).then(e=>e?"TileLayer":"MapImageLayer");break;case"ImageServer":s=O(e,{customParameters:a}).then(e=>{const a=e.tileInfo&&e.tileInfo.format;return e.tileInfo?"LERC"!==(null==a?void 0:a.toUpperCase())||e.cacheType&&"elevation"!==e.cacheType.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer"});break;case"SceneServer":s=O(t.url.path,{customParameters:a}).then(e=>{if(e){if("Voxel"===(null==e?void 0:e.layerType))return"VoxelLayer";if(null!=e&&e.layers&&Array.isArray(e.layers)&&e.layers.length>0){var a;const t={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"},r=null==(a=e.layers[0])?void 0:a.layerType;if(null!=t[r])return t[r]}}return"SceneLayer"});break;default:s=o[r]}const c={FeatureLayer:!0,SceneLayer:!0},d="FeatureServer"===r,y={parsedUrl:t,Constructor:null,layerOrTableId:d?i:null,sublayerIds:null,tableIds:null},b=await s;if(c[b]&&null==i){var h,m;const t=await p(e,r,a);d&&(y.sublayerInfos=t.layerInfos,y.tableInfos=t.tableInfos),1!==t.layerIds.length+t.tableIds.length?(y.sublayerIds=t.layerIds,y.tableIds=t.tableIds):d&&(y.layerOrTableId=null!=(h=t.layerIds[0])?h:t.tableIds[0],y.sourceJSON=null!=(m=t.layerInfos[0])?m:t.tableInfos[0])}return y.Constructor=await w(b),y}async function f(e,a){var t;const r=await O(e,{customParameters:a});let n=null,s=null;const o=r.type;if("Feature Layer"===o||"Table"===o?(n="FeatureServer",s=r.id):"indexedVector"===o?n="VectorTileServer":r.hasOwnProperty("mapName")?n="MapServer":r.hasOwnProperty("bandCount")&&r.hasOwnProperty("pixelSizeX")?n="ImageServer":r.hasOwnProperty("maxRecordCount")&&r.hasOwnProperty("allowGeometryUpdates")?n="FeatureServer":r.hasOwnProperty("streamUrls")?n="StreamServer":b(r)?(n="SceneServer",s=r.id):r.hasOwnProperty("layers")&&b(null==(t=r.layers)?void 0:t[0])&&(n="SceneServer"),!n)return null;const c=null!=s?Object(u["f"])(e):null;return{title:Object(l["k"])(c)&&r.name||Object(i["m"])(e),serverType:n,sublayer:s,url:{path:Object(l["k"])(c)?c.serviceUrl:Object(i["M"])(e).path}}}function b(e){return(null==e?void 0:e.hasOwnProperty("store"))&&e.hasOwnProperty("id")&&"number"==typeof e.id}async function p(e,a,t){var r,n;let l,i=!1;if("FeatureServer"===a){const a=await m(e,{customParameters:t});i=!!a.layersJSON,l=a.layersJSON||a.serviceJSON}else l=await O(e,{customParameters:t});const u=null==(r=l)?void 0:r.layers,s=null==(n=l)?void 0:n.tables;return{layerIds:(null==u?void 0:u.map(e=>e.id).reverse())||[],tableIds:(null==s?void 0:s.map(e=>e.id).reverse())||[],layerInfos:i?u:[],tableInfos:i?s:[]}}function h(e){return!e.type||"Feature Layer"===e.type}async function m(e,a){var t,r;let n=await O(e,a);n=n||{},n.layers=(null==(t=n.layers)?void 0:t.filter(h))||[];const l={serviceJSON:n};if(n.currentVersion<10.5)return l;const i=await O(e+"/layers",a);return l.layersJSON={layers:(null==i||null==(r=i.layers)?void 0:r.filter(h))||[],tables:(null==i?void 0:i.tables)||[]},l}async function w(e){return(0,s["a"][e])()}async function v(e,a){return(await O(e,{customParameters:a})).tileInfo}async function O(e,a){return(await Object(r["default"])(e,{responseType:"json",query:{f:"json",...null==a?void 0:a.customParameters,token:null==a?void 0:a.apiKey}})).data}},a0b4:function(e,a,t){"use strict";t.d(a,"a",(function(){return r}));const r={BingMapsLayer:async()=>(await t.e("chunk-2d0a4f14").then(t.bind(null,"091f"))).default,BuildingSceneLayer:async()=>(await Promise.all([t.e("chunk-895bcebe"),t.e("chunk-2d0cc264")]).then(t.bind(null,"4d64"))).default,CSVLayer:async()=>(await t.e("chunk-e4fd0ad0").then(t.bind(null,"2a7d"))).default,ElevationLayer:async()=>(await t.e("chunk-c6435564").then(t.bind(null,"f20e"))).default,FeatureLayer:async()=>(await Promise.resolve().then(t.bind(null,"5bd5"))).default,GroupLayer:async()=>(await t.e("chunk-2d0c8892").then(t.bind(null,"54fc"))).default,GeoRSSLayer:async()=>(await t.e("chunk-2d0a33b6").then(t.bind(null,"00ff"))).default,GeoJSONLayer:async()=>(await t.e("chunk-1f92628b").then(t.bind(null,"785c"))).default,ImageryLayer:async()=>(await Promise.all([t.e("chunk-4dec1432"),t.e("chunk-039414a1"),t.e("chunk-91c026ee")]).then(t.bind(null,"fc65"))).default,ImageryTileLayer:async()=>(await Promise.all([t.e("chunk-4dec1432"),t.e("chunk-039414a1"),t.e("chunk-d35ed61a"),t.e("chunk-1b354235")]).then(t.bind(null,"9917"))).default,IntegratedMeshLayer:async()=>(await t.e("chunk-69b3b5db").then(t.bind(null,"cafc"))).default,KMLLayer:async()=>(await t.e("chunk-161078e6").then(t.bind(null,"f5fc"))).default,LineOfSightLayer:async()=>(await t.e("chunk-ea65f93c").then(t.bind(null,"8790"))).default,MapImageLayer:async()=>(await Promise.resolve().then(t.bind(null,"53f8"))).default,MapNotesLayer:async()=>(await t.e("chunk-6b3eda79").then(t.bind(null,"5afa"))).default,OGCFeatureLayer:async()=>(await t.e("chunk-ef0d75d0").then(t.bind(null,"1f69"))).default,OpenStreetMapLayer:async()=>(await t.e("chunk-88f92b30").then(t.bind(null,"8c58"))).default,PointCloudLayer:async()=>(await t.e("chunk-155a9198").then(t.bind(null,"44bb"))).default,RouteLayer:async()=>(await t.e("chunk-49b5cf15").then(t.bind(null,"b285"))).default,SceneLayer:async()=>(await Promise.all([t.e("chunk-895bcebe"),t.e("chunk-550e06f3")]).then(t.bind(null,"d321"))).default,StreamLayer:async()=>(await t.e("chunk-2d21a92d").then(t.bind(null,"bba8"))).default,TileLayer:async()=>(await t.e("chunk-20e837a3").then(t.bind(null,"2650"))).default,UnknownLayer:async()=>(await t.e("chunk-2d209b4c").then(t.bind(null,"a9ca"))).default,UnsupportedLayer:async()=>(await t.e("chunk-2d0ac5dd").then(t.bind(null,"18dd"))).default,VectorTileLayer:async()=>(await Promise.all([t.e("chunk-17e51360"),t.e("chunk-2c6f5d07")]).then(t.bind(null,"173c"))).default,VoxelLayer:async()=>(await t.e("chunk-2df33656").then(t.bind(null,"a347"))).default,WebTileLayer:async()=>(await t.e("chunk-06ad9dad").then(t.bind(null,"9dc3"))).default,WFSLayer:async()=>(await t.e("chunk-41b20229").then(t.bind(null,"fa4e"))).default,WMSLayer:async()=>(await t.e("chunk-067a25e7").then(t.bind(null,"8760"))).default,WMTSLayer:async()=>(await t.e("chunk-6490f072").then(t.bind(null,"b039"))).default}},a8a0:function(e,a,t){"use strict";t.r(a),t.d(a,"save",(function(){return K})),t.d(a,"saveAll",(function(){return D})),t.d(a,"saveAs",(function(){return G}));var r=t("b50f"),n=t("ce50"),l=t("e92d"),i=t("b2b2"),u=t("f4cc"),s=t("ca81"),o=t("5bd5"),c=t("4cf4"),d=t("54b4"),y=t("7a18"),f=t("0224"),b=t("a7e1"),p=t("15ec"),h=t("0dfa");const m=l["a"].getLogger("esri.layers.FeatureLayer"),w="Feature Service";function v(e,a){return`Layer (title: ${e.title}, id: ${e.id}) of type '${e.declaredClass}' ${a}`}function O(e,a){if(a.type!==w)throw new n["a"]("feature-layer:portal-item-wrong-type",v(e,`should have portal item of type "${w}"`))}async function S(e){if(await e.load(),Object(y["c"])(e))throw new n["a"]("feature-layer:save",v(e,"using an in-memory source cannot be saved to a portal item"))}function I(e,a){let t=e.messages.filter(({type:e})=>"error"===e).map(({name:e,message:a,details:t})=>new n["a"](e,a,t));if(null!=a&&a.ignoreUnsupported&&(t=t.filter(({name:e})=>"layer:unsupported"!==e&&"symbol:unsupported"!==e&&"symbol-layer:unsupported"!==e&&"property:unsupported"!==e&&"url:unsupported"!==e)),t.length>0)throw new n["a"]("feature-layer:save","Failed to save feature layer due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:t})}async function L(e,a,t){"beforeSave"in e&&"function"==typeof e.beforeSave&&await e.beforeSave();const r=e.write({},a);return I(a,t),r}function k(e){const{layer:a,layerJSON:t}=e;return a.isTable?{layers:[],tables:[t]}:{layers:[t],tables:[]}}function g(e){Object(h["b"])(e,h["a"].JSAPI),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter((e,a,t)=>t.indexOf(e)===a))}function j(e){const a=e.portalItem;if(!a)throw m.error("save: requires the portalItem property to be set"),new n["a"]("feature-layer:portal-item-not-set",v(e,"requires the portalItem property to be set"));if(!a.loaded)throw new n["a"]("feature-layer:portal-item-not-loaded",v(e,"cannot be saved to a portal item that does not exist or is inaccessible"));O(e,a)}async function P(e,a){return/\/\d+\/?$/.test(e.url)?k(a[0]):T(e,a)}async function T(e,a){const{layer:{url:t,customParameters:r,apiKey:n}}=a[0];let l=await e.fetchData("json");l&&null!=l.layers&&null!=l.tables||(l=await M(l,{url:t,customParameters:r,apiKey:n},a.map(e=>e.layer.layerId)));for(const i of a)N(i.layer,i.layerJSON,l);return l}async function M(e,a,t){var r,n;e||(e={}),(r=e).layers||(r.layers=[]),(n=e).tables||(n.tables=[]);const{url:l,customParameters:i,apiKey:u}=a,{serviceJSON:s,layersJSON:o}=await Object(c["fetchFeatureService"])(l,{customParameters:i,apiKey:u}),d=A(e.layers,s.layers,t),y=A(e.tables,s.tables,t);e.layers=d.itemResources,e.tables=y.itemResources;const f=[...d.added,...y.added],b=o?[...o.layers,...o.tables]:[];return await J(e,f,l,b),e}function A(e,a,t){const n=Object(r["c"])(e,a,(e,a)=>e.id===a.id);e=e.filter(e=>!n.removed.some(a=>a.id===e.id));const l=n.added.map(({id:e})=>({id:e}));return l.forEach(({id:a})=>{e.push({id:a})}),{itemResources:e,added:l.filter(({id:e})=>!t.includes(e))}}async function J(e,a,t,r){const n=a.map(({id:e})=>new o["default"]({url:t,layerId:e,sourceJSON:r.find(({id:a})=>a===e)}));await Object(u["g"])(n.map(e=>e.load())),n.forEach(a=>{const{layerId:t,loaded:r,defaultPopupTemplate:n}=a;r&&!Object(i["j"])(n)&&N(a,{id:t,popupInfo:n.toJSON()},e)})}function N(e,a,t){e.isTable?E(t.tables,a):E(t.layers,a)}function E(e,a){const t=e.findIndex(({id:e})=>e===a.id);-1===t?e.push(a):e[t]=a}function F(e){const{portalItem:a}=e;return Object(y["d"])(e)&&!e.dynamicDataSource&&!(null==a||!a.loaded)&&a.type===w}async function C(e){if(null==e||!e.length)throw new n["a"]("feature-layer-utils-saveall:missing-parameters","'layers' array should contain at least one feature layer");await Promise.all(e.map(e=>e.load()));for(const r of e)if(!F(r))throw new n["a"]("feature-layer-utils-saveall:invalid-parameters","'layers' array should only contain layers or tables in a feature service loaded from 'Feature Service' item. "+v(r,"does not conform"),{layer:r});const a=e.map(e=>e.portalItem.id);if(new Set(a).size>1)throw new n["a"]("feature-layer-utils-saveall:invalid-parameters","All layers in the 'layers' array should be loaded from the same portal item");const t=e.map(e=>e.layerId);if(new Set(t).size!==t.length)throw new n["a"]("feature-layer-utils-saveall:invalid-parameters","'layers' array should contain only one instance each of layer or table in a feature service")}function U(e,a){var t,r;let n=b["default"].from(a);return n.id&&(n=n.clone(),n.id=null),null!=(t=n).type||(t.type=w),null!=(r=n).portal||(r.portal=f["a"].getDefault()),O(e,n),n}async function R(e,a){const{url:t,layerId:r,title:n,fullExtent:l,isTable:u}=e,s=Object(d["e"])(t),o=Object(i["k"])(s)&&"FeatureServer"===s.serverType;a.url=o?t:`${t}/${r}`,a.title||(a.title=n),a.extent=null,!u&&Object(i["k"])(l)&&(a.extent=await Object(h["c"])(l)),Object(h["e"])(a,h["a"].METADATA),Object(h["e"])(a,h["a"].MULTI_LAYER),Object(h["b"])(a,h["a"].SINGLE_LAYER),u&&Object(h["b"])(a,h["a"].TABLE),g(a)}async function x(e,a,t){const r=e.portal;await r._signIn(),await r.user.addItem({item:e,data:a,folder:null==t?void 0:t.folder})}const K=Object(u["f"])(V);async function V(e,a){await S(e),j(e);const t=e.portalItem,r=Object(p["b"])(t),n=await L(e,r,a),l=await P(t,[{layer:e,layerJSON:n}]);return g(t),await t.update({data:l}),Object(s["a"])(r),t}const D=Object(u["f"])(async(e,a)=>{await C(e);const t=e[0].portalItem,r=Object(p["b"])(t),n=await Promise.all(e.map(e=>L(e,r,a))),l=await P(t,e.map((e,a)=>({layer:e,layerJSON:n[a]})));return g(t),await t.update({data:l}),await Promise.all(e.slice(1).map(e=>e.portalItem.reload())),Object(s["a"])(r),t.clone()}),G=Object(u["f"])($);async function $(e,a,t){await S(e);const r=U(e,a),n=Object(p["b"])(r),l=k({layer:e,layerJSON:await L(e,n,t)});return await R(e,r),await x(r,l,t),e.portalItem=r,Object(s["a"])(n),r}},ca81:function(e,a,t){"use strict";t.d(a,"a",(function(){return n}));var r=t("2698");function n(e){e&&e.writtenProperties&&e.writtenProperties.forEach(({target:e,propName:a,newOrigin:t})=>{Object(r["a"])(e)&&t&&e.originOf(a)!==t&&e.updateOrigin(a,t)})}}}]);
//# sourceMappingURL=chunk-0c9814be.1731ecc1.js.map