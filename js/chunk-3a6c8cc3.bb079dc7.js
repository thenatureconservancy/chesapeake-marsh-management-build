(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a6c8cc3"],{"003f":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("f2e0");class r{constructor(){this.id=Object(n["a"])()}unload(){}}},"0278":function(e,t,i){"use strict";i.d(t,"a",(function(){return _}));var n=i("b2b2"),r=i("b7c2"),s=i("8a44"),a=i("e431"),o=i("0b2d"),c=i("1153");class l{constructor(e,t,i,n){this.primitiveIndices=e,this._numIndexPerPrimitive=t,this.indices=i,this.position=n,this.center=Object(o["f"])(),Object(c["a"])(e.length>=1),Object(c["a"])(i.length%this._numIndexPerPrimitive==0),Object(c["a"])(i.length>=e.length*this._numIndexPerPrimitive),Object(c["a"])(3===n.size||4===n.size);const{data:r,size:s}=n,l=e.length;let u=s*i[this._numIndexPerPrimitive*e[0]];h.clear(),h.push(u),this.bbMin=Object(o["h"])(r[u],r[u+1],r[u+2]),this.bbMax=Object(o["d"])(this.bbMin);for(let a=0;a<l;++a){const t=this._numIndexPerPrimitive*e[a];for(let e=0;e<this._numIndexPerPrimitive;++e){u=s*i[t+e],h.push(u);let n=r[u];this.bbMin[0]=Math.min(n,this.bbMin[0]),this.bbMax[0]=Math.max(n,this.bbMax[0]),n=r[u+1],this.bbMin[1]=Math.min(n,this.bbMin[1]),this.bbMax[1]=Math.max(n,this.bbMax[1]),n=r[u+2],this.bbMin[2]=Math.min(n,this.bbMin[2]),this.bbMax[2]=Math.max(n,this.bbMax[2])}}Object(a["l"])(this.center,this.bbMin,this.bbMax,.5),this.radius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);let d=this.radius*this.radius;for(let a=0;a<h.length;++a){u=h.getItemAt(a);const e=r[u]-this.center[0],t=r[u+1]-this.center[1],i=r[u+2]-this.center[2],n=e*e+t*t+i*i;if(n<=d)continue;const s=Math.sqrt(n),o=.5*(s-this.radius);this.radius=this.radius+o,d=this.radius*this.radius;const c=o/s;this.center[0]+=e*c,this.center[1]+=t*c,this.center[2]+=i*c}h.clear()}getCenter(){return this.center}getBSRadius(){return this.radius}getBBMin(){return this.bbMin}getBBMax(){return this.bbMax}getChildren(){if(this._children)return this._children;if(Object(a["h"])(this.bbMin,this.bbMax)>1){const e=Object(a["l"])(Object(o["f"])(),this.bbMin,this.bbMax,.5),t=this.primitiveIndices.length,i=new Uint8Array(t),n=new Array(8);for(let a=0;a<8;++a)n[a]=0;const{data:r,size:s}=this.position;for(let a=0;a<t;++a){let t=0;const o=this._numIndexPerPrimitive*this.primitiveIndices[a];let c=s*this.indices[o],l=r[c],h=r[c+1],u=r[c+2];for(let e=1;e<this._numIndexPerPrimitive;++e){c=s*this.indices[o+e];const t=r[c],i=r[c+1],n=r[c+2];t<l&&(l=t),i<h&&(h=i),n<u&&(u=n)}l<e[0]&&(t|=1),h<e[1]&&(t|=2),u<e[2]&&(t|=4),i[a]=t,++n[t]}let c=0;for(let a=0;a<8;++a)n[a]>0&&++c;if(c<2)return;const h=new Array(8);for(let a=0;a<8;++a)h[a]=n[a]>0?new Uint32Array(n[a]):void 0;for(let a=0;a<8;++a)n[a]=0;for(let a=0;a<t;++a){const e=i[a];h[e][n[e]++]=this.primitiveIndices[a]}this._children=new Array(8);for(let a=0;a<8;++a)void 0!==h[a]&&(this._children[a]=new l(h[a],this._numIndexPerPrimitive,this.indices,this.position))}return this._children}static prune(){h.prune()}}const h=new s["a"]({deallocator:null});var u=i("003f"),d=i("2765"),b=i("1038"),f=i("b7bd");class _ extends u["a"]{constructor(e,t=[],i=r["f"].Triangle,n=-1){super(),this._primitiveType=i,this.edgeIndicesLength=n,this.type=d["a"].Geometry,this._vertexAttributes=new Map,this._indices=new Map,this._boundingInfo=null;for(const[r,s]of e)s&&this._vertexAttributes.set(r,{...s});if(null==t||0===t.length){const e=O(this._vertexAttributes),t=Object(b["d"])(e);this.edgeIndicesLength=this.edgeIndicesLength<0?e:this.edgeIndicesLength;for(const i of this._vertexAttributes.keys())this._indices.set(i,t)}else for(const[r,s]of t)s&&(this._indices.set(r,p(s)),r===f["a"].POSITION&&(this.edgeIndicesLength=this.edgeIndicesLength<0?this._indices.get(r).length:this.edgeIndicesLength))}cloneShallow(){const e=new _([],void 0,this._primitiveType,void 0),{_vertexAttributes:t,_indices:i}=e;return this._vertexAttributes.forEach((e,i)=>{t.set(i,e)}),this._indices.forEach((e,t)=>{i.set(t,e)}),e.screenToWorldRatio=this.screenToWorldRatio,e._boundingInfo=this._boundingInfo,e}get vertexAttributes(){return this._vertexAttributes}getMutableAttribute(e){const t=this._vertexAttributes.get(e);return t&&!t.exclusive&&(t.data=Array.from(t.data),t.exclusive=!0),t}get indices(){return this._indices}get indexCount(){const e=this._indices.values().next().value;return e?e.length:0}get primitiveType(){return this._primitiveType}get faceCount(){return this.indexCount/3}get boundingInfo(){return Object(n["j"])(this._boundingInfo)&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}computeAttachmentOrigin(e){return this.primitiveType===r["f"].Triangle?this._computeAttachmentOriginTriangles(e):this._computeAttachmentOriginPoints(e)}_computeAttachmentOriginTriangles(e){const t=this.indices.get(f["a"].POSITION),i=this.vertexAttributes.get(f["a"].POSITION);return Object(b["c"])(i,t,e)}_computeAttachmentOriginPoints(e){const t=this.indices.get(f["a"].POSITION),i=this.vertexAttributes.get(f["a"].POSITION);return Object(b["b"])(i,t,e)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){const e=this.indices.get(f["a"].POSITION);if(0===e.length)return null;const t=this.primitiveType===r["f"].Triangle?3:1;Object(c["a"])(e.length%t==0,"Indexing error: "+e.length+" not divisible by "+t);const i=Object(b["d"])(e.length/t),n=this.vertexAttributes.get(f["a"].POSITION);return new l(i,t,e,n)}}function O(e){const t=e.values().next().value;return null==t?0:t.data.length/t.size}function p(e){if(e.BYTES_PER_ELEMENT===Uint16Array.BYTES_PER_ELEMENT)return e;for(const t of e)if(t>=65536)return e;return new Uint16Array(e)}},"0bde":function(e,t,i){"use strict";i.d(t,"a",(function(){return U}));var n=i("b2b2"),r=i("ecd7"),s=i("8a44"),a=i("e431"),o=i("0b2d"),c=i("d359"),l=i("d18f"),h=i("f895"),u=i("1153");class d{constructor(e,t){this._objectToBoundingSphere=e,this._maximumObjectsPerNode=10,this._maximumDepth=20,this._degenerateObjects=new Set,this._root=new b,this._objectCount=0,t&&(void 0!==t.maximumObjectsPerNode&&(this._maximumObjectsPerNode=t.maximumObjectsPerNode),void 0!==t.maximumDepth&&(this._maximumDepth=t.maximumDepth))}get bounds(){return this._root.bounds}get halfSize(){return this._root.halfSize}get root(){return this._root.node}get maximumObjectsPerNode(){return this._maximumObjectsPerNode}get maximumDepth(){return this._maximumDepth}get objectCount(){return this._objectCount}destroy(){this._degenerateObjects.clear(),b.clearPool(),A[0]=null,M.prune(),C.prune()}add(e,t=e.length){this._objectCount+=t,this._grow(e,t);const i=b.acquire();for(let n=0;n<t;n++){const t=e[n];this._isDegenerate(t)?this._degenerateObjects.add(t):(i.init(this._root),this._add(t,i))}b.release(i)}remove(e,t=null){this._objectCount-=e.length;const i=b.acquire();for(const r of e){const e=Object(n["k"])(t)?t:Object(h["b"])(this._objectToBoundingSphere(r),L);v(e[3])?(i.init(this._root),this._remove(r,e,i)):this._degenerateObjects.delete(r)}b.release(i),this._shrink()}update(e,t){if(!v(t[3])&&this._isDegenerate(e))return;const i=P(e);this.remove(i,t),this.add(i)}forEachAlongRay(e,t,i){const n=Object(l["g"])(e,t);this._forEachNode(this._root,e=>{if(!this._intersectsNode(n,e))return!1;const t=e.node;return t.terminals.forAll(e=>{this._intersectsObject(n,e)&&i(e)}),null!==t.residents&&t.residents.forAll(e=>{this._intersectsObject(n,e)&&i(e)}),!0})}forEachAlongRayWithVerticalOffset(e,t,i,n){const r=Object(l["g"])(e,t);this._forEachNode(this._root,e=>{if(!this._intersectsNodeWithOffset(r,e,n))return!1;const t=e.node;return t.terminals.forAll(e=>{this._intersectsObjectWithOffset(r,e,n)&&i(e)}),null!==t.residents&&t.residents.forAll(e=>{this._intersectsObjectWithOffset(r,e,n)&&i(e)}),!0})}forEach(e){this._forEachNode(this._root,t=>{const i=t.node;return i.terminals.forAll(e),null!==i.residents&&i.residents.forAll(e),!0}),this._degenerateObjects.forEach(e)}forEachDegenerateObject(e){this._degenerateObjects.forEach(e)}findClosest(e,t,i,n=(()=>!0),r=1/0){let s=1/0,o=1/0,l=null;const u=j(e,t),d=a=>{if(--r,!n(a))return;const u=this._objectToBoundingSphere(a);if(!Object(c["f"])(i,u))return;const d=m(e,t,Object(h["f"])(u)),b=d-u[3],f=d+u[3];b<s&&(s=b,o=f,l=a)};return this._forEachNodeDepthOrdered(this._root,n=>{if(r<=0||!Object(c["f"])(i,n.bounds))return!1;if(Object(a["k"])(S,u,n.halfSize),Object(a["e"])(S,S,n.bounds),m(e,t,S)>o)return!1;const s=n.node;return s.terminals.forAll(e=>d(e)),null!==s.residents&&s.residents.forAll(e=>d(e)),!0},e,t),l}forEachInDepthRange(e,t,i,n,r,s,o){let l=-1/0,u=1/0;const b={setRange:e=>{i===d.DepthOrder.FRONT_TO_BACK?(l=Math.max(l,e.near),u=Math.min(u,e.far)):(l=Math.max(l,-e.far),u=Math.min(u,-e.near))}};b.setRange(n);const f=m(t,i,e),_=j(t,i),O=j(t,-i),p=e=>{if(!o(e))return;const n=this._objectToBoundingSphere(e),a=Object(h["f"])(n),d=m(t,i,a)-f,_=d-n[3],O=d+n[3];_>u||O<l||!Object(c["f"])(s,n)||r(e,b)};this._forEachNodeDepthOrdered(this._root,e=>{if(!Object(c["f"])(s,e.bounds))return!1;if(Object(a["k"])(S,_,e.halfSize),Object(a["e"])(S,S,e.bounds),m(t,i,S)-f>u)return!1;if(Object(a["k"])(S,O,e.halfSize),Object(a["e"])(S,S,e.bounds),m(t,i,S)-f<l)return!1;const n=e.node;return n.terminals.forAll(e=>p(e)),null!==n.residents&&n.residents.forAll(e=>p(e)),!0},t,i)}forEachNode(e){this._forEachNode(this._root,t=>e(t.node,t.bounds,t.halfSize))}forEachNeighbor(e,t){const i=Object(h["d"])(t),n=Object(h["f"])(t),r=t=>{const r=this._objectToBoundingSphere(t),s=Object(h["d"])(r),o=i+s;Object(a["h"])(Object(h["f"])(r),n)-o*o<=0&&e(t)};this._forEachNode(this._root,e=>{const t=Object(h["d"])(e.bounds),s=i+t;if(Object(a["h"])(Object(h["f"])(e.bounds),n)-s*s>0)return!1;const o=e.node;return o.terminals.forAll(e=>r(e)),null!==o.residents&&o.residents.forAll(e=>r(e)),!0}),this.forEachDegenerateObject(r)}_intersectsNode(e,t){return O(t.bounds,2*-t.halfSize,x),O(t.bounds,2*t.halfSize,R),Object(u["h"])(e.origin,e.direction,x,R)}_intersectsNodeWithOffset(e,t,i){return O(t.bounds,2*-t.halfSize,x),O(t.bounds,2*t.halfSize,R),i.applyToMinMax(x,R),Object(u["h"])(e.origin,e.direction,x,R)}_intersectsObject(e,t){const i=this._objectToBoundingSphere(t);return!(i[3]>0)||Object(h["g"])(i,e)}_intersectsObjectWithOffset(e,t,i){const n=this._objectToBoundingSphere(t);return!(n[3]>0)||Object(h["g"])(i.applyToBoundingSphere(n),e)}_forEachNode(e,t){let i=b.acquire().init(e);const n=[i];for(;0!==n.length;){if(i=n.pop(),t(i)&&!i.isLeaf())for(let e=0;e<i.node.children.length;e++)i.node.children[e]&&n.push(b.acquire().init(i).advance(e));b.release(i)}}_forEachNodeDepthOrdered(e,t,i,n=d.DepthOrder.FRONT_TO_BACK){let r=b.acquire().init(e);const s=[r];for(g(i,n,F);0!==s.length;){if(r=s.pop(),t(r)&&!r.isLeaf())for(let e=7;e>=0;--e){const t=F[e];r.node.children[t]&&s.push(b.acquire().init(r).advance(t))}b.release(r)}}_remove(e,t,i){M.clear();const n=i.advanceTo(t,(e,t)=>{M.push(e.node),M.push(t)})?i.node.terminals:i.node.residents;if(n.removeUnordered(e),0===n.length)for(let r=M.length-2;r>=0;r-=2){const e=M.data[r],t=M.data[r+1];if(!this._purge(e,t))break}}_nodeIsEmpty(e){if(0!==e.terminals.length)return!1;if(null!==e.residents)return 0===e.residents.length;for(let t=0;t<e.children.length;t++)if(e.children[t])return!1;return!0}_purge(e,t){return t>=0&&(e.children[t]=null),!!this._nodeIsEmpty(e)&&(null===e.residents&&(e.residents=new s["a"]({shrink:!0})),!0)}_add(e,t){t.advanceTo(this._objectToBoundingSphere(e))?t.node.terminals.push(e):(t.node.residents.push(e),t.node.residents.length>this._maximumObjectsPerNode&&t.depth<this._maximumDepth&&this._split(t))}_split(e){const t=e.node.residents;e.node.residents=null;for(let i=0;i<t.length;i++){const n=b.acquire().init(e);this._add(t.getItemAt(i),n),b.release(n)}}_grow(e,t){if(0!==t&&(p(e,t,e=>this._objectToBoundingSphere(e),D),v(D[3])&&!this._fitsInsideTree(D)))if(this._nodeIsEmpty(this._root.node))Object(h["b"])(D,this._root.bounds),this._root.halfSize=1.25*D[3];else{const e=this._rootBoundsForRootAsSubNode(D);this._placingRootViolatesMaxDepth(e)?this._rebuildTree(D,e):this._growRootAsSubNode(e),b.release(e)}}_rebuildTree(e,t){Object(a["g"])(I,t.bounds),I[3]=t.halfSize,p([e,I],2,e=>e,N);const i=b.acquire().init(this._root);this._root.initFrom(null,N,1.25*N[3]),this._forEachNode(i,e=>(this.add(e.node.terminals.data,e.node.terminals.length),null!==e.node.residents&&this.add(e.node.residents.data,e.node.residents.length),!0)),b.release(i)}_placingRootViolatesMaxDepth(e){const t=Math.log(e.halfSize/this._root.halfSize)*Math.LOG2E;let i=0;return this._forEachNode(this._root,e=>(i=Math.max(i,e.depth),i+t<=this._maximumDepth)),i+t>this._maximumDepth}_rootBoundsForRootAsSubNode(e){const t=e[3],i=e;let n=-1/0;const r=this._root.bounds,s=this._root.halfSize;for(let a=0;a<3;a++){const e=r[a]-s-(i[a]-t),o=i[a]+t-(r[a]+s),c=Math.max(0,Math.ceil(e/(2*s))),l=Math.max(0,Math.ceil(o/(2*s)))+1,h=2**Math.ceil(Math.log(c+l)*Math.LOG2E);n=Math.max(n,h),V[a].min=c,V[a].max=l}for(let a=0;a<3;a++){let e=V[a].min,t=V[a].max;const i=(n-(e+t))/2;e+=Math.ceil(i),t+=Math.floor(i);const o=r[a]-s-e*s*2;E[a]=o+(t+e)*s}return E[3]=n*s*w,b.acquire().initFrom(null,E,n*s,0)}_growRootAsSubNode(e){const t=this._root.node;Object(a["g"])(D,this._root.bounds),D[3]=this._root.halfSize,this._root.init(e),e.advanceTo(D,null,!0),e.node.children=t.children,e.node.residents=t.residents,e.node.terminals=t.terminals}_shrink(){for(;;){const e=this._findShrinkIndex();if(-1===e)break;this._root.advance(e),this._root.depth=0}}_findShrinkIndex(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;let e=null;const t=this._root.node.children;let i=0,n=0;for(;n<t.length&&null==e;)i=n++,e=t[i];for(;n<t.length;)if(t[n++])return-1;return i}_isDegenerate(e){return!v(this._objectToBoundingSphere(e)[3])}_fitsInsideTree(e){const t=this._root.bounds,i=this._root.halfSize;return e[3]<=i&&e[0]>=t[0]-i&&e[0]<=t[0]+i&&e[1]>=t[1]-i&&e[1]<=t[1]+i&&e[2]>=t[2]-i&&e[2]<=t[2]+i}}class b{constructor(){this.bounds=Object(h["c"])(),this.halfSize=0,this.initFrom(null,null,0,0)}init(e){return this.initFrom(e.node,e.bounds,e.halfSize,e.depth)}initFrom(e,t,i,r=this.depth){return this.node=Object(n["k"])(e)?e:b.createEmptyNode(),Object(n["k"])(t)&&Object(h["b"])(t,this.bounds),this.halfSize=i,this.depth=r,this}advance(e){let t=this.node.children[e];t||(t=b.createEmptyNode(),this.node.children[e]=t),this.node=t,this.halfSize/=2,this.depth++;const i=y[e];return this.bounds[0]+=i[0]*this.halfSize,this.bounds[1]+=i[1]*this.halfSize,this.bounds[2]+=i[2]*this.halfSize,this.bounds[3]=this.halfSize*w,this}advanceTo(e,t,i=!1){for(;;){if(this.isTerminalFor(e))return t&&t(this,-1),!0;if(this.isLeaf()){if(!i)return t&&t(this,-1),!1;this.node.residents=null}const n=this._childIndex(e);t&&t(this,n),this.advance(n)}}isLeaf(){return null!=this.node.residents}isTerminalFor(e){return e[3]>this.halfSize/2}_childIndex(e){const t=this.bounds;return(t[0]<e[0]?1:0)+(t[1]<e[1]?2:0)+(t[2]<e[2]?4:0)}static createEmptyNode(){return{children:[null,null,null,null,null,null,null,null],terminals:new s["a"]({shrink:!0}),residents:new s["a"]({shrink:!0})}}static acquire(){return b._pool.acquire()}static release(e){b._pool.release(e)}static clearPool(){b._pool.prune()}}function f(e,t){e[0]=Math.min(e[0],t[0]-t[3]),e[1]=Math.min(e[1],t[1]-t[3]),e[2]=Math.min(e[2],t[2]-t[3])}function _(e,t){e[0]=Math.max(e[0],t[0]+t[3]),e[1]=Math.max(e[1],t[1]+t[3]),e[2]=Math.max(e[2],t[2]+t[3])}function O(e,t,i){i[0]=e[0]+t,i[1]=e[1]+t,i[2]=e[2]+t}function p(e,t,i,n){if(1===t){const t=i(e[0]);Object(h["b"])(t,n)}else{x[0]=1/0,x[1]=1/0,x[2]=1/0,R[0]=-1/0,R[1]=-1/0,R[2]=-1/0;for(let n=0;n<t;n++){const t=i(e[n]);v(t[3])&&(f(x,t),_(R,t))}Object(a["l"])(n,x,R,.5),n[3]=Math.max(R[0]-x[0],R[1]-x[1],R[2]-x[2])/2}}function g(e,t,i){if(!C.length)for(let n=0;n<8;++n)C.push({index:0,distance:0});for(let n=0;n<8;++n){const i=y[n];C.data[n].index=n,C.data[n].distance=m(e,t,i)}C.sort((e,t)=>e.distance-t.distance);for(let n=0;n<8;++n)i[n]=C.data[n].index}function j(e,t){let i=1/0,n=null;for(let r=0;r<8;++r){const s=m(e,t,T[r]);s<i&&(i=s,n=T[r])}return n}function m(e,t,i){return t*(e[0]*i[0]+e[1]*i[1]+e[2]*i[2])}function v(e){return!isNaN(e)&&e!==-1/0&&e!==1/0&&e>0}b._pool=new r["a"](b),function(e){var t;(t=e.DepthOrder||(e.DepthOrder={}))[t.FRONT_TO_BACK=1]="FRONT_TO_BACK",t[t.BACK_TO_FRONT=-1]="BACK_TO_FRONT"}(d||(d={}));const y=[Object(o["h"])(-1,-1,-1),Object(o["h"])(1,-1,-1),Object(o["h"])(-1,1,-1),Object(o["h"])(1,1,-1),Object(o["h"])(-1,-1,1),Object(o["h"])(1,-1,1),Object(o["h"])(-1,1,1),Object(o["h"])(1,1,1)],T=[Object(o["h"])(-1,-1,-1),Object(o["h"])(-1,-1,1),Object(o["h"])(-1,1,-1),Object(o["h"])(-1,1,1),Object(o["h"])(1,-1,-1),Object(o["h"])(1,-1,1),Object(o["h"])(1,1,-1),Object(o["h"])(1,1,1)],w=Math.sqrt(3),A=[null];function P(e){return A[0]=e,A}const E=Object(h["c"])(),S=Object(o["f"])(),x=Object(o["f"])(),R=Object(o["f"])(),M=new s["a"],L=Object(h["c"])(),D=Object(h["c"])(),I=Object(h["c"])(),N=Object(h["c"])(),V=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],C=new s["a"],F=[0,0,0,0,0,0,0,0],U=d},"0cb9":function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a}));var n=i("b2b2"),r=i("84f4");class s{constructor(e,t=null,i=0){this.array=e,this.spatialReference=t,this.offset=i}}function a(e){return"array"in e}function o(e,t,i="ground"){if(Object(r["a"])(t))return e.getElevation(t.x,t.y,t.z||0,t.spatialReference,i);if(a(t)){let r=t.offset;return e.getElevation(t.array[r++],t.array[r++],t.array[r]||0,Object(n["s"])(t.spatialReference,e.spatialReference),i)}return e.getElevation(t[0],t[1],t[2]||0,e.spatialReference,i)}},"0d9f":function(e,t,i){"use strict";i.d(t,"a",(function(){return m})),i.d(t,"b",(function(){return re})),i.d(t,"c",(function(){return g})),i.d(t,"d",(function(){return V})),i.d(t,"e",(function(){return y})),i.d(t,"f",(function(){return P})),i.d(t,"g",(function(){return I})),i.d(t,"h",(function(){return E})),i.d(t,"i",(function(){return G})),i.d(t,"j",(function(){return z})),i.d(t,"k",(function(){return T}));i("c120");var n=i("e92d"),r=i("38a4"),s=i("2119"),a=i("d791"),o=i("afe1"),c=i("e431"),l=i("0b2d"),h=i("3a35"),u=i("bd7e"),d=i("7289"),b=i("d18f"),f=i("a1b1"),_=i("7361");const O=n["a"].getLogger("esri.views.3d.support.geometryUtils.boundedPlane");class p{constructor(){this.plane=Object(d["d"])(),this.origin=Object(l["f"])(),this.basis1=Object(l["f"])(),this.basis2=Object(l["f"])()}}function g(e=K){return{plane:Object(d["d"])(e.plane),origin:Object(l["d"])(e.origin),basis1:Object(l["d"])(e.basis1),basis2:Object(l["d"])(e.basis2)}}function j(e,t,i){const n=ee.get();return n.origin=e,n.basis1=t,n.basis2=i,n.plane=Object(d["v"])(0,0,0,0),T(n),n}function m(e,t=g()){return y(e.origin,e.basis1,e.basis2,t)}function v(e,t){Object(c["g"])(t.origin,e.origin),Object(c["g"])(t.basis1,e.basis1),Object(c["g"])(t.basis2,e.basis2),Object(d["c"])(t.plane,e.plane)}function y(e,t,i,n=g()){return Object(c["g"])(n.origin,e),Object(c["g"])(n.basis1,t),Object(c["g"])(n.basis2,i),T(n),X(n,"fromValues()"),n}function T(e){Object(d["i"])(e.basis2,e.basis1,e.origin,e.plane)}function w(e,t,i){e!==i&&m(e,i);const n=Object(c["k"])(_["d"].get(),G(e),t);return Object(c["e"])(i.origin,i.origin,n),i.plane[3]-=t,i}function A(e,t,i){return P(t,i),w(i,F(e,e.origin),i),i}function P(e,t=g()){const i=(e[2]-e[0])/2,n=(e[3]-e[1])/2;return Object(c["w"])(t.origin,e[0]+i,e[1]+n,0),Object(c["w"])(t.basis1,i,0,0),Object(c["w"])(t.basis2,0,n,0),Object(d["h"])(0,0,1,0,t.plane),t}function E(e,t,i){return!!Object(d["m"])(e.plane,t,i)&&q(e,i)}function S(e,t,i){if(E(e,t,i))return i;const n=x(e,t,_["d"].get());return Object(c["e"])(i,t.origin,Object(c["k"])(_["d"].get(),t.direction,Object(c["m"])(t.origin,n)/Object(c["p"])(t.direction))),i}function x(e,t,i){const n=Z.get();Y(e,t,n,Z.get());let s=Number.POSITIVE_INFINITY;for(const a of te){const o=$(e,a,Q.get()),l=_["d"].get();if(Object(d["k"])(n,o,l)){const e=Object(c["v"])(_["d"].get(),t.origin,l),n=Math.abs(Object(r["b"])(Object(c["i"])(t.direction,e)));n<s&&(s=n,Object(c["g"])(i,l))}}return s===Number.POSITIVE_INFINITY?R(e,t,i):i}function R(e,t,i){if(E(e,t,i))return i;const n=Z.get(),r=Z.get();Y(e,t,n,r);let s=Number.POSITIVE_INFINITY;for(const a of te){const o=$(e,a,Q.get()),l=_["d"].get();if(Object(d["l"])(n,o,l)){const e=Object(b["d"])(t,l);if(!Object(d["o"])(r,l))continue;e<s&&(s=e,Object(c["g"])(i,l))}}return D(e,t.origin)<s&&M(e,t.origin,i),i}function M(e,t,i){const n=Object(d["r"])(e.plane,t,_["d"].get()),r=Object(u["j"])(W(e,e.basis1),n,-1,1,_["d"].get()),s=Object(u["j"])(W(e,e.basis2),n,-1,1,_["d"].get());return Object(c["f"])(i,Object(c["e"])(_["d"].get(),r,s),e.origin),i}function L(e,t,i){const{origin:n,basis1:r,basis2:s}=e,a=Object(c["f"])(_["d"].get(),t,n),o=Object(f["d"])(r,a),l=Object(f["d"])(s,a),h=Object(f["d"])(G(e),a);return Object(c["w"])(i,o,l,h)}function D(e,t){const i=L(e,t,_["d"].get()),{basis1:n,basis2:r}=e,s=Object(c["p"])(n),a=Object(c["p"])(r),o=Math.max(Math.abs(i[0])-s,0),l=Math.max(Math.abs(i[1])-a,0),h=i[2];return o*o+l*l+h*h}function I(e,t){return Math.sqrt(D(e,t))}function N(e,t){let i=Number.NEGATIVE_INFINITY;for(const n of te){const r=$(e,n,Q.get()),s=Object(u["e"])(r,t);s>i&&(i=s)}return Math.sqrt(i)}function V(e,t){return Object(d["o"])(e.plane,t)&&q(e,t)}function C(e,t,i,n){return H(e,i,n)}function F(e,t){const i=-e.plane[3];return Object(f["d"])(G(e),t)-i}function U(e,t,i,n){const r=F(e,t),s=Object(c["k"])(J,G(e),i-r);return Object(c["e"])(n,t,s),n}function k(e,t){return Object(c["o"])(e.basis1,t.basis1)&&Object(c["o"])(e.basis2,t.basis2)&&Object(c["o"])(e.origin,t.origin)}function B(e,t,i){return e!==i&&m(e,i),Object(a["a"])(ie,t),Object(a["t"])(ie,ie),Object(c["q"])(i.basis1,e.basis1,ie),Object(c["q"])(i.basis2,e.basis2,ie),Object(c["q"])(Object(d["q"])(i.plane),Object(d["q"])(e.plane),ie),Object(c["q"])(i.origin,e.origin,t),Object(d["t"])(i.plane,i.plane,i.origin),i}function z(e,t,i,n){return e!==n&&m(e,n),Object(a["d"])(ne,t,i),Object(c["q"])(n.basis1,e.basis1,ne),Object(c["q"])(n.basis2,e.basis2,ne),T(n),n}function G(e){return Object(d["q"])(e.plane)}function H(e,t,i){switch(t){case h["a"].X:Object(c["g"])(i,e.basis1),Object(c["r"])(i,i);break;case h["a"].Y:Object(c["g"])(i,e.basis2),Object(c["r"])(i,i);break;case h["a"].Z:Object(c["g"])(i,G(e))}return i}function q(e,t){const i=Object(c["f"])(_["d"].get(),t,e.origin),n=Object(c["t"])(e.basis1),r=Object(c["t"])(e.basis2),s=Object(c["i"])(e.basis1,i),a=Object(c["i"])(e.basis2,i);return-s-n<0&&s-n<0&&-a-r<0&&a-r<0}function W(e,t){const i=Q.get();return Object(c["g"])(i.origin,e.origin),Object(c["g"])(i.vector,t),i}function $(e,t,i){const{basis1:n,basis2:r,origin:s}=e,a=Object(c["k"])(_["d"].get(),n,t.origin[0]),o=Object(c["k"])(_["d"].get(),r,t.origin[1]);Object(c["e"])(i.origin,a,o),Object(c["e"])(i.origin,i.origin,s);const l=Object(c["k"])(_["d"].get(),n,t.direction[0]),h=Object(c["k"])(_["d"].get(),r,t.direction[1]);return Object(c["k"])(i.vector,Object(c["e"])(l,l,h),2),i}function X(e,t){Math.abs(Object(c["i"])(e.basis1,e.basis2)/(Object(c["p"])(e.basis1)*Object(c["p"])(e.basis2)))>1e-6&&O.warn(t,"Provided basis vectors are not perpendicular"),Math.abs(Object(c["i"])(e.basis1,G(e)))>1e-6&&O.warn(t,"Basis vectors and plane normal are not perpendicular"),Math.abs(-Object(c["i"])(G(e),e.origin)-e.plane[3])>1e-6&&O.warn(t,"Plane offset is not consistent with plane origin")}function Y(e,t,i,n){const r=G(e);Object(d["i"])(r,t.direction,t.origin,i),Object(d["i"])(Object(d["q"])(i),r,t.origin,n)}const K={plane:Object(d["d"])(),origin:Object(l["h"])(0,0,0),basis1:Object(l["h"])(1,0,0),basis2:Object(l["h"])(0,1,0)},Z=new s["a"](d["d"]),Q=new s["a"](u["d"]),J=Object(l["f"])(),ee=new s["a"](()=>({origin:null,basis1:null,basis2:null,plane:null})),te=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],ie=Object(o["d"])(),ne=Object(o["d"])(),re=Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:p,create:g,wrap:j,copy:m,copyWithoutVerify:v,fromValues:y,updateUnboundedPlane:T,elevate:w,setExtent:A,fromAABoundingRect:P,intersectRay:E,intersectRayClosestSilhouette:S,closestPointOnSilhouette:x,closestPoint:R,projectPoint:M,projectPointLocal:L,distance2:D,distance:I,distanceToSilhouette:N,extrusionContainsPoint:V,axisAt:C,altitudeAt:F,setAltitudeAt:U,equals:k,transform:B,rotate:z,normal:G,UP:K},Symbol.toStringTag,{value:"Module"}))},"0fa6":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("e92d"),r=i("b2b2"),s=i("d17d"),a=i("8539");const o=n["a"].getLogger("esri.views.webgl.VertexArrayObject");class c{constructor(e,t,i,n,r=null){this._context=e,this._locations=t,this._layout=i,this._buffers=n,this._indexBuffer=r,this._glName=null,this._initialized=!1,e.instanceCounter.increment(s["t"].VertexArrayObject,this)}get glName(){return this._glName}get context(){return this._context}get vertexBuffers(){return this._buffers}get indexBuffer(){return this._indexBuffer}get size(){return Object.keys(this._buffers).reduce((e,t)=>e+this._buffers[t].size,Object(r["k"])(this._indexBuffer)?this._indexBuffer.size:0)}get layout(){return this._layout}get locations(){return this._locations}dispose(e=!0){if(this._context){if(this._glName){var t,i;const e=null==(t=this._context)||null==(i=t.capabilities)?void 0:i.vao;e?(e.deleteVertexArray(this._glName),this._glName=null):o.warn("Leaked WebGL VAO")}if(this._context.getBoundVAO()===this&&this._context.bindVAO(null),e){for(const e in this._buffers)this._buffers[e].dispose(),delete this._buffers[e];this._indexBuffer=Object(r["e"])(this._indexBuffer)}this._context.instanceCounter.decrement(s["t"].VertexArrayObject,this),this._context=null}else(this._glName||e&&Object.getOwnPropertyNames(this._buffers).length>0)&&o.warn("Leaked WebGL VAO")}initialize(){if(this._initialized)return;const e=this._context.capabilities.vao;if(e){const t=e.createVertexArray();e.bindVertexArray(t),this._bindLayout(),e.bindVertexArray(null),this._glName=t}this._initialized=!0}bind(){this.initialize();const e=this._context.capabilities.vao;e?e.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())}_bindLayout(){const{_buffers:e,_layout:t,_indexBuffer:i}=this;e||o.error("Vertex buffer dictionary is empty!");const n=this._context.gl;for(const r in e){const i=e[r];i||o.error("Vertex buffer is uninitialized!");const n=t[r];n||o.error("Vertex element descriptor is empty!"),Object(a["a"])(this._context,this._locations,i,n)}Object(r["k"])(i)&&(this._context.capabilities.vao?n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i.glName):this._context.bindBuffer(i))}unbind(){this.initialize();const e=this._context.capabilities.vao;e?e.bindVertexArray(null):this._unbindLayout()}_unbindLayout(){const{_buffers:e,_layout:t}=this;e||o.error("Vertex buffer dictionary is empty!");for(const i in e){const n=e[i];n||o.error("Vertex buffer is uninitialized!");const r=t[i];Object(a["e"])(this._context,this._locations,n,r)}Object(r["k"])(this._indexBuffer)&&this._context.unbindBuffer(this._indexBuffer.bufferType)}}},1038:function(e,t,i){"use strict";i.d(t,"a",(function(){return b})),i.d(t,"b",(function(){return d})),i.d(t,"c",(function(){return u})),i.d(t,"d",(function(){return l})),i.d(t,"e",(function(){return h}));var n=i("e431"),r=i("0b2d"),s=i("579f");let a=(()=>{const e=new Uint32Array(131072);for(let t=0;t<e.length;++t)e[t]=t;return e})();const o=new Uint16Array([0]),c=(()=>{const e=new Uint16Array(65536);for(let t=0;t<e.length;++t)e[t]=t;return e})();function l(e){if(1===e)return o;if(e<c.length)return new Uint16Array(c.buffer,0,e);if(e>a.length){const t=Math.max(2*a.length,e);a=new Uint32Array(t);for(let e=0;e<a.length;e++)a[e]=e}return new Uint32Array(a.buffer,0,e)}function h(e){if(1===e)return new Uint16Array(o);if(e<c.length)return new Uint16Array(c.slice(0,e));if(e>a.length){const t=new Uint32Array(e);for(let e=0;e<t.length;e++)t[e]=e;return t}return new Uint32Array(a.slice(0,e))}function u(e,t,i){if(!e)return!1;const{size:r,data:a}=e;Object(n["w"])(i,0,0,0),Object(n["w"])(p,0,0,0);let o=0,c=0;for(let l=0;l<t.length-2;l+=3){const e=t[l+0]*r,h=t[l+1]*r,u=t[l+2]*r;Object(n["w"])(f,a[e+0],a[e+1],a[e+2]),Object(n["w"])(_,a[h+0],a[h+1],a[h+2]),Object(n["w"])(O,a[u+0],a[u+1],a[u+2]);const d=Object(s["b"])(f,_,O);d?(Object(n["e"])(f,f,_),Object(n["e"])(f,f,O),Object(n["k"])(f,f,1/3*d),Object(n["e"])(i,i,f),o+=d):(Object(n["e"])(p,p,f),Object(n["e"])(p,p,_),Object(n["e"])(p,p,O),c+=3)}return(0!==c||0!==o)&&(0!==o?(Object(n["k"])(i,i,1/o),!0):0!==c&&(Object(n["k"])(i,p,1/c),!0))}function d(e,t,i){if(!e||!t)return!1;const{size:r,data:s}=e;Object(n["w"])(i,0,0,0);let a=-1,o=0;for(let n=0;n<t.length;n++){const e=t[n]*r;a!==e&&(i[0]+=s[e+0],i[1]+=s[e+1],i[2]+=s[e+2],o++),a=e}return o>1&&Object(n["k"])(i,i,1/o),o>0}function b(e,t,i,r){if(!e)return!1;const{size:s,data:a}=e;Object(n["w"])(r,0,0,0),Object(n["w"])(p,0,0,0);let o=0,c=0;const l=t?t.length-1:a.length/s-1,h=l+(i?2:0);for(let u=0;u<h;u+=2){const e=u<l?u:l,i=u<l?u+1:0,h=(t?t[e]:e)*s,d=(t?t[i]:i)*s;f[0]=a[h+0],f[1]=a[h+1],f[2]=a[h+2],_[0]=a[d+0],_[1]=a[d+1],_[2]=a[d+2],Object(n["k"])(f,Object(n["e"])(f,f,_),.5);const b=Object(n["n"])(f,_);b>0?(Object(n["e"])(r,r,Object(n["k"])(f,f,b)),o+=b):(Object(n["e"])(p,p,f),c++)}return 0!==o?(Object(n["k"])(r,r,1/o),!0):0!==c&&(Object(n["k"])(r,p,1/c),!0)}const f=Object(r["f"])(),_=Object(r["f"])(),O=Object(r["f"])(),p=Object(r["f"])()},"171c":function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("e92d"),r=i("38a4"),s=i("b2b2"),a=i("a915"),o=i("d791"),c=i("afe1"),l=i("3349"),h=i("02f1"),u=i("e431"),d=i("0b2d"),b=i("7577"),f=i("0fc4"),_=i("d359"),O=i("d18f"),p=i("a1b1"),g=i("3c9c"),j=i("1153");const m=n["a"].getLogger("esri.views.3d.webgl-engine.lib.Camera");class v{constructor(e=null,t=null,i=null){this._viewUp=Object(d["f"])(),this._viewForward=Object(d["f"])(),this._viewRight=Object(d["f"])(),this._ray=Object(O["c"])(),this._viewport=Object(f["g"])(0,0,1,1),this._padding=Object(f["g"])(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=Object(h["g"])(1,1e3),this._viewDirty=!0,this._viewMatrix=Object(c["d"])(),this._projectionDirty=!0,this._projectionMatrix=Object(c["d"])(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=Object(c["d"])(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=Object(c["d"])(),this._inverseProjectionDirty=!0,this._inverseProjectionMatrix=null,this._frustumDirty=!0,this._frustum=Object(_["c"])(),this._fullViewport=Object(f["e"])(),this._pixelRatio=1,this.relativeElevation=0,Object(s["k"])(e)&&Object(u["g"])(this._ray.origin,e),this._center=Object(s["k"])(t)?Object(d["d"])(t):Object(d["f"])(),this._up=Object(s["k"])(i)?Object(d["d"])(i):Object(d["h"])(0,0,1)}get pixelRatio(){return this._pixelRatio}set pixelRatio(e){this._pixelRatio=e>0?e:1}get eye(){return this._ray.origin}set eye(e){this._compareAndSetView(e,this._ray.origin)}get center(){return this._center}set center(e){this._compareAndSetView(e,this._center)}get ray(){return Object(u["f"])(this._ray.direction,this.center,this.eye),this._ray}get up(){return this._up}set up(e){this._compareAndSetView(e,this._up)}get viewMatrix(){return this._ensureViewClean(),this._viewMatrix}set viewMatrix(e){Object(o["c"])(this._viewMatrix,e),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get viewForward(){return this._ensureViewClean(),this._viewForward}get viewUp(){return this._ensureViewClean(),this._viewUp}get viewRight(){return this._ensureViewClean(),this._viewRight}get nearFar(){return this._nearFar}get near(){return this._nearFar[0]}set near(e){this._nearFar[0]!==e&&(this._nearFar[0]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get far(){return this._nearFar[1]}set far(e){this._nearFar[1]!==e&&(this._nearFar[1]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get viewport(){return this._viewport}set viewport(e){this.x=e[0],this.y=e[1],this.width=e[2],this.height=e[3]}get x(){return this._viewport[0]}set x(e){e+=this._padding[E.LEFT],this._viewport[0]!==e&&(this._viewport[0]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get y(){return this._viewport[1]}set y(e){e+=this._padding[E.BOTTOM],this._viewport[1]!==e&&(this._viewport[1]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get width(){return this._viewport[2]}set width(e){this._viewport[2]!==e&&(this._viewport[2]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get height(){return this._viewport[3]}set height(e){this._viewport[3]!==e&&(this._viewport[3]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get fullWidth(){return this._viewport[2]+this._padding[E.RIGHT]+this._padding[E.LEFT]}set fullWidth(e){this.width=e-(this._padding[E.RIGHT]+this._padding[E.LEFT])}get fullHeight(){return this._viewport[3]+this._padding[E.TOP]+this._padding[E.BOTTOM]}set fullHeight(e){this.height=e-(this._padding[E.TOP]+this._padding[E.BOTTOM])}get fullViewport(){return this._fullViewport[0]=this._viewport[0]-this._padding[E.LEFT],this._fullViewport[1]=this._viewport[1]-this._padding[E.BOTTOM],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}get aspect(){return this.width/this.height}get padding(){return this._padding}set padding(e){this._padding[E.TOP]===e[E.TOP]&&this._padding[E.RIGHT]===e[E.RIGHT]&&this._padding[E.BOTTOM]===e[E.BOTTOM]&&this._padding[E.LEFT]===e[E.LEFT]||(this._viewport[0]+=e[E.LEFT]-this._padding[E.LEFT],this._viewport[1]+=e[E.BOTTOM]-this._padding[E.BOTTOM],this._viewport[2]-=e[E.RIGHT]+e[E.LEFT]-(this._padding[E.RIGHT]+this._padding[E.LEFT]),this._viewport[3]-=e[E.TOP]+e[E.BOTTOM]-(this._padding[E.TOP]+this._padding[E.BOTTOM]),Object(b["c"])(this._padding,e),this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get viewProjectionMatrix(){return this._viewProjectionDirty&&(Object(o["m"])(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}get projectionMatrix(){if(this._projectionDirty){const e=this.width,t=this.height,i=this.near*Math.tan(this.fovY/2),n=i*this.aspect;Object(o["l"])(this._projectionMatrix,-n*(1+2*this._padding[E.LEFT]/e),n*(1+2*this._padding[E.RIGHT]/e),-i*(1+2*this._padding[E.BOTTOM]/t),i*(1+2*this._padding[E.TOP]/t),this.near,this.far),this._projectionDirty=!1}return this._projectionMatrix}get inverseProjectionMatrix(){return Object(s["j"])(this._inverseProjectionMatrix)&&(this._inverseProjectionMatrix=Object(c["d"])()),this._inverseProjectionDirty&&Object(o["a"])(this._inverseProjectionMatrix,this.projectionMatrix),this._inverseProjectionMatrix}set projectionMatrix(e){Object(o["c"])(this._projectionMatrix,e),this._projectionDirty=!1,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fov(){return this._fov}set fov(e){this._fov=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovX(){return Object(j["b"])(this._fov,this.width,this.height)}set fovX(e){this._fov=Object(j["d"])(e,this.width,this.height),this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovY(){return Object(j["c"])(this._fov,this.width,this.height)}set fovY(e){this._fov=Object(j["e"])(e,this.width,this.height),this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get distance(){return Object(u["m"])(this._center,this.eye)}get frustum(){return this._recomputeFrustum(),this._frustum}get viewInverseTransposeMatrix(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&(Object(o["a"])(this._viewInverseTransposeMatrix,this.viewMatrix),Object(o["t"])(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}depthNDCToWorld(e){const t=2*e-1;return 2*this.near*this.far/(this.far+this.near-t*(this.far-this.near))}get perRenderPixelRatio(){return Math.tan(this.fovX/2)/(this.width/2)}get perScreenPixelRatio(){return this.perRenderPixelRatio*this._pixelRatio}get aboveGround(){return this.relativeElevation&&this.relativeElevation>=0}copyFrom(e){Object(u["g"])(this._ray.origin,e.eye),Object(u["g"])(this._center,e.center),Object(u["g"])(this._up,e.up),Object(b["c"])(this._viewport,e.viewport),Object(b["c"])(this._padding,e.padding),Object(l["c"])(this._nearFar,e.nearFar),this._fov=e.fov,this.relativeElevation=e.relativeElevation;const t=e;return this._viewDirty=t._viewDirty,this._viewDirty||(Object(o["c"])(this._viewMatrix,e.viewMatrix),Object(u["g"])(this._viewRight,e.viewRight),Object(u["g"])(this._viewUp,e.viewUp),Object(u["g"])(this._viewForward,e.viewForward)),t._projectionDirty?this._projectionDirty=!0:(Object(o["c"])(this._projectionMatrix,e.projectionMatrix),this._projectionDirty=!1),this._viewProjectionDirty=!0,this._inverseProjectionDirty=!0,this._frustumDirty=t._frustumDirty,this._frustumDirty||(Object(_["b"])(this._frustum,e.frustum),this._frustumDirty=!1),t._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(Object(o["c"])(this._viewInverseTransposeMatrix,e.viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),Object(b["c"])(this._fullViewport,e.fullViewport),this._pixelRatio=e.pixelRatio,this}copyViewFrom(e){this.eye=e.eye,this.center=e.center,this.up=e.up}clone(){return(new v).copyFrom(this)}equals(e){return Object(u["o"])(this.eye,e.eye)&&Object(u["o"])(this._center,e.center)&&Object(u["o"])(this._up,e.up)&&Object(b["g"])(this._viewport,e.viewport)&&Object(b["g"])(this._padding,e.padding)&&Object(l["e"])(this._nearFar,e.nearFar)&&this._fov===e.fov&&this._pixelRatio===e.pixelRatio&&this.relativeElevation===e.relativeElevation}almostEquals(e){if(this._pixelRatio!==e.pixelRatio||Math.abs(e.fov-this._fov)>=.001)return!1;const t=5e-4,i=1-1e-10;Object(u["z"])(w,e.eye,e.center),Object(u["z"])(A,this.eye,this._center);const n=Object(u["i"])(w,A),r=Object(u["A"])(w),s=Object(u["A"])(A);return n*n>=i*r*s&&Object(u["B"])(e.eye,this.eye)<Math.max(r,s)*t*t&&Object(b["i"])(e.padding,this._padding)<.5&&Object(b["i"])(e.viewport,this._viewport)<.5}computeRenderPixelSizeAt(e){return this.computeRenderPixelSizeAtDist(this._viewDirectionDistance(e))}computeRenderPixelSizeAtDist(e){return e*this.perRenderPixelRatio}computeScreenPixelSizeAt(e){return this.computeScreenPixelSizeAtDist(this._viewDirectionDistance(e))}_viewDirectionDistance(e){return Math.abs(Object(p["d"])(this.viewForward,Object(u["f"])(w,e,this.eye)))}computeScreenPixelSizeAtDist(e){return e*this.perScreenPixelRatio}computeDistanceFromRadius(e,t){return e/Math.tan(Math.min(this.fovX,this.fovY)/(2*(t||1)))}getScreenCenter(e=Object(a["f"])()){return e[0]=(this.padding[E.LEFT]+this.width/2)/this._pixelRatio,e[1]=(this.padding[E.TOP]+this.height/2)/this._pixelRatio,e}getRenderCenter(e,t=.5,i=.5){return e[0]=this.padding[E.LEFT]+this.width*t,e[1]=this.padding[E.BOTTOM]+this.height*i,e[2]=.5,e}setGLViewport(e){const t=this.viewport,i=this.padding;e.setViewport(t[0]-i[3],t[1]-i[2],t[2]+i[1]+i[3],t[3]+i[0]+i[2])}applyProjection(e,t){e!==y&&Object(u["g"])(y,e),y[3]=1,Object(b["m"])(y,y,this.projectionMatrix);const i=Math.abs(y[3]);Object(u["k"])(y,y,1/i);const n=this.fullViewport;t[0]=Object(r["l"])(0,n[0]+n[2],.5+.5*y[0]),t[1]=Object(r["l"])(0,n[1]+n[3],.5+.5*y[1]),t[2]=.5*(y[2]+1),t[3]=i}unapplyProjection(e,t){const i=this.fullViewport;y[0]=(e[0]/(i[0]+i[2])*2-1)*e[3],y[1]=(e[1]/(i[1]+i[3])*2-1)*e[3],y[2]=(2*e[2]-1)*e[3],y[3]=e[3],Object(b["m"])(y,y,this.inverseProjectionMatrix),t[0]=y[0],t[1]=y[1],t[2]=y[2]}projectToScreen(e,t){this.projectToRenderScreen(e,P),this.renderToScreen(P,t)}projectToRenderScreen(e,t){if(y[0]=e[0],y[1]=e[1],y[2]=e[2],y[3]=1,Object(b["m"])(y,y,this.viewProjectionMatrix),0===y[3])return null;Object(u["k"])(y,y,1/Math.abs(y[3]));const i=this.fullViewport;return"x"in t?(t.x=Object(r["l"])(0,i[0]+i[2],.5+.5*y[0]),t.y=Object(r["l"])(0,i[1]+i[3],.5+.5*y[1])):(t[0]=Object(r["l"])(0,i[0]+i[2],.5+.5*y[0]),t[1]=Object(r["l"])(0,i[1]+i[3],.5+.5*y[1]),t.length>2&&(t[2]=.5*(y[2]+1))),t}unprojectFromScreen(e,t){return this.unprojectFromRenderScreen(this.screenToRender(e,P),t)}unprojectFromRenderScreen(e,t){if(Object(o["m"])(T,this.projectionMatrix,this.viewMatrix),!Object(o["a"])(T,T))return null;const i=this.fullViewport;return y[0]=2*(e[0]-i[0])/i[2]-1,y[1]=2*(e[1]-i[1])/i[3]-1,y[2]=2*e[2]-1,y[3]=1,Object(b["m"])(y,y,T),0===y[3]?null:(t[0]=y[0]/y[3],t[1]=y[1]/y[3],t[2]=y[2]/y[3],t)}constrainWindowSize(e,t,i,n=i){const r=e*this._pixelRatio,s=t*this._pixelRatio,a=Math.max(r-i/2,0),o=Math.max(this.fullHeight-s-n/2,0),c=-Math.min(r-i/2,0),l=-Math.min(this.fullHeight-s-n/2,0);return[a,o,i-c- -Math.min(this.fullWidth-r-i/2,0),n-l- -Math.min(s-n/2,0)]}computeUp(e){e===g["a"].Global?this._computeUpGlobal():this._computeUpLocal()}screenToRender(e,t){const i=e[0]*this._pixelRatio,n=this.fullHeight-e[1]*this._pixelRatio;return t[0]=i,t[1]=n,t}renderToScreen(e,t){const i=e[0]/this._pixelRatio,n=(this.fullHeight-e[1])/this._pixelRatio;t[0]=i,t[1]=n}_computeUpGlobal(){Object(u["f"])(w,this.center,this.eye);const e=Object(u["p"])(this.center);e<1?(Object(u["w"])(this._up,0,0,1),this._markViewDirty()):Math.abs(Object(u["i"])(w,this.center))>.9999*Object(u["p"])(w)*e||(Object(u["j"])(this._up,w,this.center),Object(u["j"])(this._up,this._up,w),Object(u["r"])(this._up,this._up),this._markViewDirty())}_computeUpLocal(){Object(u["v"])(w,this.eye,this.center),Math.abs(w[2])<=.9999&&(Object(u["k"])(w,w,w[2]),Object(u["w"])(this._up,-w[0],-w[1],1-w[2]),Object(u["r"])(this._up,this._up),this._markViewDirty())}_compareAndSetView(e,t){"number"==typeof e[0]&&isFinite(e[0])&&"number"==typeof e[1]&&isFinite(e[1])&&"number"==typeof e[2]&&isFinite(e[2])?Object(u["o"])(e,t)||(Object(u["g"])(t,e),this._markViewDirty()):m.warn("Camera vector contains invalid number, ignoring value")}_markViewDirty(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}_recomputeFrustum(){this._frustumDirty&&(Object(_["d"])(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}_ensureViewClean(){this._viewDirty&&(Object(o["n"])(this._viewMatrix,this.eye,this._center,this._up),Object(u["w"])(this._viewForward,-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10]),Object(u["w"])(this._viewUp,this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9]),Object(u["w"])(this._viewRight,this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8]),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}}const y=Object(f["e"])(),T=Object(c["d"])(),w=Object(d["f"])(),A=Object(d["f"])(),P=Object(a["d"])();var E;!function(e){e[e.TOP=0]="TOP",e[e.RIGHT=1]="RIGHT",e[e.BOTTOM=2]="BOTTOM",e[e.LEFT=3]="LEFT"}(E||(E={}))},"189c":function(e,t,i){"use strict";i.d(t,"a",(function(){return B})),i.d(t,"b",(function(){return l})),i.d(t,"c",(function(){return u})),i.d(t,"d",(function(){return h})),i.d(t,"e",(function(){return c})),i.d(t,"f",(function(){return m})),i.d(t,"g",(function(){return a})),i.d(t,"h",(function(){return s}));var n=i("b7c2"),r=i("d17d");function s(e,t,i=r["c"].ADD,n=[0,0,0,0]){return{srcRgb:e,srcAlpha:e,dstRgb:t,dstAlpha:t,opRgb:i,opAlpha:i,color:{r:n[0],g:n[1],b:n[2],a:n[3]}}}function a(e,t,i,n,s=r["c"].ADD,a=r["c"].ADD,o=[0,0,0,0]){return{srcRgb:e,srcAlpha:t,dstRgb:i,dstAlpha:n,opRgb:s,opAlpha:a,color:{r:o[0],g:o[1],b:o[2],a:o[3]}}}const o={face:r["n"].BACK,mode:r["j"].CCW},c={face:r["n"].FRONT,mode:r["j"].CCW},l=e=>e===n["b"].Back?o:e===n["b"].Front?c:null,h={zNear:0,zFar:1},u={r:!0,g:!0,b:!0,a:!0};function d(e){return T.intern(e)}function b(e){return A.intern(e)}function f(e){return E.intern(e)}function _(e){return x.intern(e)}function O(e){return M.intern(e)}function p(e){return D.intern(e)}function g(e){return N.intern(e)}function j(e){return C.intern(e)}function m(e){return U.intern(e)}class v{constructor(e,t){this.makeKey=e,this.makeRef=t,this.interns=new Map}intern(e){if(!e)return null;const t=this.makeKey(e),i=this.interns;return i.has(t)||i.set(t,this.makeRef(e)),i.get(t)}}function y(e){return"["+e.join(",")+"]"}const T=new v(w,e=>({__tag:"Blending",...e}));function w(e){return e?y([e.srcRgb,e.srcAlpha,e.dstRgb,e.dstAlpha,e.opRgb,e.opAlpha,e.color.r,e.color.g,e.color.b,e.color.a]):null}const A=new v(P,e=>({__tag:"Culling",...e}));function P(e){return e?y([e.face,e.mode]):null}const E=new v(S,e=>({__tag:"PolygonOffset",...e}));function S(e){return e?y([e.factor,e.units]):null}const x=new v(R,e=>({__tag:"DepthTest",...e}));function R(e){return e?y([e.func]):null}const M=new v(L,e=>({__tag:"StencilTest",...e}));function L(e){return e?y([e.function.func,e.function.ref,e.function.mask,e.operation.fail,e.operation.zFail,e.operation.zPass]):null}const D=new v(I,e=>({__tag:"DepthWrite",...e}));function I(e){return e?y([e.zNear,e.zFar]):null}const N=new v(V,e=>({__tag:"ColorWrite",...e}));function V(e){return e?y([e.r,e.g,e.b,e.a]):null}const C=new v(F,e=>({__tag:"StencilWrite",...e}));function F(e){return e?y([e.mask]):null}const U=new v(k,e=>({blending:d(e.blending),culling:b(e.culling),polygonOffset:f(e.polygonOffset),depthTest:_(e.depthTest),stencilTest:O(e.stencilTest),depthWrite:p(e.depthWrite),colorWrite:g(e.colorWrite),stencilWrite:j(e.stencilWrite)}));function k(e){return e?y([w(e.blending),P(e.culling),S(e.polygonOffset),R(e.depthTest),L(e.stencilTest),I(e.depthWrite),V(e.colorWrite),F(e.stencilWrite)]):null}class B{constructor(e){this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._stateSetters=e}setPipeline(e){(this._pipelineInvalid||e!==this._pipeline)&&(this._setBlending(e.blending),this._setCulling(e.culling),this._setPolygonOffset(e.polygonOffset),this._setDepthTest(e.depthTest),this._setStencilTest(e.stencilTest),this._setDepthWrite(e.depthWrite),this._setColorWrite(e.colorWrite),this._setStencilWrite(e.stencilWrite),this._pipeline=e),this._pipelineInvalid=!1}invalidateBlending(){this._blendingInvalid=!0,this._pipelineInvalid=!0}invalidateCulling(){this._cullingInvalid=!0,this._pipelineInvalid=!0}invalidatePolygonOffset(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0}invalidateDepthTest(){this._depthTestInvalid=!0,this._pipelineInvalid=!0}invalidateStencilTest(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDepthWrite(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0}invalidateColorWrite(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0}invalidateStencilWrite(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}_setBlending(e){this._blending=this._setSubState(e,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1}_setCulling(e){this._culling=this._setSubState(e,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1}_setPolygonOffset(e){this._polygonOffset=this._setSubState(e,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1}_setDepthTest(e){this._depthTest=this._setSubState(e,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1}_setStencilTest(e){this._stencilTest=this._setSubState(e,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1}_setDepthWrite(e){this._depthWrite=this._setSubState(e,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1}_setColorWrite(e){this._colorWrite=this._setSubState(e,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1}_setStencilWrite(e){this._stencilWrite=this._setSubState(e,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1}_setSubState(e,t,i,n){return(i||e!==t)&&(n(e),this._pipelineInvalid=!0),e}}},1942:function(e,t,i){"use strict";var n,r;i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return r})),function(e){e[e.OBJECT=0]="OBJECT",e[e.HUD=1]="HUD",e[e.TERRAIN=2]="TERRAIN",e[e.OVERLAY=3]="OVERLAY",e[e.I3S=4]="I3S",e[e.PCL=5]="PCL",e[e.LOD=6]="LOD",e[e.VOXEL=7]="VOXEL"}(n||(n={}));class s{constructor(){this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.store=r.ALL}}!function(e){e[e.MIN=0]="MIN",e[e.MINMAX=1]="MINMAX",e[e.ALL=2]="ALL"}(r||(r={}))},1962:function(e,t,i){"use strict";i.d(t,"a",(function(){return m})),i.d(t,"b",(function(){return j}));var n=i("a05b"),r=i("d272"),s=i("4db9"),a=i("6d5b"),o=i("c2d1"),c=i("6a07"),l=i("c6d7"),h=i("3976"),u=i("4377"),d=i("8e97"),b=i("d8a4"),f=i("fd48"),_=i("3886"),O=i("690a"),p=i("b7c2"),g=i("b7bd");function j(e){const t=new O["a"],i=e.output===n["a"].Depth,j=e.hasMultipassTerrain&&(e.output===n["a"].Color||e.output===n["a"].Alpha);Object(d["b"])(t,e),t.include(s["a"],{hasModelTransformation:!1,linearDepth:i}),t.include(a["a"],e),t.attributes.add(g["a"].POSITION,"vec3"),t.varyings.add("vpos","vec3"),j&&t.varyings.add("depth","float");const{vertex:m,fragment:v}=t;return i&&(t.include(o["a"],e),m.uniforms.add(new b["a"]("nearFar",(e,t)=>t.camera.nearFar)),t.varyings.add("linearDepth","float")),m.code.add(_["b"]`
    void main(void) {
      vpos = position;
      forwardNormalizedVertexColor();
      ${j?"depth = (view * vec4(vpos, 1.0)).z;":""}
      gl_Position = ${i?_["b"]`transformPositionWithDepth(proj, view, vpos, nearFar, linearDepth);`:_["b"]`transformPosition(proj, view, vpos);`}
    }
  `),t.include(r["a"],e),j&&t.include(l["b"],e),v.include(u["a"]),v.uniforms.add(new f["a"]("eColor",e=>e.color)),e.output===n["a"].Highlight&&t.include(c["a"]),v.code.add(_["b"]`
  void main() {
    discardBySlice(vpos);
    ${j?"terrainDepthTest(gl_FragCoord, depth);":""}
    vec4 fColor = ${e.hasVertexColors?"vColor * eColor;":"eColor;"}

    if (fColor.a < ${_["b"].float(h["b"])}) {
      discard;
    }

    ${e.output===n["a"].Alpha?_["b"]`gl_FragColor = vec4(fColor.a);`:""}

    ${e.output===n["a"].Color?_["b"]`gl_FragColor = highlightSlice(fColor, vpos); ${e.transparencyPassType===p["i"].Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}`:""}
    ${e.output===n["a"].Highlight?_["b"]`outputHighlight();`:""};
    ${e.output===n["a"].Depth?_["b"]`outputDepth(linearDepth);`:""};
  }
  `),t}const m=Object.freeze(Object.defineProperty({__proto__:null,build:j},Symbol.toStringTag,{value:"Module"}))},"1fe9":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("62ae"),r=i("52b2");class s extends n["a"]{constructor(e,t){super(e,"float",r["a"].Pass,(i,n,r)=>i.setUniform1f(e,t(n,r)))}}},2252:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("8e97"),r=i("1fe9"),s=i("3886");function a(e,t){if(!t.screenSizeEnabled)return;const i=e.vertex;Object(n["a"])(i,t),i.uniforms.add(new r["a"]("perScreenPixelRatio",(e,t)=>t.camera.perScreenPixelRatio)),i.uniforms.add(new r["a"]("screenSizeScale",e=>e.screenSizeScale)),i.code.add(s["b"]`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance * perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;
}`)}},2765:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Layer=0]="Layer",e[e.Object=1]="Object",e[e.Geometry=2]="Geometry",e[e.Material=3]="Material",e[e.Texture=4]="Texture",e[e.COUNT=5]="COUNT"}(n||(n={}))},"2aad":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("3886"),r=i("b7bd");function s(e,t=!0){e.attributes.add(r["a"].POSITION,"vec2"),t&&e.varyings.add("uv","vec2"),e.vertex.code.add(n["b"]`
    void main(void) {
      gl_Position = vec4(position, 0.0, 1.0);
      ${t?n["b"]`uv = position * 0.5 + vec2(0.5);`:""}
    }
  `)}},"2ebb":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("d17d"),r=i("3f3e");function s(e,t=0){const i=e.stride;return e.fieldNames.filter(t=>{const i=e.fields.get(t).optional;return!(i&&i.glPadding)}).map(n=>{const s=e.fields.get(n),o=s.constructor.ElementCount,c=a(s.constructor.ElementType),l=s.offset,h=!(!s.optional||!s.optional.glNormalized);return new r["a"](n,o,c,l,i,h,t)})}function a(e){const t=o[e];if(t)return t;throw new Error("BufferType not supported in WebGL")}const o={u8:n["k"].UNSIGNED_BYTE,u16:n["k"].UNSIGNED_SHORT,u32:n["k"].UNSIGNED_INT,i8:n["k"].BYTE,i16:n["k"].SHORT,i32:n["k"].INT,f32:n["k"].FLOAT}},"35b3":function(e,t,i){"use strict";i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return u})),i.d(t,"c",(function(){return n}));var n,r=i("b2b2"),s=i("3886"),a=i("003f"),o=i("2765"),c=i("fa1e"),l=i("7c51");class h extends a["a"]{constructor(e,t){super(),this.type=o["a"].Material,this.supportsEdges=!1,this._visible=!0,this._renderPriority=0,this._insertOrder=0,this._vertexAttributeLocations=c["a"],this._parameters=Object(l["b"])(e,t),this.validateParameters(this._parameters)}dispose(){}get parameters(){return this._parameters}update(e){return!1}setParameters(e,t=!0){Object(l["g"])(this._parameters,e)&&(this.validateParameters(this._parameters),t&&this.parametersChanged())}validateParameters(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.parametersChanged())}shouldRender(e){return this.isVisible()&&this.isVisibleInPass(e.pass)&&0!=(this.renderOccluded&e.renderOccludedMask)}isVisibleInPass(e){return!0}get renderOccluded(){return this.parameters.renderOccluded}get renderPriority(){return this._renderPriority}set renderPriority(e){e!==this._renderPriority&&(this._renderPriority=e,this.parametersChanged())}get insertOrder(){return this._insertOrder}set insertOrder(e){e!==this._insertOrder&&(this._insertOrder=e,this.parametersChanged())}get vertexAttributeLocations(){return this._vertexAttributeLocations}isVisible(){return this._visible}parametersChanged(){Object(r["k"])(this.repository)&&this.repository.materialChanged(this)}}!function(e){e[e.Occlude=1]="Occlude",e[e.Transparent=2]="Transparent",e[e.OccludeAndTransparent=4]="OccludeAndTransparent",e[e.OccludeAndTransparentStencil=8]="OccludeAndTransparentStencil",e[e.Opaque=16]="Opaque"}(n||(n={}));class u extends s["a"]{constructor(){super(...arguments),this.renderOccluded=n.Occlude}}},"35f0":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("62ae"),r=i("52b2");class s extends n["a"]{constructor(e,t){super(e,"vec3",r["a"].Draw,(i,n,r)=>i.setUniform3fv(e,t(n,r)))}}},3886:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}));class n{}function r(e,...t){let i="";for(let n=0;n<t.length;n++)i+=e[n]+t[n];return i+=e[e.length-1],i}!function(e){function t(e){return Math.round(e).toString()}function i(e){return e.toPrecision(8)}e.int=t,e.float=i}(r||(r={}))},3976:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}));const n=.1,r=.001},"413d":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}));class n{constructor(e,t=null){this.screenPoint=e,this.result=t}}class r{constructor(e,t){this.scenePoint=e,this.mapPoint=t}}},4377:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("3886");function r(e){e.code.add(n["b"]`vec4 premultiplyAlpha(vec4 v) {
return vec4(v.rgb * v.a, v.a);
}
vec3 rgb2hsv(vec3 c) {
vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);
vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);
float d = q.x - min(q.w, q.y);
float e = 1.0e-10;
return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);
}
vec3 hsv2rgb(vec3 c) {
vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}
float rgb2v(vec3 c) {
return max(c.x, max(c.y, c.z));
}`)}},"47f8":function(e,t,i){"use strict";function n(){return new Float32Array(3)}function r(e){const t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function s(e,t,i){const n=new Float32Array(3);return n[0]=e,n[1]=t,n[2]=i,n}function a(e,t){return new Float32Array(e,t,3)}function o(){return n()}function c(){return s(1,1,1)}function l(){return s(1,0,0)}function h(){return s(0,1,0)}function u(){return s(0,0,1)}i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return s}));const d=o(),b=c(),f=l(),_=h(),O=u();Object.freeze(Object.defineProperty({__proto__:null,create:n,clone:r,fromValues:s,createView:a,zeros:o,ones:c,unitX:l,unitY:h,unitZ:u,ZEROS:d,ONES:b,UNIT_X:f,UNIT_Y:_,UNIT_Z:O},Symbol.toStringTag,{value:"Module"}))},"4db9":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("3886");function r(e,t={hasModelTransformation:!1,linearDepth:!1}){if(t.hasModelTransformation)return t.linearDepth?void e.vertex.code.add(n["b"]`vec4 transformPositionWithDepth(mat4 proj, mat4 view, mat4 model, vec3 pos, vec2 nearFar, out float depth) {
vec4 eye = view * (model * vec4(pos, 1.0));
depth = (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;
return proj * eye;
}`):void e.vertex.code.add(n["b"]`vec4 transformPosition(mat4 proj, mat4 view, mat4 model, vec3 pos) {
return proj * (view * (model * vec4(pos, 1.0)));
}`);t.linearDepth?e.vertex.code.add(n["b"]`vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {
vec4 eye = view * vec4(pos, 1.0);
depth = (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;
return proj * eye;
}`):e.vertex.code.add(n["b"]`vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {
return proj * (view * vec4(pos, 1.0));
}`)}},"4e73":function(e,t,i){"use strict";i.d(t,"a",(function(){return L}));i("e06a");var n=i("6c97"),r=i("ce6d"),s=i("38a4"),a=i("b2b2"),o=i("a915"),c=i("4c37"),l=i("1c92"),h=i("dae5"),u=i("d791"),d=i("afe1"),b=i("3349"),f=i("e431"),_=i("0b2d"),O=i("8188"),p=i("f694"),g=i("9180"),j=i("bd7e"),m=i("7289"),v=i("d18f"),y=i("7361"),T=i("d3cf"),w=i("0cb9"),A=i("9990"),P=i("b7c2"),E=i("171c"),S=i("5a22"),x=i("748f"),R=i("7298"),M=i("4ae5");class L{constructor(e){this.camera=new E["a"],this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=[],this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=Object(d["d"])(),this._worldFrame=null,this._renderLocation=Object(_["f"])(),this._renderLocationDirty=!0,this._location=new M["a"]({x:0,y:0,z:0}),this._elevationAlignedLocation=new M["a"],this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=R["b"].None,this._focused=!1,this.events=new r["a"].EventEmitter,this._screenLocation={screenPointArray:Object(o["f"])(),renderScreenPointArray:Object(o["d"])(),pixelSize:0},this._screenLocationDirty=!0,this._applyObjectTransform=null,this._engineResourcesAddedToStage=!1,this._engineResources=null,this._attached=!1,this._engineLayer=null,this._materialIdReferences=null,this._location.spatialReference=e.view.spatialReference;for(const t in e)this[t]=e[t];this.view.state&&this.view.state.camera&&this.camera.copyFrom(this.view.state.camera)}destroy(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this.camera=null}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}set available(e){e!==this._available&&(this._available=e,this._updateEngineObject())}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:Object(c["d"])(()=>{this._noDisplayCount--,0===this._noDisplayCount&&this._updateEngineObject()})}}set radius(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}get radius(){return this._radius}set worldSized(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(e){D(e)&&(this._screenLocationDirty=!0),Object(u["c"])(this._modelTransform,e),this._updateEngineObject()}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=Object(d["d"])()),I(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}get location(){return this._location}set location(e){Object(T["a"])(e,this._location),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(e){Object(T["a"])(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}_updateElevationAlignedLocation(){this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y;const e=Object(a["k"])(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=this.location.spatialReference,this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit("select-changed",{action:e?"select":"deselect"}))}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._updateEngineObject())}updateStateEnabled(e,t){t?this.state|=e:this.state&=~e}_setFocused(e){e!==this._focused&&(this._focused=e,this.events.emit("focus-changed",{action:!0===e?"focus":"unfocus"}))}get focused(){return this._focused}get screenLocation(){return this._ensureScreenLocation(),this._screenLocation}_ensureScreenLocation(){if(!this._screenLocationDirty)return;let e;if(this._screenLocation.pixelSize=this.camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,D(this._modelTransform)){const t=this._calculateModelTransformOffset($);e=Object(f["e"])(t,t,this.renderLocation)}else e=this.renderLocation;this.camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this.camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}intersectionDistance(e,t){if(!this.available)return null;const i=Object(o["i"])(e,N),r=this._getCollisionRadius(t),s=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if(Object(b["s"])(this.screenLocation.screenPointArray,i)<r*r)return this.screenLocation.renderScreenPointArray[2]+s;break;case"line":{const e=this.collisionType.paths,t=this._getWorldToScreenObjectScale(),n=this._calculateObjectTransform(t,k),c=r*this.screenLocation.pixelSize,l=Object(A["b"])(this.camera,i,C);if(Object(a["j"])(l))return null;for(const i of e){if(0===i.length)continue;const e=Object(f["q"])(z,i[0],n);for(let t=1;t<i.length;t++){const r=Object(f["q"])(G,i[t],n),a=Object(j["b"])(Object(j["f"])(e,r,V),l);if(null!=a&&a<c*c){const t=Object(f["e"])(y["d"].get(),e,r);Object(f["k"])(t,t,.5);const i=Object(o["a"])(y["d"].get());return this.camera.projectToRenderScreen(t,i),i[2]+s}Object(f["g"])(e,r)}}break}case"disc":{var c;const e=this.collisionType.direction,t=null!=(c=this.collisionType.offset)?c:_["c"],n=this._getWorldToScreenObjectScale(),o=this._calculateObjectTransform(n,k),h=r*this.screenLocation.pixelSize,u=Object(A["b"])(this.camera,i,C);if(Object(a["j"])(u))return null;const d=Object(l["f"])(F,o),b=Object(f["x"])(q,e,d),O=Object(f["q"])(W,t,o);Object(m["g"])(O,b,B);const p=H;if(Object(m["m"])(B,u,p)&&Object(f["h"])(p,O)<h*h)return this.screenLocation.renderScreenPointArray[2]+s;break}case"ribbon":{const{paths:e,direction:t}=this.collisionType,n=this._getWorldToScreenObjectScale(),c=this._calculateObjectTransform(n,k),h=r*this.camera.computeScreenPixelSizeAt(this.renderLocation),u=Object(A["b"])(this.camera,i,C);if(Object(a["j"])(u))return null;const d=Object(l["f"])(F,c),b=Object(f["x"])(q,t,d),_=this._calculateModelTransformPosition(W);Object(m["g"])(_,b,B);const O=H;if(!Object(m["m"])(B,u,O))break;for(const i of e){if(0===i.length)continue;const e=Object(f["q"])(z,i[0],c);for(let t=1;t<i.length;t++){const n=Object(f["q"])(G,i[t],c),r=Object(j["e"])(Object(j["f"])(e,n,V),O);if(null!=r&&r<h*h){const t=Object(f["e"])(y["d"].get(),e,n);Object(f["k"])(t,t,.5);const i=Object(o["a"])(y["d"].get());return this.camera.projectToRenderScreen(t,i),i[2]+s}Object(f["g"])(e,n)}}break}default:Object(n["a"])(this.collisionType)}return null}attach(e={manipulator3D:{}}){var t;if(!this.view._stage)return;const i=e.manipulator3D;if(Object(a["j"])(i.engineLayerId)){const e=new x["a"]({isPickable:!1,updatePolicy:P["j"].SYNC});this.view._stage.add(e),i.engineLayerId=e.id,this._engineLayer=e}else(null==(t=this.view._stage)?void 0:t.getObject)&&(this._engineLayer=this.view._stage.getObject(i.engineLayerId));i.engineLayerReferences=(i.engineLayerReferences||0)+1,this._materialIdReferences=i.materialIdReferences,Object(a["j"])(this._materialIdReferences)&&(this._materialIdReferences=new Map,i.materialIdReferences=this._materialIdReferences),this.camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),Object(O["b"])(this._location.spatialReference,this.view.spatialReference)||(this.location=new M["a"]({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}detach(e={manipulator3D:{}}){const t=e.manipulator3D;t.engineLayerReferences--;const i=0===t.engineLayerReferences;i&&(t.engineLayerId=null),this._removeResourcesFromStage(i),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}onViewChange(){this.camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}onElevationChange(e){Object(O["o"])(this.location,X,e.spatialReference),Object(g["g"])(e.extent,X)&&(this.location=this._location)}_evaluateElevationAlignment(e=this.location){if(Object(a["j"])(this.elevationInfo))return!1;let t=null,i=0;const n=Object(a["s"])(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case"on-the-ground":t=Object(a["s"])(Object(w["b"])(this.view.elevationProvider,e,"ground"),0);break;case"relative-to-ground":i=Object(a["s"])(Object(w["b"])(this.view.elevationProvider,e,"ground"),0)+n;break;case"relative-to-scene":i=Object(a["s"])(Object(w["b"])(this.view.elevationProvider,e,"scene"),0)+n;break;case"absolute-height":i=n}return(i!==this._elevation.offset||t!==this._elevation.override)&&(this._elevation.offset=i,this._elevation.override=t,!0)}_updateEngineObject(){if(!this._attached)return;if(!this.available)return void this._removeResourcesFromStage();const e=this._getWorldToScreenObjectScale(),t=k;if(!0===this.autoScaleRenderObjects){const i=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(i,t)}else this._calculateObjectTransform(e,t);const{objectsByState:i}=this._ensureEngineResources(),n=(this.focused?R["c"].Focused:R["c"].Unfocused)|(this.selected?R["c"].Selected:R["c"].Unselected),r=this._noDisplayCount>0;for(const{stateMask:s,objects:a}of i){if(r){for(const e of a)e.setVisible(!1);continue}const e=(s&R["c"].All)!==R["c"].None,i=(s&R["b"].All)!==R["b"].None,o=!e||(n&s)==(s&R["c"].All),c=!i||(this.state&s)==(s&R["b"].All);if(o&&c)for(const n of a)n.setVisible(!0),n.transformation=t;else for(const t of a)t.setVisible(!1)}}_ensureEngineResources(){if(Object(a["j"])(this._engineResources)){const e=Object(a["r"])(this._engineLayer),t=[],i=new Set;this.renderObjects.forEach(({material:e})=>{i.has(e)||(t.push(e),i.add(e))});const n=(e,t)=>{const{geometry:i,material:n,transform:r}=t;Array.isArray(i)?i.forEach(t=>e.addGeometry(t,n,r)):e.addGeometry(i,n,r)},r=new Map;this._renderObjects.forEach(e=>{const t=new S["a"]({castShadow:!1});n(t,e);const i=e.stateMask||0,s=r.get(i)||[];s.push(t),r.set(i,s)});const s=[];r.forEach((e,t)=>s.push({stateMask:t,objects:e})),this._engineResources={objectsByState:s,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){if(this._engineResourcesAddedToStage||Object(a["j"])(this._engineResources))return;const{objectsByState:e,layer:t,materials:i}=this._engineResources;i.forEach(e=>{const t=Object(a["r"])(this._materialIdReferences),i=t.get(e.id)||0;0===i&&this.view._stage.add(e),t.set(e.id,i+1)}),e.forEach(({objects:e})=>{t.addMany(e),this.view._stage.addMany(e)}),this._engineResourcesAddedToStage=!0}_removeResourcesFromStage(e=!1){if(!this._engineResourcesAddedToStage||Object(a["j"])(this._engineResources)||!this.view._stage)return;const{objectsByState:t,layer:i,materials:n}=this._engineResources;t.forEach(({objects:e})=>{i.removeMany(e),this.view._stage.removeMany(e)}),n.forEach(e=>{const t=Object(a["r"])(this._materialIdReferences),i=t.get(e.id);1===i?(this.view._stage.remove(e),t.delete(e.id)):t.set(e.id,i-1)}),e&&this.view._stage.remove(i),this._engineResourcesAddedToStage=!1}_getCollisionRadius(e){return this._getFocusedSize(this.radius,!0)*("touch"===e?this.touchMultiplier:1)}_getFocusedSize(e,t){return e*(t?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(e){const t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,U);return Object(f["w"])(e,i[12],i[13],i[14])}_calculateModelTransformOffset(e){const t=this._calculateModelTransformPosition(e);return Object(f["f"])(e,t,this.renderLocation)}_calculateObjectTransform(e,t){return Object(u["s"])(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&Object(u["m"])(t,t,this._worldFrame),Object(u["m"])(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,Object(a["k"])(this._applyObjectTransform)&&this._applyObjectTransform(t),t}get test(){let e=!1;if(Object(a["k"])(this._engineResources))for(const t in this._engineResources.objectsByState){const i=this._engineResources.objectsByState[t];for(const t of i.objects)if(t.isVisible){e=!0;break}if(e)break}return{areAnyResourcesVisible:e}}}function D(e){return 0!==e[12]||0!==e[13]||0!==e[14]}function I(e,t,i){switch(e.viewingMode){case"local":return Object(u["i"])(i),!0;case"global":{const n=Object(p["e"])(e.renderCoordsHelper.spatialReference);return Object(O["z"])(t,0,z,0,n.radius),Object(O["c"])(Object(s["g"])(z[0]),Object(s["g"])(z[1]),i),!0}}}const N=Object(o["f"])(),V=Object(j["d"])(),C=Object(v["c"])(),F=Object(h["b"])(),U=Object(d["d"])(),k=Object(d["d"])(),B=Object(m["d"])(),z=Object(_["f"])(),G=Object(_["f"])(),H=Object(_["f"])(),q=Object(_["f"])(),W=Object(_["f"])(),$=Object(_["f"])(),X=new M["a"]({x:0,y:0,z:0,spatialReference:null})},"4f8b":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return c})),i.d(t,"c",(function(){return o})),i.d(t,"d",(function(){return h})),i.d(t,"e",(function(){return l}));var n=i("2119"),r=i("e431"),s=i("d18f");i("7361");function a(e){return e?{ray:Object(s["c"])(e.ray),c0:e.c0,c1:e.c1}:{ray:Object(s["c"])(),c0:0,c1:Number.MAX_VALUE}}function o(e,t=a()){return Object(s["b"])(e,t.ray),t.c0=0,t.c1=Number.MAX_VALUE,t}function c(e,t,i=a()){const n=Object(r["p"])(e.vector);return Object(s["f"])(e.origin,t,i.ray),i.c0=0,i.c1=n,i}function l(e,t){return u(e,e.c0,t)}function h(e,t){return u(e,e.c1,t)}function u(e,t,i){return Object(r["e"])(i,e.ray.origin,Object(r["k"])(i,e.ray.direction,t))}new n["a"](()=>({c0:0,c1:0,ray:null}))},"501b":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("3886");function r(e){e.code.add(n["b"]`const float MAX_RGBA_FLOAT =
255.0 / 256.0 +
255.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 / 256.0;
const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);
vec4 float2rgba(const float value) {
float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);
vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);
const float toU8AsFloat = 1.0 / 255.0;
return fixedPointU8 * toU8AsFloat;
}
const vec4 RGBA_2_FLOAT_FACTORS = vec4(
255.0 / (256.0),
255.0 / (256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0 * 256.0)
);
float rgba2float(vec4 rgba) {
return dot(rgba, RGBA_2_FLOAT_FACTORS);
}`)}},"52b2":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Pass=0]="Pass",e[e.Draw=1]="Draw"}(n||(n={}))},"56d6":function(e,t,i){"use strict";i.d(t,"a",(function(){return p})),i.d(t,"b",(function(){return f}));var n=i("d791"),r=i("afe1"),s=i("3349"),a=i("02f1"),o=i("9e77"),c=i("d8a4"),l=i("1fe9"),h=i("3886"),u=i("85b3"),d=i("690a"),b=i("b7bd");function f(e){const t=new d["a"];t.include(o["a"],e);const{vertex:i,fragment:r}=t;return i.uniforms.add([new u["a"]("modelView",(e,t)=>Object(n["j"])(O,t.camera.viewMatrix,e.origin)),new u["a"]("proj",(e,t)=>t.camera.projectionMatrix),new l["a"]("glowWidth",(e,t)=>e.glowWidth*t.camera.pixelRatio),new c["a"]("pixelToNDC",(e,t)=>Object(s["a"])(_,2/t.camera.fullViewport[2],2/t.camera.fullViewport[3]))]),t.attributes.add(b["a"].START,"vec3"),t.attributes.add(b["a"].END,"vec3"),t.attributes.add(b["a"].UP,"vec3"),t.attributes.add(b["a"].EXTRUDE,"vec2"),t.varyings.add("uv","vec2"),t.varyings.add("vViewStart","vec3"),t.varyings.add("vViewEnd","vec3"),t.varyings.add("vViewPlane","vec4"),i.code.add(h["b"]`void main() {
vec3 pos = mix(start, end, extrude.x);
vec4 viewPos = modelView * vec4(pos, 1);
vec4 projPos = proj * viewPos;
vec2 ndcPos = projPos.xy / projPos.w;
vec3 viewUp = (modelView * vec4(extrude.y * up, 0)).xyz;
vec4 projPosUp = proj * vec4(viewPos.xyz + viewUp, 1);
vec2 projExtrudeDir = normalize(projPosUp.xy / projPosUp.w - ndcPos);
vec2 lxy = abs(sign(projExtrudeDir) - ndcPos);
ndcPos += length(lxy) * projExtrudeDir;
vec3 worldPlaneNormal = normalize(cross(up, normalize(end - start)));
vec3 viewPlaneNormal = (modelView * vec4(worldPlaneNormal, 0)).xyz;
vViewStart = (modelView * vec4(start, 1)).xyz;
vViewEnd = (modelView * vec4(end, 1)).xyz;
vViewPlane = vec4(viewPlaneNormal, -dot(viewPlaneNormal, vViewStart));
float xPaddingPixels = sign(dot(viewPlaneNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;
ndcPos.x += xPaddingPixels * pixelToNDC.x;
uv = ndcPos * 0.5 + 0.5;
gl_Position = vec4(ndcPos, 0, 1);
}`),r.uniforms.add(new l["a"]("perScreenPixelRatio",(e,t)=>t.camera.perScreenPixelRatio)),r.code.add(h["b"]`float planeDistancePixels(vec4 plane, vec3 pos, vec3 start, vec3 end) {
vec3 origin = mix(start, end, 0.5);
vec3 basis = end - origin;
vec3 posAtOrigin = pos - origin;
float x = dot(normalize(basis), posAtOrigin);
float y = dot(plane.xyz, posAtOrigin);
float dx = max(abs(x) - length(basis), 0.0);
float dy = y;
float dist = length(vec2(dx, dy));
float width = fwidth(y);
float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;
float pixelDist = dist / min(width, maxPixelDistance);
return abs(pixelDist);
}
void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
float distance = planeDistancePixels(vViewPlane, pos, vViewStart, vViewEnd);
vec4 color = laserlineProfile(distance);
float alpha = 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, vViewPlane.xyz)));
gl_FragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);
}`),t}const _=Object(a["c"])(),O=Object(r["d"])(),p=Object.freeze(Object.defineProperty({__proto__:null,build:f},Symbol.toStringTag,{value:"Module"}))},"58c2":function(e,t,i){"use strict";i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return b}));var n=i("3349"),r=i("02f1"),s=i("7577"),a=i("0fc4"),o=i("d8a4"),c=i("fd48"),l=i("3886");function h(e){e.fragment.uniforms.add(new c["a"]("projInfo",(e,t)=>u(t))),e.fragment.uniforms.add(new o["a"]("zScale",(e,t)=>b(t))),e.fragment.code.add(l["b"]`vec3 reconstructPosition(vec2 fragCoord, float depth) {
return vec3((fragCoord * projInfo.xy + projInfo.zw) * (zScale.x * depth + zScale.y), depth);
}`)}function u(e){const t=e.camera.projectionMatrix;return 0===t[11]?Object(s["l"])(d,2/(e.camera.fullWidth*t[0]),2/(e.camera.fullHeight*t[5]),(1+t[12])/t[0],(1+t[13])/t[5]):Object(s["l"])(d,-2/(e.camera.fullWidth*t[0]),-2/(e.camera.fullHeight*t[5]),(1-t[8])/t[0],(1-t[9])/t[5])}const d=Object(a["e"])();function b(e){return 0===e.camera.projectionMatrix[11]?Object(n["a"])(f,0,1):Object(n["a"])(f,1,0)}const f=Object(r["c"])()},5957:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return b})),i.d(t,"c",(function(){return f})),i.d(t,"d",(function(){return u})),i.d(t,"e",(function(){return h}));var n=i("d791"),r=i("8190"),s=i("1153"),a=i("b7bd");function o(e,t,i,n){const r=i.typedBuffer,s=i.typedBufferStride,a=e.length;n*=s;for(let o=0;o<a;++o){const i=2*e[o];r[n]=t[i],r[n+1]=t[i+1],n+=s}}function c(e,t,i,n,r){const s=i.typedBuffer,a=i.typedBufferStride,o=e.length;if(n*=a,null==r||1===r)for(let c=0;c<o;++c){const i=3*e[c];s[n]=t[i],s[n+1]=t[i+1],s[n+2]=t[i+2],n+=a}else for(let c=0;c<o;++c){const i=3*e[c];for(let e=0;e<r;++e)s[n]=t[i],s[n+1]=t[i+1],s[n+2]=t[i+2],n+=a}}function l(e,t,i,n,r=1){const s=i.typedBuffer,a=i.typedBufferStride,o=e.length;if(n*=a,1===r)for(let c=0;c<o;++c){const i=4*e[c];s[n]=t[i],s[n+1]=t[i+1],s[n+2]=t[i+2],s[n+3]=t[i+3],n+=a}else for(let c=0;c<o;++c){const i=4*e[c];for(let e=0;e<r;++e)s[n]=t[i],s[n+1]=t[i+1],s[n+2]=t[i+2],s[n+3]=t[i+3],n+=a}}function h(e,t,i,n,r,s=1){if(!i)return void c(e,t,n,r,s);const a=n.typedBuffer,o=n.typedBufferStride,l=e.length,h=i[0],u=i[1],d=i[2],b=i[4],f=i[5],_=i[6],O=i[8],p=i[9],g=i[10],j=i[12],m=i[13],v=i[14];if(r*=o,1===s)for(let c=0;c<l;++c){const i=3*e[c],n=t[i],s=t[i+1],l=t[i+2];a[r]=h*n+b*s+O*l+j,a[r+1]=u*n+f*s+p*l+m,a[r+2]=d*n+_*s+g*l+v,r+=o}else for(let c=0;c<l;++c){const i=3*e[c],n=t[i],l=t[i+1],y=t[i+2],T=h*n+b*l+O*y+j,w=u*n+f*l+p*y+m,A=d*n+_*l+g*y+v;for(let e=0;e<s;++e)a[r]=T,a[r+1]=w,a[r+2]=A,r+=o}}function u(e,t,i,r,s,a=1){if(!i)return void c(e,t,r,s,a);const o=i,l=r.typedBuffer,h=r.typedBufferStride,u=e.length,d=o[0],b=o[1],f=o[2],_=o[4],O=o[5],p=o[6],g=o[8],j=o[9],m=o[10],v=!Object(n["p"])(o),y=1e-6,T=1-y;if(s*=h,1===a)for(let n=0;n<u;++n){const i=3*e[n],r=t[i],a=t[i+1],o=t[i+2];let c=d*r+_*a+g*o,u=b*r+O*a+j*o,w=f*r+p*a+m*o;if(v){const e=c*c+u*u+w*w;if(e<T&&e>y){const t=1/Math.sqrt(e);c*=t,u*=t,w*=t}}l[s+0]=c,l[s+1]=u,l[s+2]=w,s+=h}else for(let n=0;n<u;++n){const i=3*e[n],r=t[i],o=t[i+1],c=t[i+2];let u=d*r+_*o+g*c,w=b*r+O*o+j*c,A=f*r+p*o+m*c;if(v){const e=u*u+w*w+A*A;if(e<T&&e>y){const t=1/Math.sqrt(e);u*=t,w*=t,A*=t}}for(let e=0;e<a;++e)l[s+0]=u,l[s+1]=w,l[s+2]=A,s+=h}}function d(e,t,i,r,s,a=1){if(!i)return void l(e,t,r,s,a);const o=i,c=r.typedBuffer,h=r.typedBufferStride,u=e.length,d=o[0],b=o[1],f=o[2],_=o[4],O=o[5],p=o[6],g=o[8],j=o[9],m=o[10],v=!Object(n["p"])(o),y=1e-6,T=1-y;if(s*=h,1===a)for(let n=0;n<u;++n){const i=4*e[n],r=t[i],a=t[i+1],o=t[i+2],l=t[i+3];let u=d*r+_*a+g*o,w=b*r+O*a+j*o,A=f*r+p*a+m*o;if(v){const e=u*u+w*w+A*A;if(e<T&&e>y){const t=1/Math.sqrt(e);u*=t,w*=t,A*=t}}c[s+0]=u,c[s+1]=w,c[s+2]=A,c[s+3]=l,s+=h}else for(let n=0;n<u;++n){const i=4*e[n],r=t[i],o=t[i+1],l=t[i+2],u=t[i+3];let w=d*r+_*o+g*l,A=b*r+O*o+j*l,P=f*r+p*o+m*l;if(v){const e=w*w+A*A+P*P;if(e<T&&e>y){const t=1/Math.sqrt(e);w*=t,A*=t,P*=t}}for(let e=0;e<a;++e)c[s+0]=w,c[s+1]=A,c[s+2]=P,c[s+3]=u,s+=h}}function b(e,t,i,n,r,s=1){const a=n.typedBuffer,o=n.typedBufferStride,c=e.length;if(r*=o,1===s){if(4===i)for(let l=0;l<c;++l){const i=4*e[l];a[r]=t[i],a[r+1]=t[i+1],a[r+2]=t[i+2],a[r+3]=t[i+3],r+=o}else if(3===i)for(let l=0;l<c;++l){const i=3*e[l];a[r]=t[i],a[r+1]=t[i+1],a[r+2]=t[i+2],a[r+3]=255,r+=o}}else if(4===i)for(let l=0;l<c;++l){const i=4*e[l];for(let e=0;e<s;++e)a[r]=t[i],a[r+1]=t[i+1],a[r+2]=t[i+2],a[r+3]=t[i+3],r+=o}else if(3===i)for(let l=0;l<c;++l){const i=3*e[l];for(let e=0;e<s;++e)a[r]=t[i],a[r+1]=t[i+1],a[r+2]=t[i+2],a[r+3]=255,r+=o}}function f(e,t,i,n,c,l){for(const f of t.fieldNames){const t=e.vertexAttributes.get(f),_=e.indices.get(f);if(t&&_)switch(f){case a["a"].POSITION:{Object(s["a"])(3===t.size);const e=c.getField(f,r["u"]);e&&h(_,t.data,i,e,l);break}case a["a"].NORMAL:{Object(s["a"])(3===t.size);const e=c.getField(f,r["u"]);e&&u(_,t.data,n,e,l);break}case a["a"].UV0:{Object(s["a"])(2===t.size);const e=c.getField(f,r["m"]);e&&o(_,t.data,e,l);break}case a["a"].COLOR:{Object(s["a"])(3===t.size||4===t.size);const e=c.getField(f,r["J"]);e&&b(_,t.data,t.size,e,l);break}case a["a"].SYMBOLCOLOR:{Object(s["a"])(3===t.size||4===t.size);const e=c.getField(f,r["J"]);e&&b(_,t.data,t.size,e,l);break}case a["a"].TANGENT:{Object(s["a"])(4===t.size);const e=c.getField(f,r["C"]);e&&d(_,t.data,n,e,l);break}}}}},"5a22":function(e,t,i){"use strict";i.d(t,"a",(function(){return j}));var n=i("b2b2"),r=i("d791"),s=i("afe1"),a=i("e431"),o=i("0b2d"),c=i("f895"),l=i("680b"),h=i("b7c2"),u=i("003f"),d=i("2765"),b=i("ecd7"),f=i("f2e0");class _{constructor(){this._disposed=!1}get disposed(){return this._disposed}get shaderTransformation(){return this._shaderTransformation}acquire(e,t,i,n,r,s){this.id=Object(f["a"])(),this.geometry=e,this.material=t,this.transformation=i,this.instanceParameters=n,this.origin=r,this._shaderTransformation=s,this._disposed=!1}release(){this._disposed=!1}dispose(){this._disposed=!0}getStaticTransformation(){return this.transformation}getShaderTransformation(){return Object(n["k"])(this._shaderTransformation)?this._shaderTransformation(this.transformation):this.transformation}computeAttachmentOrigin(e){return!!(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,e):this.geometry.computeAttachmentOrigin(e))&&(Object(a["q"])(e,e,this.getStaticTransformation()),!0)}}_.pool=new b["a"](_);var O=i("bea9"),p=i("1153"),g=i("b623");class j extends u["a"]{constructor(e={}){super(),this.type=d["a"].Object,this._geometryRecords=new Array,this._geometries=new Array,this._objectTransformation=Object(s["d"])(),this._bvObjectSpace=new v,this._bvWorldSpace=new v,this._bvDirty=!0,this._hasVolatileTransformation=!1,this._visible=!0,this.castShadow=null==e.castShadow||e.castShadow,this.metadata=e.metadata,this.metadata&&this.metadata.isElevationSource&&(this.metadata.lastValidElevationBB=new m),this.transformation=Object(s["d"])();const{geometries:t,materials:i,transformations:n,origins:r}=e;if(Array.isArray(t)){Object(p["a"])(i.length===t.length,"Object3D: materials don't match geometries"),Object(p["a"])(n.length===t.length,"Object3D: transformations don't match geometries"),this._geometryRecords.length=t.length,this._geometries.length=t.length;for(let e=0;e<t.length;e++)this._geometries[e]=t[e],this._geometryRecords[e]=_.pool.acquire(t[e],i[e],Object(s["c"])(n[e]),{highlights:null,occludees:null,visible:this._visible},r&&r[e])}}get geometryRecords(){return this._geometryRecords}get geometries(){return this._geometries}get transformation(){return this._objectTransformation}set transformation(e){Object(r["c"])(this._objectTransformation,e),this._invalidateBoundingVolume(),this._emit("objectTransformation",this)}dispose(){this._geometryRecords.length=0,this._geometries.length=0}get parentLayer(){return this._parentLayer}set parentLayer(e){Object(p["a"])(null==this._parentLayer||null==e,"Object3D can only be added to a single Layer"),this._parentLayer=e}addGeometry(e,t,i,r,a){i=i||s["a"],this._geometries.push(e);const o=_.pool.acquire(e,t,i,{highlights:null,occludees:null,visible:this._visible},r,a);return this._geometryRecords.push(o),this._hasVolatileTransformation=this._hasVolatileTransformation||Object(n["k"])(o.shaderTransformation),this._emit("objectGeometryAdded",{object:this,record:o}),this._invalidateBoundingVolume(),o}removeGeometry(e){const t=this._geometryRecords.splice(e,1)[0];return this._hasVolatileTransformation=Object(n["k"])(t.shaderTransformation)?this._geometryRecords.some(e=>Object(n["k"])(e.shaderTransformation)):this._hasVolatileTransformation,t.dispose(),this._geometries.splice(e,1),this._emit("objectGeometryRemoved",{object:this,record:t}),this._invalidateBoundingVolume(),t}removeAllGeometries(){for(;this.geometryRecords.length>0;)this.removeGeometry(0)}geometryVertexAttrsUpdated(e){this._emit("vertexAttrsUpdated",{object:this,record:e}),this._invalidateBoundingVolume()}get isVisible(){return this._visible}setVisible(e){if(this._visible!==e){this._visible=e;for(const e of this._geometryRecords)e.instanceParameters.visible=this._visible;this._emit("visibilityChanged",this)}}maskOccludee(){const e=new O["a"](h["d"].MaskOccludee);for(const t of this._geometryRecords)t.instanceParameters.occludees=Object(g["a"])(t.instanceParameters.occludees,e);return this._emit("occlusionChanged",this),e}removeOcclude(e){for(const t of this._geometryRecords)t.instanceParameters.occludees=Object(g["e"])(t.instanceParameters.occludees,e);this._emit("occlusionChanged",this)}highlight(){const e=new O["a"](h["d"].Highlight);for(const t of this._geometryRecords)t.instanceParameters.highlights=Object(g["a"])(t.instanceParameters.highlights,e);return this._emit("highlightChanged",this),e}removeHighlight(e){for(const t of this._geometryRecords)t.instanceParameters.highlights=Object(g["e"])(t.instanceParameters.highlights,e);this._emit("highlightChanged",this)}getCombinedStaticTransformation(e,t){return Object(r["m"])(Object(n["s"])(t,Object(s["d"])()),this.transformation,e.getStaticTransformation())}_getCombinedShaderTransformation(e,t){return t=t||Object(s["d"])(),Object(r["m"])(t,this.transformation,e.getShaderTransformation()),t}hasVolativeTransformation(){return this._hasVolatileTransformation}get boundingVolumeWorldSpace(){return this._validateBoundingVolume(),this._bvWorldSpace}get boundingVolumeObjectSpace(){return this._validateBoundingVolume(),this._bvObjectSpace}_validateBoundingVolume(){if(!this._bvDirty&&!this._hasVolatileTransformation)return;this._bvObjectSpace.init(),this._bvWorldSpace.init();for(let r=0;r<this._geometryRecords.length;++r){const e=this._geometries[r],t=this._geometryRecords[r],i=e.boundingInfo;Object(n["k"])(i)&&(this._calculateTransformedBoundingVolume(i,this._bvObjectSpace,t.getShaderTransformation()),this._calculateTransformedBoundingVolume(i,this._bvWorldSpace,this._getCombinedShaderTransformation(t)))}Object(a["l"])(this._bvObjectSpace.bounds,this._bvObjectSpace.min,this._bvObjectSpace.max,.5),Object(a["l"])(this._bvWorldSpace.bounds,this._bvWorldSpace.min,this._bvWorldSpace.max,.5);const e=Object(o["f"])(),t=Object(o["f"])(),i=Object(l["a"])(this.transformation);for(let r=0;r<this._geometryRecords.length;++r){const s=this._geometries[r].boundingInfo;if(Object(n["j"])(s))continue;const o=this._geometryRecords[r].getShaderTransformation(),c=Object(l["a"])(o);Object(a["q"])(e,s.getCenter(),o);const h=Object(a["m"])(e,this._bvObjectSpace.bounds),u=s.getBSRadius()*c;this._bvObjectSpace.bounds[3]=Math.max(this._bvObjectSpace.bounds[3],h+u),Object(a["q"])(t,e,this.transformation);const d=Object(a["m"])(t,this._bvWorldSpace.bounds),b=u*i;this._bvWorldSpace.bounds[3]=Math.max(this._bvWorldSpace.bounds[3],d+b)}this._bvDirty=!1}_calculateTransformedBoundingVolume(e,t,i){const n=e.getBBMin(),r=e.getBBMax(),s=Object(o["d"])(n),c=Object(o["d"])(r);Object(a["q"])(s,s,i),Object(a["q"])(c,c,i);for(let a=0;a<3;++a)t.min[a]=Math.min(t.min[a],s[a],c[a]),t.max[a]=Math.max(t.max[a],s[a],c[a]);for(let o=0;o<3;++o){Object(a["g"])(s,n),Object(a["g"])(c,r),s[o]=r[o],c[o]=n[o],Object(a["q"])(s,s,i),Object(a["q"])(c,c,i);for(let e=0;e<3;++e)t.min[e]=Math.min(t.min[e],s[e],c[e]),t.max[e]=Math.max(t.max[e],s[e],c[e])}}_invalidateBoundingVolume(){this._bvDirty=!0,Object(n["k"])(this._parentLayer)&&this._parentLayer.notifyObjectBBChanged(this,this._bvWorldSpace.bounds)}_emit(e,t){Object(n["k"])(this._parentLayer)&&this._parentLayer.events.emit(e,t)}get test(){const e=this;return{hasGeometry:t=>e._geometries.includes(t),getGeometryIndex:t=>e._geometries.indexOf(t)}}}class m{constructor(){this.min=Object(o["h"])(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this.max=Object(o["h"])(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}isEmpty(){return this.max[0]<this.min[0]&&this.max[1]<this.min[1]&&this.max[2]<this.min[2]}}class v extends m{constructor(){super(...arguments),this.bounds=Object(c["c"])()}init(){Object(a["w"])(this.min,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),Object(a["w"])(this.max,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),Object(c["a"])(this.bounds)}}},"5d7f":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("62ae");class r extends n["a"]{constructor(e){super(e,"sampler2D")}}},"614d":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.MATERIAL=0]="MATERIAL",e[e.MATERIAL_ALPHA=1]="MATERIAL_ALPHA",e[e.MATERIAL_DEPTH=2]="MATERIAL_DEPTH",e[e.MATERIAL_NORMAL=3]="MATERIAL_NORMAL",e[e.MATERIAL_DEPTH_SHADOWMAP_ALL=4]="MATERIAL_DEPTH_SHADOWMAP_ALL",e[e.MATERIAL_HIGHLIGHT=5]="MATERIAL_HIGHLIGHT",e[e.MATERIAL_DEPTH_SHADOWMAP_DEFAULT=6]="MATERIAL_DEPTH_SHADOWMAP_DEFAULT",e[e.MATERIAL_DEPTH_SHADOWMAP_HIGHLIGHT=7]="MATERIAL_DEPTH_SHADOWMAP_HIGHLIGHT"}(n||(n={}))},"62ae":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("b2b2"),r=i("52b2");class s{constructor(e,t,i,s,a=null){this.name=e,this.type=t,this.arraySize=a,this.bind={[r["a"].Pass]:null,[r["a"].Draw]:null},Object(n["k"])(i)&&Object(n["k"])(s)&&(this.bind[i]=s)}equals(e){return this.type===e.type&&this.name===e.name&&this.arraySize===e.arraySize}}},"647b":function(e,t,i){"use strict";i.d(t,"a",(function(){return Z}));var n=i("b2b2"),r=i("e431"),s=i("0b2d"),a=i("bd7e"),o=i("f53a"),c=i("38a4"),l=i("7577"),h=i("0fc4"),u=i("4f8b"),d=i("d359"),b=i("7289"),f=i("d18f"),_=i("f895"),O=i("2ebb"),p=i("fc00"),g=i("b7bd"),j=i("c3a4"),m=i("ca98"),v=i("c829"),y=i("56d6"),T=i("d17d"),w=i("189c");class A extends m["a"]{initializeProgram(e){const t=A.shader.get().build(this.configuration);return new v["a"](e.rctx,t,A.attributeLocations)}initializePipeline(){return Object(w["f"])({blending:Object(w["h"])(T["b"].ONE,T["b"].ONE_MINUS_SRC_ALPHA),colorWrite:w["c"]})}}A.shader=new j["a"](y["a"],()=>i.e("chunk-2d22cca6").then(i.bind(null,"f578"))),A.attributeLocations=new Map([[g["a"].START,0],[g["a"].END,1],[g["a"].UP,2],[g["a"].EXTRUDE,3]]);var P=i("7ce4"),E=i("0fa6");class S{constructor(e){this._renderCoordsHelper=e,this._buffers=null,this._origin=Object(s["f"])(),this._dirty=!1,this._count=0,this._vao=null}set vertices(e){const t=new Float64Array(3*e.length);let i=0;for(const n of e)t[i++]=n[0],t[i++]=n[1],t[i++]=n[2];this.buffers=[t]}set buffers(e){if(this._buffers=e,this._buffers.length>0){const e=this._buffers[0],t=3*Math.floor(e.length/3/2);Object(r["w"])(this._origin,e[t+0],e[t+1],e[t+2])}else Object(r["w"])(this._origin,0,0,0);this._dirty=!0}get origin(){return this._origin}draw(e){const t=this._ensureVAO(e);Object(n["k"])(t)&&(e.bindVAO(t),e.drawArrays(T["r"].TRIANGLES,0,this._count))}dispose(){Object(n["k"])(this._vao)&&this._vao.dispose()}_ensureVAO(e){return Object(n["j"])(this._buffers)?null:(Object(n["j"])(this._vao)&&(this._vao=this._createVAO(e,this._buffers)),this._ensureVertexData(this._vao,this._buffers),this._vao)}_createVAO(e,t){const i=this._createDataBuffer(t);return this._dirty=!1,new E["a"](e,A.attributeLocations,{data:Object(O["a"])(M)},{data:P["a"].createVertex(e,T["D"].STATIC_DRAW,i)})}_ensureVertexData(e,t){if(!this._dirty)return;const i=this._createDataBuffer(t);e.vertexBuffers.data.setData(i),this._dirty=!1}_numberOfRenderVertices(e){return 2*(e.length/3-1)*3}_createDataBuffer(e){const t=e.reduce((e,t)=>e+this._numberOfRenderVertices(t),0);this._count=t;const i=M.createBuffer(t),n=this._origin;let s=0,a=0;for(const o of e){for(let e=0;e<o.length;e+=3){const t=Object(r["w"])(R,o[e+0],o[e+1],o[e+2]);0===e?a=this._renderCoordsHelper.getAltitude(t):this._renderCoordsHelper.setAltitude(t,a);const c=this._renderCoordsHelper.worldUpAtPosition(t,x),l=s+2*e,h=Object(r["f"])(R,t,n);if(e<o.length-3){i.up.setVec(l,c),i.up.setVec(l+3,c),i.up.setVec(l+5,c);for(let e=0;e<6;e++)i.start.setVec(l+e,h);i.extrude.setValues(l+0,0,-1),i.extrude.setValues(l+1,1,-1),i.extrude.setValues(l+2,1,1),i.extrude.setValues(l+3,0,-1),i.extrude.setValues(l+4,1,1),i.extrude.setValues(l+5,0,1)}if(e>0){i.up.setVec(l-2,c),i.up.setVec(l-4,c),i.up.setVec(l-5,c);for(let e=-6;e<0;e++)i.end.setVec(l+e,h)}}s+=this._numberOfRenderVertices(o)}return i.buffer}}const x=Object(s["f"])(),R=Object(s["f"])(),M=Object(p["a"])().vec3f(g["a"].START).vec3f(g["a"].END).vec3f(g["a"].UP).vec2f(g["a"].EXTRUDE);var L=i("d5f7"),D=i("badc"),I=i("7c51"),N=i("a4ee"),V=i("da35");class C extends V["a"]{constructor(){super(...arguments),this.contrastControlEnabled=!1}}Object(N["a"])([Object(V["b"])()],C.prototype,"contrastControlEnabled",void 0);var F=i("3886"),U=i("fa1e"),k=i("a997");F["a"];class B extends m["a"]{initializeProgram(e){const t=B.shader.get().build(this.configuration);return new v["a"](e.rctx,t,U["a"])}initializePipeline(){return Object(w["f"])({blending:Object(w["h"])(T["b"].ONE,T["b"].ONE_MINUS_SRC_ALPHA),colorWrite:w["c"]})}}B.shader=new j["a"](k["a"],()=>i.e("chunk-2d2248f1").then(i.bind(null,"e13b")));class z extends C{constructor(){super(...arguments),this.heightManifoldEnabled=!1,this.pointDistanceEnabled=!1,this.lineVerticalPlaneEnabled=!1,this.intersectsLineEnabled=!1}}Object(N["a"])([Object(V["b"])()],z.prototype,"heightManifoldEnabled",void 0),Object(N["a"])([Object(V["b"])()],z.prototype,"pointDistanceEnabled",void 0),Object(N["a"])([Object(V["b"])()],z.prototype,"lineVerticalPlaneEnabled",void 0),Object(N["a"])([Object(V["b"])()],z.prototype,"intersectsLineEnabled",void 0);const G=Object(s["f"])(),H=Object(h["e"])(),q={glowColor:[1,.5,0],glowWidth:8,glowFalloff:8,innerColor:[1,1,1],innerWidth:1,globalAlpha:.75,angleCutoff:Object(c["g"])(6),globalAlphaContrastBoost:2,__tagStrict:"NoParameters"};function W(e,t,i,n){const s=G,a=H;Object(r["q"])(s,t,n),Object(r["g"])(a,i),a[3]=0,Object(l["m"])(a,a,n),Object(b["g"])(s,a,e)}class ${constructor(e,t={},i={contrastControlEnabled:!1}){this._renderCoordsHelper=e,this._config=i,this._technique=null,this._heightManifoldEnabled=!1,this._heightManifoldTarget=Object(s["f"])(),this._pointDistanceEnabled=!1,this._pointDistanceOrigin=Object(s["f"])(),this._pointDistanceTarget=Object(s["f"])(),this._lineVerticalPlaneEnabled=!1,this._lineVerticalPlaneSegment=Object(a["d"])(),this._intersectsLineEnabled=!1,this._intersectsLineSegment=Object(a["d"])(),this._intersectsLineRadius=3,this._intersectsLineInfinite=!1,this._pathVerticalPlaneEnabled=!1,this._pathVerticalPlaneData=null,this._pathTechnique=null,this.canRender=!0,this._tempNormal=Object(s["f"])(),this._tempDir=Object(s["f"])(),this._tempUp=Object(s["f"])(),this._tempVec3A=Object(s["f"])(),this._tempVec3B=Object(s["f"])(),this._tempVec4=Object(h["e"])(),this._tempPlane=Object(b["d"])(),this._tempSphere=Object(_["c"])(),this._parameters=Object(I["b"])(t,q)}get renderSlots(){return[this._config.contrastControlEnabled?D["a"].LASERLINES_CONTRAST_CONTROL:D["a"].LASERLINES]}get needsLinearDepth(){return!0}get heightManifoldEnabled(){return this._heightManifoldEnabled}set heightManifoldEnabled(e){this._heightManifoldEnabled!==e&&(this._heightManifoldEnabled=e,this._requestRender())}get heightManifoldTarget(){return this._heightManifoldTarget}set heightManifoldTarget(e){Object(r["g"])(this._heightManifoldTarget,e),this._requestRender()}get pointDistanceEnabled(){return this._pointDistanceEnabled}set pointDistanceEnabled(e){e!==this._pointDistanceEnabled&&(this._pointDistanceEnabled=e,this._requestRender())}get pointDistanceTarget(){return this._pointDistanceTarget}set pointDistanceTarget(e){Object(r["g"])(this._pointDistanceTarget,e),this._requestRender()}get pointDistanceOrigin(){return this._pointDistanceOrigin}set pointDistanceOrigin(e){Object(r["g"])(this._pointDistanceOrigin,e),this._requestRender()}get lineVerticalPlaneEnabled(){return this._lineVerticalPlaneEnabled}set lineVerticalPlaneEnabled(e){e!==this._lineVerticalPlaneEnabled&&(this._lineVerticalPlaneEnabled=e,this._requestRender())}get lineVerticalPlaneSegment(){return this._lineVerticalPlaneSegment}set lineVerticalPlaneSegment(e){Object(a["c"])(e,this._lineVerticalPlaneSegment),this._requestRender()}get intersectsLineEnabled(){return this._intersectsLineEnabled}set intersectsLineEnabled(e){e!==this._intersectsLineEnabled&&(this._intersectsLineEnabled=e,this._requestRender())}get intersectsLineSegment(){return this._intersectsLineSegment}set intersectsLineSegment(e){Object(a["c"])(e,this._intersectsLineSegment),this._requestRender()}get intersectsLineRadius(){return this._intersectsLineRadius}set intersectsLineRadius(e){e!==this._intersectsLineRadius&&(this._intersectsLineRadius=e,this._requestRender())}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(e){e!==this._intersectsLineInfinite&&(this._intersectsLineInfinite=e,this._requestRender())}get pathVerticalPlaneEnabled(){return this._pathVerticalPlaneEnabled}set pathVerticalPlaneEnabled(e){e!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=e,Object(n["k"])(this._pathVerticalPlaneData)&&this._requestRender())}set pathVerticalPlaneVertices(e){Object(n["j"])(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new S(this._renderCoordsHelper)),this._pathVerticalPlaneData.vertices=e,this.pathVerticalPlaneEnabled&&this._requestRender()}set pathVerticalPlaneBuffers(e){Object(n["j"])(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new S(this._renderCoordsHelper)),this._pathVerticalPlaneData.buffers=e,this.pathVerticalPlaneEnabled&&this._requestRender()}setParameters(e){Object(I["g"])(this._parameters,e)&&this._requestRender()}initializeRenderContext(e){this._context=e;const t=e.renderContext.rctx;this._quadVAO=Object(L["b"])(t),this._techniqueRepository=e.shaderTechniqueRepository,this._techniqueConfig=new z;const i=new C;i.contrastControlEnabled=this._config.contrastControlEnabled,this._pathTechnique=this._techniqueRepository.acquire(A,i)}uninitializeRenderContext(){this._quadVAO=Object(n["e"])(this._quadVAO),this._technique=Object(n["p"])(this._technique),this._pathVerticalPlaneData=Object(n["e"])(this._pathVerticalPlaneData),this._pathTechnique=Object(n["p"])(this._pathTechnique)}prepareTechnique(){return this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled?(this._techniqueConfig.heightManifoldEnabled=this.heightManifoldEnabled,this._techniqueConfig.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled,this._techniqueConfig.pointDistanceEnabled=this.pointDistanceEnabled,this._techniqueConfig.intersectsLineEnabled=this.intersectsLineEnabled,this._techniqueConfig.contrastControlEnabled=this._config.contrastControlEnabled,this._technique=this._techniqueRepository.releaseAndAcquire(B,this._techniqueConfig,this._technique),this._technique):this._pathTechnique}render(e,t){(this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled)&&this._renderUnified(e,t),this.pathVerticalPlaneEnabled&&this._renderPath(e)}_renderUnified(e,t){const i=e.rctx,n=i.bindTechnique(t,this._parameters,e.bindParameters);this._bindGlobalUniforms(e,n),this._bindHeightManifoldUniforms(e,n),this._bindPointDistanceUniforms(e,n),this._bindLineVerticalPlaneUniforms(e,n),this._bindIntersectsLineUniforms(e,n),i.bindVAO(this._quadVAO),i.drawArrays(T["r"].TRIANGLE_STRIP,0,4)}_renderPath(e){if(Object(n["j"])(this._pathVerticalPlaneData)||Object(n["j"])(this._pathTechnique))return;const t=e.rctx,i=this._pathTechnique,r=t.bindTechnique(i,{...this._parameters,origin:this._pathVerticalPlaneData.origin},e.bindParameters);this._bindGlobalUniforms(e,r),this._pathVerticalPlaneData.draw(e.rctx)}_bindHeightManifoldUniforms(e,t){if(!this.heightManifoldEnabled)return;const i=this._tempVec3A,n=this._tempPlane,r=e.bindParameters.camera;this._renderCoordsHelper.worldUpAtPosition(this._heightManifoldTarget,i),W(n,this._heightManifoldTarget,i,r.viewMatrix),t.setUniform4fv("heightPlane",n)}_bindPointDistanceUniforms(e,t){if(!this._pointDistanceEnabled)return;const i=e.bindParameters.camera,n=this._tempSphere;Object(r["g"])(n,this._pointDistanceOrigin),Object(r["q"])(n,n,i.viewMatrix),n[3]=Object(r["m"])(this._pointDistanceOrigin,this._pointDistanceTarget),t.setUniform4f("pointDistanceSphere",n[0],n[1],n[2],n[3])}_bindLineVerticalPlaneUniforms(e,t){if(!this._lineVerticalPlaneEnabled)return;const i=this._renderCoordsHelper,n=e.bindParameters.camera,s=this._tempPlane,o=this._tempVec3A,c=this._tempUp,l=this._tempDir,h=this._tempNormal;Object(a["h"])(this._lineVerticalPlaneSegment,.5,o),i.worldUpAtPosition(o,c),Object(r["r"])(l,this._lineVerticalPlaneSegment.vector),Object(r["j"])(h,c,l),Object(r["r"])(h,h),W(s,this._lineVerticalPlaneSegment.origin,h,n.viewMatrix),t.setUniform4fv("lineVerticalPlane",s);const u=this._tempVec3A;Object(r["g"])(u,this._lineVerticalPlaneSegment.origin),i.setAltitude(u,0),Object(r["q"])(u,u,n.viewMatrix),t.setUniform3fv("lineVerticalStart",u);const d=this._tempVec3B;Object(r["e"])(d,this._lineVerticalPlaneSegment.origin,this._lineVerticalPlaneSegment.vector),i.setAltitude(d,0),Object(r["q"])(d,d,n.viewMatrix),t.setUniform3fv("lineVerticalEnd",d)}_bindIntersectsLineUniforms(e,t){if(!this._intersectsLineEnabled)return;const i=Y,n=K,s=e.bindParameters.camera;if(this._intersectsLineInfinite){if(Object(u["c"])(Object(f["g"])(this._intersectsLineSegment.origin,this._intersectsLineSegment.vector),X),X.c0=-Number.MAX_VALUE,!Object(d["e"])(s.frustum,X))return;Object(u["e"])(X,i),Object(u["d"])(X,n)}else Object(r["g"])(i,this._intersectsLineSegment.origin),Object(r["e"])(n,this._intersectsLineSegment.origin,this._intersectsLineSegment.vector);const a=this._tempVec3A;Object(r["q"])(a,i,s.viewMatrix),t.setUniform3fv("intersectsLineStart",a);const o=this._tempVec4;Object(r["g"])(o,this._intersectsLineSegment.vector),this._tempVec4[3]=0,Object(l["m"])(this._tempVec4,this._tempVec4,s.viewMatrix),Object(r["q"])(n,n,s.viewMatrix),t.setUniform3fv("intersectsLineEnd",n),Object(r["r"])(o,o),t.setUniform3f("intersectsLineDirection",o[0],o[1],o[2]),t.setUniform1f("intersectsLineRadius",this._intersectsLineRadius)}_bindGlobalUniforms(e,t){const i=e.bindParameters.camera;this._heightManifoldEnabled?t.setUniform1f("maxPixelDistance",2*i.computeScreenPixelSizeAt(this._heightManifoldTarget)):this._pointDistanceEnabled?t.setUniform1f("maxPixelDistance",2*i.computeScreenPixelSizeAt(this._pointDistanceTarget)):this._lineVerticalPlaneEnabled&&t.setUniform1f("maxPixelDistance",2*i.computeScreenPixelSizeAt(this._lineVerticalPlaneSegment.origin)),t.bindTexture("frameColor",e.offscreenRenderingHelper.mainColorTexture)}_requestRender(){this._context&&this._context.requestRender()}}const X=Object(u["a"])(),Y=Object(s["f"])(),K=Object(s["f"])();class Z extends o["a"]{constructor(e){super(e.view),this._angleCutoff=k["c"],this._style={},this._heightManifoldTarget=Object(s["f"])(),this._heightManifoldEnabled=!1,this._intersectsLine=Object(a["d"])(),this._intersectsLineEnabled=!1,this._intersectsLineInfinite=!1,this._lineVerticalPlaneSegment=null,this._pathVerticalPlaneBuffers=null,this._pointDistanceLine=null,this.applyProps(e)}get testData(){return this.renderer}createResources(){this._ensureRenderer()}destroyResources(){this._disposeRenderer()}updateVisibility(){this._syncRenderer(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance()}get angleCutoff(){return this._angleCutoff}set angleCutoff(e){this._angleCutoff!==e&&(this._angleCutoff=e,this._syncAngleCutoff())}get style(){return this._style}set style(e){this._style=e,this._syncStyle()}get heightManifoldTarget(){return this._heightManifoldEnabled?this._heightManifoldTarget:null}set heightManifoldTarget(e){Object(n["k"])(e)?(Object(r["g"])(this._heightManifoldTarget,e),this._heightManifoldEnabled=!0):this._heightManifoldEnabled=!1,this._syncRenderer(),this._syncHeightManifold()}set intersectsWorldUpAtLocation(e){if(Object(n["j"])(e))return void(this.intersectsLine=null);const t=this.view.renderCoordsHelper.worldUpAtPosition(e,Q);this.intersectsLine=Object(a["g"])(e,t),this.intersectsLineInfinite=!0}get intersectsLine(){return this._intersectsLineEnabled?this._intersectsLine:null}set intersectsLine(e){Object(n["k"])(e)?(Object(a["c"])(e,this._intersectsLine),this._intersectsLineEnabled=!0):this._intersectsLineEnabled=!1,this._syncIntersectsLine(),this._syncRenderer()}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(e){this._intersectsLineInfinite=e,this._syncIntersectsLineInfinite()}get lineVerticalPlaneSegment(){return this._lineVerticalPlaneSegment}set lineVerticalPlaneSegment(e){this._lineVerticalPlaneSegment=Object(n["k"])(e)?Object(a["c"])(e):null,this._syncLineVerticalPlane(),this._syncRenderer()}get pathVerticalPlane(){return this._pathVerticalPlaneBuffers}set pathVerticalPlane(e){this._pathVerticalPlaneBuffers=e,this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncRenderer()}get pointDistanceLine(){return this._pointDistanceLine}set pointDistanceLine(e){this._pointDistanceLine=Object(n["k"])(e)?{origin:Object(s["d"])(e.origin),target:Object(s["d"])(e.target)}:null,this._syncPointDistance(),this._syncRenderer()}_syncRenderer(){this.attached&&this.visible&&(this._intersectsLineEnabled||this._heightManifoldEnabled||Object(n["k"])(this._pointDistanceLine)||Object(n["k"])(this._pathVerticalPlaneBuffers))?this._ensureRenderer():this._disposeRenderer()}_ensureRenderer(){Object(n["k"])(this.renderer)||(this.renderer=new $(this.view.renderCoordsHelper,void 0,{contrastControlEnabled:!0}),this._syncStyle(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncIntersectsLineInfinite(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncAngleCutoff(),this.view._stage&&this.view._stage.addRenderPlugin(this.renderer.renderSlots,this.renderer))}_syncStyle(){Object(n["j"])(this.renderer)||(this.renderer.setParameters(this._style),null!=this._style.intersectsLineRadius&&(this.renderer.intersectsLineRadius=this._style.intersectsLineRadius))}_syncAngleCutoff(){Object(n["j"])(this.renderer)||this.renderer.setParameters({angleCutoff:this._angleCutoff})}_syncHeightManifold(){Object(n["j"])(this.renderer)||(this.renderer.heightManifoldEnabled=this._heightManifoldEnabled&&this.visible,this._heightManifoldEnabled&&(this.renderer.heightManifoldTarget=this._heightManifoldTarget))}_syncIntersectsLine(){Object(n["j"])(this.renderer)||(this.renderer.intersectsLineEnabled=this._intersectsLineEnabled&&this.visible,this._intersectsLineEnabled&&(this.renderer.intersectsLineSegment=this._intersectsLine))}_syncIntersectsLineInfinite(){Object(n["j"])(this.renderer)||(this.renderer.intersectsLineInfinite=this._intersectsLineInfinite)}_syncPathVerticalPlane(){Object(n["j"])(this.renderer)||(this.renderer.pathVerticalPlaneEnabled=Object(n["k"])(this._pathVerticalPlaneBuffers)&&this.visible,Object(n["k"])(this._pathVerticalPlaneBuffers)&&(this.renderer.pathVerticalPlaneBuffers=this._pathVerticalPlaneBuffers))}_syncLineVerticalPlane(){Object(n["j"])(this.renderer)||(this.renderer.lineVerticalPlaneEnabled=Object(n["k"])(this._lineVerticalPlaneSegment)&&this.visible,Object(n["k"])(this._lineVerticalPlaneSegment)&&(this.renderer.lineVerticalPlaneSegment=this._lineVerticalPlaneSegment))}_syncPointDistance(){Object(n["j"])(this.renderer)||(this.renderer.pointDistanceEnabled=Object(n["k"])(this._pointDistanceLine)&&this.visible,Object(n["k"])(this._pointDistanceLine)&&(this.renderer.pointDistanceOrigin=this._pointDistanceLine.origin,this.renderer.pointDistanceTarget=this._pointDistanceLine.target))}_disposeRenderer(){Object(n["k"])(this.renderer)&&this.view._stage&&(this.view._stage.removeRenderPlugin(this.renderer),this.renderer=null)}}const Q=Object(s["f"])()},"666b":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("62ae");class r extends n["a"]{constructor(e){super(e,"vec3")}}},"690a":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("ce50"),r=i("e92d"),s=i("b2b2");const a=r["a"].getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");class o{constructor(){this.includedModules=new Map}include(e,t){if(this.includedModules.has(e)){const i=this.includedModules.get(e);if(i!==t){a.error("Trying to include shader module multiple times with different sets of options.");const t=new Set;for(const n of Object.keys(i))i[n]!==e[n]&&t.add(n);for(const n of Object.keys(e))i[n]!==e[n]&&t.add(n);t.forEach(t=>console.error(`  ${t}: current ${i[t]} new ${e[t]}`))}}else this.includedModules.set(e,t),e(this.builder,t)}}class c extends o{constructor(){super(...arguments),this.vertex=new u,this.fragment=new u,this.attributes=new d,this.varyings=new b,this.extensions=new f,this.constants=new _}get fragmentUniforms(){return this.fragment.uniforms.entries}get builder(){return this}generate(e){const t=this.extensions.generateSource(e),i=this.attributes.generateSource(e),n=this.varyings.generateSource(),r="vertex"===e?this.vertex:this.fragment,s=r.uniforms.generateSource(),a=r.code.generateSource(),o="vertex"===e?p:O,c=this.constants.generateSource().concat(r.constants.generateSource());return`\n${t.join("\n")}\n\n${o}\n\n${c.join("\n")}\n\n${s.join("\n")}\n\n${i.join("\n")}\n\n${n.join("\n")}\n\n${a.join("\n")}`}generateBind(e,t){const i=new Map;this.vertex.uniforms.entries.forEach(t=>{const n=t.bind[e];Object(s["k"])(n)&&i.set(t.name,n)}),this.fragment.uniforms.entries.forEach(t=>{const n=t.bind[e];Object(s["k"])(n)&&i.set(t.name,n)});const n=Array.from(i.values()),r=n.length;return(e,i)=>{for(let s=0;s<r;++s)n[s](t,e,i)}}}class l{constructor(){this._entries=new Map}add(e){if(!Array.isArray(e))return this._add(e);for(const t of e)this._add(t)}_add(e){if(this._entries.has(e.name)&&!this._entries.get(e.name).equals(e))throw new n["a"](`Duplicate uniform name ${e.name} for different uniform type`);this._entries.set(e.name,e)}generateSource(){return Array.from(this._entries.values()).map(e=>Object(s["k"])(e.arraySize)?`uniform ${e.type} ${e.name}[${e.arraySize}];`:`uniform ${e.type} ${e.name};`)}get entries(){return Array.from(this._entries.values())}}class h{constructor(){this._entries=new Array}add(e){this._entries.push(e)}generateSource(){return this._entries}}class u extends o{constructor(){super(...arguments),this.uniforms=new l,this.code=new h,this.constants=new _}get builder(){return this}}class d{constructor(){this._entries=new Array}add(e,t){this._entries.push([e,t])}generateSource(e){return"fragment"===e?[]:this._entries.map(e=>`attribute ${e[1]} ${e[0]};`)}}class b{constructor(){this._entries=new Array}add(e,t){this._entries.push([e,t])}generateSource(){return this._entries.map(e=>`varying ${e[1]} ${e[0]};`)}}class f{constructor(){this._entries=new Set}add(e){this._entries.add(e)}generateSource(e){const t="vertex"===e?f.ALLOWLIST_VERTEX:f.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter(e=>t.includes(e)).map(e=>`#extension ${e} : enable`)}}f.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],f.ALLOWLIST_VERTEX=[];class _{constructor(){this._entries=new Set}add(e,t,i){let n="ERROR_CONSTRUCTOR_STRING";switch(t){case"float":n=_._numberToFloatStr(i);break;case"int":n=_._numberToIntStr(i);break;case"bool":n=i.toString();break;case"vec2":n=`vec2(${_._numberToFloatStr(i[0])},                            ${_._numberToFloatStr(i[1])})`;break;case"vec3":n=`vec3(${_._numberToFloatStr(i[0])},                            ${_._numberToFloatStr(i[1])},                            ${_._numberToFloatStr(i[2])})`;break;case"vec4":n=`vec4(${_._numberToFloatStr(i[0])},                            ${_._numberToFloatStr(i[1])},                            ${_._numberToFloatStr(i[2])},                            ${_._numberToFloatStr(i[3])})`;break;case"ivec2":n=`ivec2(${_._numberToIntStr(i[0])},                             ${_._numberToIntStr(i[1])})`;break;case"ivec3":n=`ivec3(${_._numberToIntStr(i[0])},                             ${_._numberToIntStr(i[1])},                             ${_._numberToIntStr(i[2])})`;break;case"ivec4":n=`ivec4(${_._numberToIntStr(i[0])},                             ${_._numberToIntStr(i[1])},                             ${_._numberToIntStr(i[2])},                             ${_._numberToIntStr(i[3])})`;break;case"mat2":case"mat3":case"mat4":n=`${t}(${Array.prototype.map.call(i,e=>_._numberToFloatStr(e)).join(", ")})`}return this._entries.add(`const ${t} ${e} = ${n};`),this}static _numberToIntStr(e){return e.toFixed(0)}static _numberToFloatStr(e){return Number.isInteger(e)?e.toFixed(1):e.toString()}generateSource(){return Array.from(this._entries)}}const O="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif",p="precision highp float;\nprecision highp sampler2D;"},"692f":function(e,t,i){"use strict";i.d(t,"a",(function(){return y})),i.d(t,"b",(function(){return j}));var n=i("0fc4"),r=i("2252"),s=i("a05b"),a=i("d272"),o=i("4db9"),c=i("c6d7"),l=i("3976"),h=i("4377"),u=i("8e97"),d=i("ea32"),b=i("fd48"),f=i("3886"),_=i("85b3"),O=i("690a"),p=i("b7c2"),g=i("b7bd");function j(e){const t=new O["a"],i=e.hasMultipassTerrain&&(e.output===s["a"].Color||e.output===s["a"].Alpha);t.include(o["a"]),t.include(r["a"],e),t.include(a["a"],e);const{vertex:n,fragment:j}=t;return j.include(h["a"]),Object(u["b"])(t,e),j.uniforms.add(new b["a"]("uColor",e=>e.color)),t.attributes.add(g["a"].POSITION,"vec3"),t.varyings.add("vWorldPosition","vec3"),i&&t.varyings.add("depth","float"),e.screenSizeEnabled&&t.attributes.add(g["a"].OFFSET,"vec3"),e.shadingEnabled&&(n.uniforms.add(new _["a"]("viewNormal",(e,t)=>t.camera.viewInverseTransposeMatrix)),t.attributes.add(g["a"].NORMAL,"vec3"),t.varyings.add("vViewNormal","vec3")),n.code.add(f["b"]`
    void main(void) {
      vWorldPosition = ${e.screenSizeEnabled?"screenSizeScaling(offset, position)":"position"};
  `),e.shadingEnabled&&n.code.add(f["b"]`vec3 worldNormal = normal;
vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),n.code.add(f["b"]`
    ${i?"depth = (view * vec4(vWorldPosition, 1.0)).z;":""}
    gl_Position = transformPosition(proj, view, vWorldPosition);
  }
  `),i&&t.include(c["b"],e),j.code.add(f["b"]`
    void main() {
      discardBySlice(vWorldPosition);
      ${i?"terrainDepthTest(gl_FragCoord, depth);":""}
    `),e.shadingEnabled?(j.uniforms.add(new d["a"]("shadingDirection",e=>e.shadingDirection)),j.uniforms.add(new b["a"]("shadedColor",e=>m(e.shadingTint,e.color))),j.code.add(f["b"]`vec3 viewNormalNorm = normalize(vViewNormal);
float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`)):j.code.add(f["b"]`vec4 finalColor = uColor;`),j.code.add(f["b"]`
      if (finalColor.a < ${f["b"].float(l["b"])}) {
        discard;
      }
      ${e.output===s["a"].Alpha?f["b"]`gl_FragColor = vec4(finalColor.a);`:""}

      ${e.output===s["a"].Color?f["b"]`gl_FragColor = highlightSlice(finalColor, vWorldPosition); ${e.transparencyPassType===p["i"].Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}`:""}
    }
    `),t}function m(e,t){const i=1-e[3],n=e[3]+t[3]*i;return 0===n?(v[3]=n,v):(v[0]=(e[0]*e[3]+t[0]*t[3]*i)/n,v[1]=(e[1]*e[3]+t[1]*t[3]*i)/n,v[2]=(e[2]*e[3]+t[2]*t[3]*i)/n,v[3]=t[3],v)}const v=Object(n["e"])(),y=Object.freeze(Object.defineProperty({__proto__:null,build:j},Symbol.toStringTag,{value:"Module"}))},"6a07":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));i("02f1");var n=i("0fc4"),r=i("d8a4"),s=i("3886"),a=i("6a3c");const o=Object(n["g"])(1,1,0,1),c=Object(n["g"])(1,0,1,1);function l(e){e.fragment.uniforms.add(new a["a"]("depthTex",(e,t)=>t.highlightDepthTexture)),e.fragment.uniforms.add(new r["a"]("highlightViewportPixelSz",(e,t)=>t.inverseViewport)),e.fragment.constants.add("occludedHighlightFlag","vec4",o).add("unoccludedHighlightFlag","vec4",c),e.fragment.code.add(s["b"]`void outputHighlight() {
vec4 fragCoord = gl_FragCoord;
float sceneDepth = texture2D(depthTex, fragCoord.xy * highlightViewportPixelSz.xy).r;
if (fragCoord.z > sceneDepth + 5e-7) {
gl_FragColor = occludedHighlightFlag;
}
else {
gl_FragColor = unoccludedHighlightFlag;
}
}`)}s["a"]},"6a3c":function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return h}));var n=i("b2b2"),r=i("3349"),s=i("02f1"),a=i("d8a4"),o=i("62ae"),c=i("52b2");class l extends o["a"]{constructor(e,t){super(e,"sampler2D",c["a"].Pass,(i,n,r)=>i.bindTexture(e,t(n,r)))}}function h(e,t,i){const o=[new l(e,t)];if(i){const i=e+"Size";o.push(new a["a"](i,(e,i)=>{const a=t(e,i);return Object(n["k"])(a)?Object(r["a"])(u,a.descriptor.width,a.descriptor.height):s["b"]}))}return o}const u=Object(s["c"])()},"6d35":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("a4ee"),r=i("52b2"),s=i("da35");class a extends s["a"]{}Object(n["a"])([Object(s["b"])({constValue:!0})],a.prototype,"hasSliceHighlight",void 0),Object(n["a"])([Object(s["b"])({constValue:!1})],a.prototype,"hasSliceInVertexProgram",void 0),Object(n["a"])([Object(s["b"])({constValue:!1})],a.prototype,"instancedDoublePrecision",void 0),Object(n["a"])([Object(s["b"])({constValue:!1})],a.prototype,"isGround",void 0),Object(n["a"])([Object(s["b"])({constValue:r["a"].Pass})],a.prototype,"pbrTextureBindType",void 0)},"6d5b":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("3886"),r=i("b7bd");function s(e,t){t.hasVertexColors?(e.attributes.add(r["a"].COLOR,"vec4"),e.varyings.add("vColor","vec4"),e.vertex.code.add(n["b"]`void forwardVertexColor() { vColor = color; }`),e.vertex.code.add(n["b"]`void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }`)):e.vertex.code.add(n["b"]`void forwardVertexColor() {}
void forwardNormalizedVertexColor() {}`)}},7438:function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return u})),i.d(t,"c",(function(){return c})),i.d(t,"d",(function(){return a})),i.d(t,"e",(function(){return b})),i.d(t,"f",(function(){return l})),i.d(t,"g",(function(){return f})),i.d(t,"h",(function(){return h}));var n=i("b7c2"),r=i("d17d"),s=i("189c");const a=Object(s["g"])(r["b"].SRC_ALPHA,r["b"].ONE,r["b"].ONE_MINUS_SRC_ALPHA,r["b"].ONE_MINUS_SRC_ALPHA),o=Object(s["h"])(r["b"].ONE,r["b"].ONE),c=Object(s["h"])(r["b"].ZERO,r["b"].ONE_MINUS_SRC_ALPHA);function l(e){return e===n["i"].FrontFace?null:e===n["i"].Alpha?c:o}function h(e){return e===n["i"].FrontFace?s["d"]:null}const u=5e5,d={factor:-1,units:-2};function b(e){return e?d:null}function f(e,t=r["h"].LESS){return e===n["i"].NONE||e===n["i"].FrontFace?t:r["h"].LEQUAL}},"748f":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("ce6d"),r=i("af40"),s=i("b2b2"),a=i("8a44"),o=i("b7c2"),c=i("003f"),l=i("2765");const h=["layerObjectAdded","layerObjectRemoved","layerObjectsAdded","layerObjectsRemoved","shaderTransformationChanged","objectTransformation","visibilityChanged","occlusionChanged","highlightChanged","objectGeometryAdded","objectGeometryRemoved","vertexAttrsUpdated"];var u=i("0bde");class d extends c["a"]{constructor(e,t=""){var i,s,c;super(),this.apiLayerUid=t,this.type=l["a"].Layer,this.events=new n["a"],this.isSliceable=!1,this._objects=new a["a"],this._stageHandles=new r["a"],this.apiLayerUid=t,this.isVisible=null==(i=null==e?void 0:e.isVisible)||i,this.isPickable=null==(s=null==e?void 0:e.isPickable)||s,this.updatePolicy=null!=(c=null==e?void 0:e.updatePolicy)?c:o["j"].ASYNC}get objects(){return this._objects}destroy(){this.detachStage(),this._stage=null}attachStage(e){this.detachStage(),this._stage=e;for(const t of h)this._stageHandles.add(this.events.on(t,i=>e.handleEvent(t,i)))}detachStage(){this._stageHandles.removeAll(),this.invalidateSpatialQueryAccelerator()}add(e){this._objects.push(e),e.parentLayer=this,this.events.emit("layerObjectAdded",{layer:this,object:e}),Object(s["k"])(this._octree)&&this._octree.add([e])}remove(e){this._objects.removeUnordered(e)&&(e.parentLayer=null,this.events.emit("layerObjectRemoved",{layer:this,object:e}),Object(s["k"])(this._octree)&&this._octree.remove([e]))}addMany(e){this._objects.pushArray(e);for(const t of e)t.parentLayer=this;this.events.emit("layerObjectsAdded",{layer:this,objects:e}),Object(s["k"])(this._octree)&&this._octree.add(e)}removeMany(e){const t=new Array;if(this._objects.removeUnorderedMany(e,e.length,t),0!==t.length){for(const e of t)e.parentLayer=null;this.events.emit("layerObjectsRemoved",{layer:this,objects:t}),Object(s["k"])(this._octree)&&this._octree.remove(t)}}sync(){Object(s["k"])(this._stage)&&this.updatePolicy!==o["j"].SYNC&&this._stage.syncLayer(this.id)}notifyObjectBBChanged(e,t){Object(s["k"])(this._octree)&&this._octree.update(e,t)}getSpatialQueryAccelerator(){return Object(s["j"])(this._octree)&&this._objects.length>50&&this._createOctree(),this._octree}shaderTransformationChanged(){this.invalidateSpatialQueryAccelerator(),this.events.emit("shaderTransformationChanged",this)}invalidateSpatialQueryAccelerator(){this._octree=Object(s["d"])(this._octree)}_createOctree(){this._octree=new u["a"](e=>e.boundingVolumeWorldSpace.bounds),this._octree.add(this._objects.data,this._objects.length)}}},"74af":function(e,t,i){"use strict";i.d(t,"a",(function(){return j})),i.d(t,"b",(function(){return m})),i.d(t,"c",(function(){return O})),i.d(t,"d",(function(){return p})),i.d(t,"e",(function(){return g})),i.d(t,"f",(function(){return v})),i.d(t,"g",(function(){return y}));var n=i("b2b2"),r=i("d791"),s=i("e431"),a=i("0fc4"),o=i("7361"),c=i("d3cf"),l=i("4e73"),h=i("ba58"),u=i("b7c2"),d=i("caf7"),b=i("35b3"),f=i("d36e"),_=i("9360");function O(e,t=b["c"].OccludeAndTransparent,i=!0){const n=Object(a["g"])(e[0],e[1],e[2],e.length>3?e[3]:1),r=e[3]<1;return i?new _["a"]({color:n,transparent:r,writeDepth:!0,cullFace:u["b"].Back,renderOccluded:t}):new f["a"]({color:n,transparent:r,writeDepth:!0,cullFace:u["b"].Back,renderOccluded:t})}function p(e,t=b["c"].OccludeAndTransparent){const i=Object(a["g"])(e[0],e[1],e[2],4===e.length?e[3]:1);return new f["a"]({color:i,transparent:!0,writeDepth:!0,cullFace:u["b"].Front,renderOccluded:t})}function g(e,t,i){return new l["a"]({view:e,renderObjects:[{geometry:d["a"].createSphereGeometry(1,32,32),material:O(Object(a["g"])(t[0],t[1],t[2],null!=i?i:1))}]})}function j(e,t,i,n){const a=Object(s["f"])(o["d"].get(),e,i),c=m(a,Object(s["j"])(o["d"].get(),n,a),i,o["a"].get());Object(r["a"])(c,c);const l=Object(s["q"])(o["d"].get(),t,c);return Math.atan2(l[1],l[0])}function m(e,t,i,n){const r=Object(s["r"])(o["d"].get(),e),a=Object(s["r"])(o["d"].get(),t),c=Object(s["j"])(o["d"].get(),r,a);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=0,n[4]=a[0],n[5]=a[1],n[6]=a[2],n[7]=0,n[8]=c[0],n[9]=c[1],n[10]=c[2],n[11]=0,n[12]=i[0],n[13]=i[1],n[14]=i[2],n[15]=1,n}function v(e,t){const i=e.getViewForGraphic(t);return Object(n["k"])(i)&&"computeAttachmentOrigin"in i?i.computeAttachmentOrigin(t,e.spatialReference):null}function y(e,t,i){const r=v(e,i);Object(n["k"])(r)?t.elevationAlignedLocation=r:T(t,i.geometry)}function T(e,t){if(Object(n["j"])(t))return;const i="mesh"===t.type?t.anchor:Object(h["a"])(t);Object(n["j"])(i)||(e.location=Object(c["b"])(i))}},"7c51":function(e,t,i){"use strict";i.d(t,"a",(function(){return L})),i.d(t,"b",(function(){return S})),i.d(t,"c",(function(){return A})),i.d(t,"d",(function(){return R})),i.d(t,"e",(function(){return _})),i.d(t,"f",(function(){return j})),i.d(t,"g",(function(){return x})),i.d(t,"h",(function(){return E}));var n=i("b50f"),r=i("38a4"),s=i("b2b2"),a=i("e431"),o=i("0b2d"),c=i("4261"),l=i("b7c2"),h=i("da1c"),u=i("1153"),d=i("b7bd"),b=i("b623");const f=Object(c["f"])();function _(e,t,i,n,r,s,a){if(!Object(b["d"])(t))if(e.boundingInfo){Object(u["a"])(e.primitiveType===l["f"].Triangle);const t=i.tolerance;p(e.boundingInfo,n,r,t,s,a)}else{const t=e.indices.get(d["a"].POSITION),i=e.vertexAttributes.get(d["a"].POSITION);j(n,r,0,t.length/3,t,i,void 0,s,a)}}const O=Object(o["f"])();function p(e,t,i,n,r,a){if(Object(s["j"])(e))return;const o=w(t,i,O);if(Object(c["y"])(f,e.getBBMin()),Object(c["x"])(f,e.getBBMax()),Object(s["k"])(r)&&r.applyToAabb(f),A(f,t,o,n)){const{primitiveIndices:s,indices:o,position:c}=e,l=s?s.length:o.length/3;if(l>D){const s=e.getChildren();if(void 0!==s){for(let e=0;e<8;++e)void 0!==s[e]&&p(s[e],t,i,n,r,a);return}}j(t,i,0,l,o,c,s,r,a)}}const g=Object(o["f"])();function j(e,t,i,n,r,a,o,c,l){if(o)return m(e,t,i,n,r,a,o,c,l);const h=a.data,u=a.stride||a.size,d=e[0],b=e[1],f=e[2],_=t[0]-d,O=t[1]-b,p=t[2]-f;for(let j=i,m=3*i;j<n;++j){let e=u*r[m++],t=h[e++],i=h[e++],n=h[e];e=u*r[m++];let a=h[e++],o=h[e++],v=h[e];e=u*r[m++];let y=h[e++],w=h[e++],A=h[e];Object(s["k"])(c)&&([t,i,n]=c.applyToVertex(t,i,n,j),[a,o,v]=c.applyToVertex(a,o,v,j),[y,w,A]=c.applyToVertex(y,w,A,j));const P=a-t,E=o-i,S=v-n,x=y-t,R=w-i,M=A-n,L=O*M-R*p,D=p*x-M*_,I=_*R-x*O,N=P*L+E*D+S*I;if(Math.abs(N)<=Number.EPSILON)continue;const V=d-t,C=b-i,F=f-n,U=V*L+C*D+F*I;if(N>0){if(U<0||U>N)continue}else if(U>0||U<N)continue;const k=C*S-E*F,B=F*P-S*V,z=V*E-P*C,G=_*k+O*B+p*z;if(N>0){if(G<0||U+G>N)continue}else if(G>0||U+G<N)continue;const H=(x*k+R*B+M*z)/N;H>=0&&l(H,T(P,E,S,x,R,M,g),j,!1)}}function m(e,t,i,n,r,a,o,c,l){const h=a.data,u=a.stride||a.size,d=e[0],b=e[1],f=e[2],_=t[0]-d,O=t[1]-b,p=t[2]-f;for(let j=i;j<n;++j){const e=o[j];let t=3*e,i=u*r[t++],n=h[i++],a=h[i++],m=h[i];i=u*r[t++];let v=h[i++],y=h[i++],w=h[i];i=u*r[t];let A=h[i++],P=h[i++],E=h[i];Object(s["k"])(c)&&([n,a,m]=c.applyToVertex(n,a,m,j),[v,y,w]=c.applyToVertex(v,y,w,j),[A,P,E]=c.applyToVertex(A,P,E,j));const S=v-n,x=y-a,R=w-m,M=A-n,L=P-a,D=E-m,I=O*D-L*p,N=p*M-D*_,V=_*L-M*O,C=S*I+x*N+R*V;if(Math.abs(C)<=Number.EPSILON)continue;const F=d-n,U=b-a,k=f-m,B=F*I+U*N+k*V;if(C>0){if(B<0||B>C)continue}else if(B>0||B<C)continue;const z=U*R-x*k,G=k*S-R*F,H=F*x-S*U,q=_*z+O*G+p*H;if(C>0){if(q<0||B+q>C)continue}else if(q>0||B+q<C)continue;const W=(M*z+L*G+D*H)/C;W>=0&&l(W,T(S,x,R,M,L,D,g),e,!1)}}const v=Object(o["f"])(),y=Object(o["f"])();function T(e,t,i,n,r,s,o){return Object(a["w"])(v,e,t,i),Object(a["w"])(y,n,r,s),Object(a["j"])(o,v,y),Object(a["r"])(o,o),o}function w(e,t,i){return Object(a["w"])(i,1/(t[0]-e[0]),1/(t[1]-e[1]),1/(t[2]-e[2]))}function A(e,t,i,n){return P(e,t,i,n,1/0)}function P(e,t,i,n,r){const s=(e[0]-n-t[0])*i[0],a=(e[3]+n-t[0])*i[0];let o=Math.min(s,a),c=Math.max(s,a);const l=(e[1]-n-t[1])*i[1],h=(e[4]+n-t[1])*i[1];if(c=Math.min(c,Math.max(l,h)),c<0)return!1;if(o=Math.max(o,Math.min(l,h)),o>c)return!1;const u=(e[2]-n-t[2])*i[2],d=(e[5]+n-t[2])*i[2];return c=Math.min(c,Math.max(u,d)),!(c<0)&&(o=Math.max(o,Math.min(u,d)),!(o>c)&&o<r)}function E(e,t,i,n,a){let o=(i.screenLength||0)*e.pixelRatio;Object(s["k"])(a)&&(o=Object(h["d"])(o,n,t,a));const c=o*Math.tan(.5*e.fovY)/(.5*e.fullHeight);return Object(r["e"])(c*t,i.minWorldLength||0,null!=i.maxWorldLength?i.maxWorldLength:1/0)}function S(e,t){const i=t?S(t):{};for(const n in e){let t=e[n];t&&t.forEach&&(t=M(t)),null==t&&n in i||(i[n]=t)}return i}function x(e,t){let i=!1;for(const r in t){const s=t[r];void 0!==s&&(Array.isArray(s)?null===e[r]?(e[r]=s.slice(),i=!0):Object(n["l"])(e[r],s)&&(i=!0):e[r]!==s&&(i=!0,e[r]=s))}return i}function R(e,t,i,n,s,a){if(!t.options.selectionMode)return;const o=e.vertexAttributes.get(d["a"].POSITION).data,c=e.vertexAttributes.get(d["a"].SIZE),l=c&&c.data[0],h=n[0],u=n[1],b=((l+s)/2+4)*e.screenToWorldRatio;let f=Number.MAX_VALUE,_=0;for(let d=0;d<o.length-5;d+=3){const e=o[d],t=o[d+1],i=h-e,n=u-t,s=o[d+3]-e,a=o[d+4]-t,c=Object(r["e"])((s*i+a*n)/(s*s+a*a),0,1),l=s*c-i,b=a*c-n,O=l*l+b*b;O<f&&(f=O,_=d/3)}f<b*b&&a(i.dist,i.normal,_,!1)}function M(e){const t=[];return e.forEach(e=>t.push(e)),t}const L={multiply:1,ignore:2,replace:3,tint:4},D=1e3},"7ce4":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("b50f"),r=i("e92d"),s=i("b2b2"),a=i("a21b"),o=i("1956"),c=i("cc15"),l=i("d17d");const h=r["a"].getLogger("esri.views.webgl.BufferObject");function u(e){return Object(n["f"])(e)}class d{constructor(e,t,i,n){this._context=e,this.bufferType=t,this.usage=i,this._glName=null,this._size=-1,this._indexType=void 0,e.instanceCounter.increment(l["t"].BufferObject,this),this._glName=this._context.gl.createBuffer(),Object(o["a"])(this._context.gl),n&&this.setData(n)}static createIndex(e,t,i){return new d(e,l["d"].ELEMENT_ARRAY_BUFFER,t,i)}static createVertex(e,t,i){return new d(e,l["d"].ARRAY_BUFFER,t,i)}static createUniform(e,t,i){if(e.type!==c["a"].WEBGL2)throw new Error("Uniform buffers are supported in WebGL2 only!");return new d(e,l["d"].UNIFORM_BUFFER,t,i)}static createPixelPack(e,t=l["D"].STREAM_READ,i){if(e.type!==c["a"].WEBGL2)throw new Error("Pixel pack buffers are supported in WebGL2 only!");const n=new d(e,l["d"].PIXEL_PACK_BUFFER,t);return i&&n.setSize(i),n}static createPixelUnpack(e,t=l["D"].STREAM_DRAW,i){if(e.type!==c["a"].WEBGL2)throw new Error("Pixel unpack buffers are supported in WebGL2 only!");return new d(e,l["d"].PIXEL_UNPACK_BUFFER,t,i)}get glName(){return this._glName}get size(){return this._size}get indexType(){return this._indexType}get byteSize(){return this.bufferType===l["d"].ELEMENT_ARRAY_BUFFER?this._indexType===l["k"].UNSIGNED_INT?4*this._size:2*this._size:this._size}get _isVAOAware(){return this.bufferType===l["d"].ELEMENT_ARRAY_BUFFER||this.bufferType===l["d"].ARRAY_BUFFER}dispose(){var e;null!=(e=this._context)&&e.gl?(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(l["t"].BufferObject,this),this._context=null):this._glName&&h.warn("Leaked WebGL buffer object")}setSize(e,t=null){if(e<=0&&h.error("Buffer size needs to be positive!"),this.bufferType===l["d"].ELEMENT_ARRAY_BUFFER&&Object(s["k"])(t))switch(this._indexType=t,t){case l["k"].UNSIGNED_SHORT:e*=2;break;case l["k"].UNSIGNED_INT:e*=4}this._setBufferData(e)}setData(e){if(!e)return;let t=e.byteLength;this.bufferType===l["d"].ELEMENT_ARRAY_BUFFER&&(Object(a["i"])(e)&&(t/=2,this._indexType=l["k"].UNSIGNED_SHORT),Object(a["j"])(e)&&(t/=4,this._indexType=l["k"].UNSIGNED_INT)),this._setBufferData(t,e)}_setBufferData(e,t=null){this._size=e;const i=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const n=this._context.gl;Object(s["k"])(t)?n.bufferData(this.bufferType,t,this.usage):n.bufferData(this.bufferType,e,this.usage),Object(o["a"])(n),this._isVAOAware&&this._context.bindVAO(i)}setSubData(e,t=0,i=0,n=e.byteLength){if(!e)return;(t<0||t>=this._size)&&h.error("offset is out of range!");let r=t,s=i,c=n,u=e.byteLength;this.bufferType===l["d"].ELEMENT_ARRAY_BUFFER&&(Object(a["i"])(e)?(u/=2,r*=2,s*=2,c*=2):Object(a["j"])(e)&&(u/=4,r*=4,s*=4,c*=4)),void 0===n&&(n=u-1),i>=n&&h.error("end must be bigger than start!"),t+i-n>this._size&&h.error("An attempt to write beyond the end of the buffer!");const d=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const b=this._context.gl,f=ArrayBuffer.isView(e)?e.buffer:e,_=0===s&&c===e.byteLength?f:f.slice(s,c);b.bufferSubData(this.bufferType,r,_),Object(o["a"])(b),this._isVAOAware&&this._context.bindVAO(d)}setSubDataFromView(e,t,i,n){if(!e)return;(t<0||t>=this._size)&&h.error("offset is out of range!"),i>=n&&h.error("end must be bigger than start!"),t+i-n>this._size&&h.error("An attempt to write beyond the end of the buffer!");const r=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const s=this._context.gl;if(this._context.type===c["a"].WEBGL2)s.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,e,i,n-i);else{const r=0===i&&n===e.length?e:e.subarray(i,n);s.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,r)}Object(o["a"])(s),this._isVAOAware&&this._context.bindVAO(r)}getSubData(e,t=0,i,n){if(this._context.type!==c["a"].WEBGL2)return void h.error("Get buffer subdata is supported in WebGL2 only!");if(i<0||n<0)return void h.error("Problem getting subdata: offset and length were less than zero!");const r=u(e)?e.BYTES_PER_ELEMENT:1;if(r*((null!=i?i:0)+(null!=n?n:0))>e.byteLength)return void h.error("Problem getting subdata: offset and length exceeded destination size!");t+r*(null!=n?n:0)>this.byteSize&&h.warn("Potential problem getting subdata: requested data exceeds buffer size!");const s=this._context.gl;this._context.bindBuffer(this,l["d"].COPY_READ_BUFFER),s.getBufferSubData(l["d"].COPY_READ_BUFFER,t,e,i,n),this._context.unbindBuffer(l["d"].COPY_READ_BUFFER)}async getSubDataAsync(e,t=0,i,n){this._context.type===c["a"].WEBGL2?(await this._context.clientWaitAsync(),this.getSubData(e,t,i,n)):h.error("Get buffer subdata is supported in WebGL2 only!")}}},"7ea8":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("a4ee"),r=i("fc29"),s=i("af40"),a=i("e92d"),o=i("b2b2"),c=i("477c"),l=i("59b2"),h=(i("b50f"),i("c120"),i("cea0"),i("d386"));let u=class extends r["a"]{constructor(e){super(e),this.tool=null,this._baseHandles=new s["a"],this._loggedUnsupportedErrorOnce=!1,this.logger=a["a"].getLogger(this.declaredClass),e&&null!=e.visible&&(this.visible=e.visible)}initialize(){this._baseHandles.add(Object(c["f"])(()=>({ready:Object(o["k"])(this.view)&&this.view.ready,supported:this.supported}),({ready:e,supported:t})=>{!e||t||this._loggedUnsupportedErrorOnce||(this.logError(this.unsupportedErrorMessage),this._loggedUnsupportedErrorOnce=!0)},c["e"]))}destroy(){this.removeTool(),this.view=null,this._baseHandles=Object(o["d"])(this._baseHandles)}get supported(){return Object(o["j"])(this.view)||this.view.type===this.supportedViewType}get view(){return this._get("view")}set view(e){if(e===this.view)return;this.removeTool(),this._set("view",e);const t="tools";this._baseHandles.remove(t),Object(o["j"])(e)||this._baseHandles.add(e.tools.on("after-remove",e=>{e.item===this.tool&&this._set("tool",null)}),t)}set visible(e){this._set("visible",e),Object(o["k"])(this.tool)&&(this.tool.visible=e)}get active(){return Object(o["k"])(this.tool)&&this.tool.active}get disabled(){return Object(o["j"])(this.view)||!this.view.ready||!this.supported}createTool(e={interactive:!1}){if(this.removeTool(),Object(o["j"])(this.view)||!this.view.ready||!this.supported)return;const t=this.constructTool();t.created?(this._set("tool",t),this.view.tools.add(t)):e.interactive?(this._set("tool",t),this.view.addAndActivateTool(t),Object(c["g"])(()=>t.created,()=>{t.active&&Object(o["k"])(this.view)&&(this.view.activeTool=null)},{initial:!0,once:!0})):t.destroy()}removeTool(){const e=this.tool;if(Object(o["j"])(e))return;const t=Object(o["b"])(this.view,e=>e.tools);Object(o["k"])(t)?t.remove(e):e.destroy(),this._set("tool",null)}logError(...e){this.logger.error(...e)}};Object(n["a"])([Object(l["b"])({constructOnly:!0})],u.prototype,"tool",void 0),Object(n["a"])([Object(l["b"])()],u.prototype,"supported",null),Object(n["a"])([Object(l["b"])({value:null})],u.prototype,"view",null),Object(n["a"])([Object(l["b"])({type:Boolean,value:!0})],u.prototype,"visible",null),Object(n["a"])([Object(l["b"])()],u.prototype,"active",null),Object(n["a"])([Object(l["b"])()],u.prototype,"disabled",null),u=Object(n["a"])([Object(h["a"])("esri.widgets.support.InteractiveToolViewModel")],u)},"84f4":function(e,t,i){"use strict";function n(e){return"point"===e.type}i.d(t,"a",(function(){return n}))},8539:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return h})),i.d(t,"c",(function(){return s})),i.d(t,"d",(function(){return u})),i.d(t,"e",(function(){return l})),i.d(t,"f",(function(){return a}));i("c120");var n=i("b2b2"),r=i("d17d");function s(e){const t=e.gl;switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case t.INVALID_VALUE:return"A numeric argument is out of range";case t.INVALID_OPERATION:return"The specified command is not allowed for the current state";case t.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case t.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case t.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function a(e,t){return e.vertexBuffers[t].size/o(e.layout[t])}function o(e){return e[0].stride}function c(e,t,i,n,r=0){const s=e.gl,a=e.capabilities.instancing;e.bindBuffer(i);for(const o of n){const e=t.get(o.name);void 0===e&&console.error(`There is no location for vertex attribute '${o.name}' defined.`);const i=r*o.stride;if(o.count<=4)s.vertexAttribPointer(e,o.count,o.type,o.normalized,o.stride,o.offset+i),s.enableVertexAttribArray(e),o.divisor>0&&a&&a.vertexAttribDivisor(e,o.divisor);else if(9===o.count)for(let t=0;t<3;t++)s.vertexAttribPointer(e+t,3,o.type,o.normalized,o.stride,o.offset+12*t+i),s.enableVertexAttribArray(e+t),o.divisor>0&&a&&a.vertexAttribDivisor(e+t,o.divisor);else if(16===o.count)for(let t=0;t<4;t++)s.vertexAttribPointer(e+t,4,o.type,o.normalized,o.stride,o.offset+16*t+i),s.enableVertexAttribArray(e+t),o.divisor>0&&a&&a.vertexAttribDivisor(e+t,o.divisor);else console.error("Unsupported vertex attribute element count: "+o.count)}}function l(e,t,i,n){const s=e.gl,a=e.capabilities.instancing;e.bindBuffer(i);for(const r of n){const e=t.get(r.name);if(r.count<=4)s.disableVertexAttribArray(e),r.divisor&&r.divisor>0&&a&&a.vertexAttribDivisor(e,0);else if(9===r.count)for(let t=0;t<3;t++)s.disableVertexAttribArray(e+t),r.divisor&&r.divisor>0&&a&&a.vertexAttribDivisor(e+t,0);else if(16===r.count)for(let t=0;t<4;t++)s.disableVertexAttribArray(e+t),r.divisor&&r.divisor>0&&a&&a.vertexAttribDivisor(e+t,0);else console.error("Unsupported vertex attribute element count: "+r.count)}e.unbindBuffer(r["d"].ARRAY_BUFFER)}function h(e){switch(e){case r["p"].ALPHA:case r["p"].LUMINANCE:case r["p"].RED:case r["p"].RED_INTEGER:case r["v"].R8:case r["v"].R8I:case r["v"].R8UI:case r["v"].R8_SNORM:case r["s"].STENCIL_INDEX8:return 1;case r["p"].LUMINANCE_ALPHA:case r["p"].RG:case r["p"].RG_INTEGER:case r["v"].RGBA4:case r["v"].R16F:case r["v"].R16I:case r["v"].R16UI:case r["v"].RG8:case r["v"].RG8I:case r["v"].RG8UI:case r["v"].RG8_SNORM:case r["v"].RGB565:case r["v"].RGB5_A1:case r["s"].DEPTH_COMPONENT16:return 2;case r["p"].DEPTH_COMPONENT:case r["p"].RGB:case r["p"].RGB_INTEGER:case r["v"].RGB8:case r["v"].RGB8I:case r["v"].RGB8UI:case r["v"].RGB8_SNORM:case r["v"].SRGB8:case r["s"].DEPTH_COMPONENT24:return 3;case r["p"].DEPTH_STENCIL:case r["p"].RGBA:case r["p"].RGBA_INTEGER:case r["v"].RGBA8:case r["v"].R32F:case r["v"].R11F_G11F_B10F:case r["v"].RG16F:case r["v"].R32I:case r["v"].R32UI:case r["v"].RG16I:case r["v"].RG16UI:case r["v"].RGBA8I:case r["v"].RGBA8UI:case r["v"].RGBA8_SNORM:case r["v"].SRGB8_ALPHA8:case r["v"].RGB9_E5:case r["v"].RGB10_A2UI:case r["v"].RGB10_A2:case r["s"].DEPTH_STENCIL:case r["s"].DEPTH_COMPONENT32F:case r["s"].DEPTH24_STENCIL8:return 4;case r["s"].DEPTH32F_STENCIL8:return 5;case r["v"].RGB16F:case r["v"].RGB16I:case r["v"].RGB16UI:return 6;case r["v"].RG32F:case r["v"].RG32I:case r["v"].RG32UI:case r["v"].RGBA16F:case r["v"].RGBA16I:case r["v"].RGBA16UI:return 8;case r["v"].RGB32F:case r["v"].RGB32I:case r["v"].RGB32UI:return 12;case r["v"].RGBA32F:case r["v"].RGBA32I:case r["v"].RGBA32UI:return 16;case r["i"].COMPRESSED_RGB_S3TC_DXT1_EXT:case r["i"].COMPRESSED_RGBA_S3TC_DXT1_EXT:return.5;case r["i"].COMPRESSED_RGBA_S3TC_DXT3_EXT:case r["i"].COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case r["i"].COMPRESSED_R11_EAC:case r["i"].COMPRESSED_SIGNED_R11_EAC:case r["i"].COMPRESSED_RGB8_ETC2:case r["i"].COMPRESSED_SRGB8_ETC2:case r["i"].COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case r["i"].COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return.5;case r["i"].COMPRESSED_RG11_EAC:case r["i"].COMPRESSED_SIGNED_RG11_EAC:case r["i"].COMPRESSED_RGBA8_ETC2_EAC:case r["i"].COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}function u(e){if(Object(n["j"])(e))return 0;if("descriptor"in e)return e.glName?u(e.descriptor):0;const t=e.internalFormat||"pixelFormat"in e&&e.pixelFormat;if(!t)return 0;const i="hasMipmap"in e&&e.hasMipmap?1.3:1,r=e.width*e.height;return h(t)*r*i}},"85b3":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("62ae"),r=i("52b2");class s extends n["a"]{constructor(e,t){super(e,"mat4",r["a"].Pass,(i,n,r)=>i.setUniformMatrix4fv(e,t(n,r)))}}},8675:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return c})),i.d(t,"c",(function(){return a})),i.d(t,"d",(function(){return o}));var n=i("fc00"),r=i("b7bd"),s=i("5957");const a=Object(n["a"])().vec3f(r["a"].POSITION),o=Object(n["a"])().vec3f(r["a"].POSITION).vec2f(r["a"].UV0),c=Object(n["a"])().vec3f(r["a"].POSITION).vec4u8(r["a"].COLOR);class l{constructor(e){this.vertexBufferLayout=e}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(r["a"].POSITION).length}write(e,t,i,n){Object(s["c"])(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,i,n)}}},"87b7":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return l})),i.d(t,"d",(function(){return h})),i.d(t,"e",(function(){return u})),i.d(t,"f",(function(){return d})),i.d(t,"g",(function(){return c})),i.d(t,"h",(function(){return o}));var n=i("b7c2"),r=i("d17d");const s={func:r["h"].LESS},a={func:r["h"].ALWAYS},o={mask:255},c={mask:0},l={function:{func:r["h"].ALWAYS,ref:n["h"].OutlineVisualElementMask,mask:n["h"].OutlineVisualElementMask},operation:{fail:r["w"].KEEP,zFail:r["w"].KEEP,zPass:r["w"].ZERO}},h={function:{func:r["h"].ALWAYS,ref:n["h"].OutlineVisualElementMask,mask:n["h"].OutlineVisualElementMask},operation:{fail:r["w"].KEEP,zFail:r["w"].KEEP,zPass:r["w"].REPLACE}},u={function:{func:r["h"].EQUAL,ref:n["h"].OutlineVisualElementMask,mask:n["h"].OutlineVisualElementMask},operation:{fail:r["w"].KEEP,zFail:r["w"].KEEP,zPass:r["w"].KEEP}},d={function:{func:r["h"].NOTEQUAL,ref:n["h"].OutlineVisualElementMask,mask:n["h"].OutlineVisualElementMask},operation:{fail:r["w"].KEEP,zFail:r["w"].KEEP,zPass:r["w"].KEEP}}},"89bf":function(e,t,i){"use strict";i.d(t,"a",(function(){return f})),i.d(t,"b",(function(){return w})),i.d(t,"c",(function(){return T}));var n=i("b2b2"),r=i("1c92"),s=i("dae5"),a=i("d791"),o=i("afe1"),c=i("04f0"),l=i("b139"),h=i("e431"),u=i("47f8"),d=i("0b2d"),b=i("f895");class f{constructor(){this._transform=Object(o["d"])(),this._transformInverse=new _({value:this._transform},a["a"],o["d"]),this._transformInverseTranspose=new _(this._transformInverse,a["t"],o["d"]),this._transformTranspose=new _({value:this._transform},a["t"],o["d"]),this._transformInverseRotation=new _({value:this._transform},r["k"],s["b"])}_invalidateLazyTransforms(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}get transform(){return this._transform}get inverse(){return this._transformInverse.value}get inverseTranspose(){return this._transformInverseTranspose.value}get inverseRotation(){return this._transformInverseRotation.value}get transpose(){return this._transformTranspose.value}setTransformMatrix(e){Object(a["c"])(this._transform,e)}multiplyTransform(e){Object(a["m"])(this._transform,this._transform,e)}set(e){Object(a["c"])(this._transform,e),this._invalidateLazyTransforms()}setAndInvalidateLazyTransforms(e,t){this.setTransformMatrix(e),this.multiplyTransform(t),this._invalidateLazyTransforms()}}class _{constructor(e,t,i){this.original=e,this.update=t,this.dirty=!0,this.transform=i()}invalidate(){this.dirty=!0}get value(){return this.dirty&&(this.update(this.transform,this.original.value),this.dirty=!1),this.transform}}class O{constructor(e=0){this.offset=e,this.tmpVertex=Object(d["f"])()}applyToVertex(e,t,i){const n=e+this.localOrigin[0],r=t+this.localOrigin[1],s=i+this.localOrigin[2],a=this.offset/Math.sqrt(n*n+r*r+s*s);return this.tmpVertex[0]=e+n*a,this.tmpVertex[1]=t+r*a,this.tmpVertex[2]=i+s*a,this.tmpVertex}applyToAabb(e){for(let r=0;r<3;++r)p[r]=e[0+r]+this.localOrigin[r],g[r]=e[3+r]+this.localOrigin[r],j[r]=p[r];const t=this.applyToVertex(p[0],p[1],p[2]);for(let r=0;r<3;++r)e[r]=t[r],e[r+3]=t[r];const i=t=>{const i=this.applyToVertex(t[0],t[1],t[2]);for(let n=0;n<3;++n)e[n+0]=Math.min(e[n+0],i[n]),e[n+3]=Math.max(e[n+3],i[n])};for(let r=1;r<8;++r){for(let e=0;e<3;++e)j[e]=0==(r&1<<e)?p[e]:g[e];i(j)}let n=0;for(let r=0;r<3;++r)p[r]*g[r]<0&&(n|=1<<r);if(0!==n&&7!==n)for(let r=0;r<8;++r)if(0==(n&r)){for(let e=0;e<3;++e)n[e]?j[e]=0:j[e]=0!=(r&1<<e)?p[e]:g[e];i(j)}for(let r=0;r<3;++r)e[r+0]-=this.localOrigin[r],e[r+3]-=this.localOrigin[r];return e}}const p=Object(d["f"])(),g=Object(d["f"])(),j=Object(d["f"])();class m{constructor(e=0){this.componentLocalOriginLength=0,this._tmpVertex=Object(d["f"])(),this._mbs=Object(b["c"])(),this._obb={center:Object(d["f"])(),halfSize:Object(u["b"])(),quaternion:null},this._totalOffset=0,this._offset=0,this._resetOffset(e)}_resetOffset(e){this._offset=e,this._totalOffset=e}set offset(e){this._resetOffset(e)}get offset(){return this._offset}set componentOffset(e){this._totalOffset=this._offset+e}set localOrigin(e){this.componentLocalOriginLength=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}applyToVertex(e,t,i){const n=e,r=t,s=i+this.componentLocalOriginLength,a=this._totalOffset/Math.sqrt(n*n+r*r+s*s);return this._tmpVertex[0]=e+n*a,this._tmpVertex[1]=t+r*a,this._tmpVertex[2]=i+s*a,this._tmpVertex}applyToAabb(e){const t=e[0],i=e[1],n=e[2]+this.componentLocalOriginLength,r=e[3],s=e[4],a=e[5]+this.componentLocalOriginLength,o=t*r<0?0:Math.min(Math.abs(t),Math.abs(r)),c=i*s<0?0:Math.min(Math.abs(i),Math.abs(s)),l=n*a<0?0:Math.min(Math.abs(n),Math.abs(a)),h=Math.sqrt(o*o+c*c+l*l);if(h<this._totalOffset)return e[0]-=t<0?this._totalOffset:0,e[1]-=i<0?this._totalOffset:0,e[2]-=n<0?this._totalOffset:0,e[3]+=r>0?this._totalOffset:0,e[4]+=s>0?this._totalOffset:0,e[5]+=a>0?this._totalOffset:0,e;const u=Math.max(Math.abs(t),Math.abs(r)),d=Math.max(Math.abs(i),Math.abs(s)),b=Math.max(Math.abs(n),Math.abs(a)),f=Math.sqrt(u*u+d*d+b*b),_=this._totalOffset/f,O=this._totalOffset/h;return e[0]+=t*(t>0?_:O),e[1]+=i*(i>0?_:O),e[2]+=n*(n>0?_:O),e[3]+=r*(r<0?_:O),e[4]+=s*(s<0?_:O),e[5]+=a*(a<0?_:O),e}applyToMbs(e){const t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),i=this._totalOffset/t;return this._mbs[0]=e[0]+e[0]*i,this._mbs[1]=e[1]+e[1]*i,this._mbs[2]=e[2]+e[2]*i,this._mbs[3]=e[3]+e[3]*this._totalOffset/t,this._mbs}applyToObb(e){const t=e.center,i=this._totalOffset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);this._obb.center[0]=t[0]+t[0]*i,this._obb.center[1]=t[1]+t[1]*i,this._obb.center[2]=t[2]+t[2]*i,Object(h["u"])(this._obb.halfSize,e.halfSize,e.quaternion),Object(h["e"])(this._obb.halfSize,this._obb.halfSize,e.center);const n=this._totalOffset/Math.sqrt(this._obb.halfSize[0]*this._obb.halfSize[0]+this._obb.halfSize[1]*this._obb.halfSize[1]+this._obb.halfSize[2]*this._obb.halfSize[2]);return this._obb.halfSize[0]+=this._obb.halfSize[0]*n,this._obb.halfSize[1]+=this._obb.halfSize[1]*n,this._obb.halfSize[2]+=this._obb.halfSize[2]*n,Object(h["f"])(this._obb.halfSize,this._obb.halfSize,e.center),Object(c["a"])(A,e.quaternion),Object(h["u"])(this._obb.halfSize,this._obb.halfSize,A),this._obb.halfSize[0]*=this._obb.halfSize[0]<0?-1:1,this._obb.halfSize[1]*=this._obb.halfSize[1]<0?-1:1,this._obb.halfSize[2]*=this._obb.halfSize[2]<0?-1:1,this._obb.quaternion=e.quaternion,this._obb}}class v{constructor(e=0){this.offset=e,this.sphere=Object(b["c"])(),this.tmpVertex=Object(d["f"])()}applyToVertex(e,t,i){const n=this.objectTransform.transform;let r=n[0]*e+n[4]*t+n[8]*i+n[12],s=n[1]*e+n[5]*t+n[9]*i+n[13],a=n[2]*e+n[6]*t+n[10]*i+n[14];const o=this.offset/Math.sqrt(r*r+s*s+a*a);r+=r*o,s+=s*o,a+=a*o;const c=this.objectTransform.inverse;return this.tmpVertex[0]=c[0]*r+c[4]*s+c[8]*a+c[12],this.tmpVertex[1]=c[1]*r+c[5]*s+c[9]*a+c[13],this.tmpVertex[2]=c[2]*r+c[6]*s+c[10]*a+c[14],this.tmpVertex}applyToMinMax(e,t){const i=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*i,e[1]+=e[1]*i,e[2]+=e[2]*i;const n=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*n,t[1]+=t[1]*n,t[2]+=t[2]*n}applyToAabb(e){const t=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*t,e[1]+=e[1]*t,e[2]+=e[2]*t;const i=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*i,e[4]+=e[4]*i,e[5]+=e[5]*i,e}applyToBoundingSphere(e){const t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),i=this.offset/t;return this.sphere[0]=e[0]+e[0]*i,this.sphere[1]=e[1]+e[1]*i,this.sphere[2]=e[2]+e[2]*i,this.sphere[3]=e[3]+e[3]*this.offset/t,this.sphere}}const y=new v;function T(e){return Object(n["k"])(e)?(y.offset=e,y):null}new m;new O;const w="terrain",A=Object(l["b"])()},"8a80":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("62ae");class r extends n["a"]{constructor(e){super(e,"float")}}},"8e97":function(e,t,i){"use strict";i.d(t,"a",(function(){return b})),i.d(t,"b",(function(){return f}));var n=i("d791"),r=i("970c"),s=i("e431"),a=i("0b2d"),o=i("35f0"),c=i("ea32"),l=i("62ae"),h=i("52b2");class u extends l["a"]{constructor(e,t){super(e,"mat4",h["a"].Draw,(i,n,r)=>i.setUniformMatrix4fv(e,t(n,r)))}}var d=i("85b3");function b(e,t){t.instancedDoublePrecision?e.constants.add("cameraPosition","vec3",a["c"]):e.uniforms.add(new o["a"]("cameraPosition",(e,t)=>Object(s["w"])(O,t.camera.viewInverseTransposeMatrix[3]-e.origin[0],t.camera.viewInverseTransposeMatrix[7]-e.origin[1],t.camera.viewInverseTransposeMatrix[11]-e.origin[2])))}function f(e,t){if(e.vertex.uniforms.add(new d["a"]("proj",(e,t)=>t.camera.projectionMatrix)),t.instancedDoublePrecision){const t=(e,t)=>Object(s["w"])(O,t.camera.viewInverseTransposeMatrix[3],t.camera.viewInverseTransposeMatrix[7],t.camera.viewInverseTransposeMatrix[11]);e.vertex.uniforms.add(new d["a"]("view",(e,i)=>Object(n["j"])(_,i.camera.viewMatrix,t(e,i))));const i=new c["a"]("localOrigin",t);return e.vertex.uniforms.add(i),i}e.vertex.uniforms.add(new u("view",(e,t)=>Object(n["j"])(_,t.camera.viewMatrix,e.origin)));const i=new o["a"]("localOrigin",e=>e.origin);return e.vertex.uniforms.add(i),i}const _=Object(r["a"])(),O=Object(a["f"])()},9250:function(e,t,i){"use strict";i.d(t,"a",(function(){return g})),i.d(t,"b",(function(){return y}));var n=i("b2b2"),r=i("d791"),s=i("afe1"),a=i("e431"),o=i("0b2d"),c=i("7577"),l=i("0fc4"),h=i("d18f"),u=i("3c9c"),d=i("1942");i("0d9f");function b(e){return Object(n["k"])(e)&&Object(n["k"])(e.dist)}Object(o["f"])();var f=i("89bf"),_=i("b623");const O=1e-5;class p{constructor(e){this.options=new d["a"],this._results=new j,this.transform=new f["a"],this.tolerance=O,this.verticalOffset=null,this._ray=Object(h["c"])(),this._rayEnd=Object(o["f"])(),this._rayBeginTransformed=Object(o["f"])(),this._rayEndTransformed=Object(o["f"])(),this.viewingMode=null==e?u["a"].Global:e}get results(){return this._results}get ray(){return this._ray}get rayBegin(){return this._ray.origin}get rayEnd(){return this._rayEnd}reset(e,t,i){this.resetWithRay(Object(h["e"])(e,t,this._ray),i)}resetWithRay(e,t){this.camera=t,e!==this._ray&&Object(h["b"])(e,this._ray),0!==this.options.verticalOffset?this.viewingMode===u["a"].Local?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,Object(a["e"])(this._rayEnd,this._ray.origin,this._ray.direction),this._results.init(this._ray)}intersect(e=null,t,i,r,s){this.point=t,this.filterPredicate=r,this.tolerance=null==i?O:i;const a=Object(f["c"])(this.verticalOffset);if(Object(n["k"])(e)&&e.length>0){const t=s?e=>{s(e)&&this.intersectObject(e)}:e=>{this.intersectObject(e)};for(const i of e){const e=i.getSpatialQueryAccelerator&&i.getSpatialQueryAccelerator();Object(n["k"])(e)?(Object(n["k"])(a)?e.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,t,a):e.forEachAlongRay(this._ray.origin,this._ray.direction,t),this.options.selectionMode&&this.options.hud&&e.forEachDegenerateObject(t)):i.objects.forAll(e=>t(e))}}this.sortResults()}intersectObject(e){const t=e.geometryRecords;if(!t)return;const i=e.transformation,r=Object(f["c"])(this.verticalOffset);for(const o of t){const{geometry:t,material:c,instanceParameters:l}=o;if(Object(_["d"])(l))continue;const h=t.id;this.transform.setAndInvalidateLazyTransforms(i,o.getShaderTransformation()),Object(a["q"])(this._rayBeginTransformed,this.rayBegin,this.transform.inverse),Object(a["q"])(this._rayEndTransformed,this.rayEnd,this.transform.inverse);const u=this.transform.transform;Object(n["k"])(r)&&(r.objectTransform=this.transform),c.intersect(t,l,this.transform.transform,this,this._rayBeginTransformed,this._rayEndTransformed,(t,i,r,a,o,c)=>{if(t>=0){if(Object(n["k"])(this.filterPredicate)&&!this.filterPredicate(this._ray.origin,this._rayEnd,t))return;const l=a?this._results.hud:this._results,b=a?a=>{const l={object:e,geometryId:h,triangleNr:r,center:Object(n["k"])(c)?[c[0],c[1],c[2]]:null};a.set(d["b"].HUD,l,t,i,s["a"],o)}:n=>n.set(d["b"].OBJECT,{object:e,geometryId:h,triangleNr:r},t,i,u,o);if((null==l.min.drapedLayerOrder||o>=l.min.drapedLayerOrder)&&(null==l.min.dist||t<l.min.dist)&&b(l.min),this.options.store!==d["c"].MIN&&(null==l.max.drapedLayerOrder||o<l.max.drapedLayerOrder)&&(null==l.max.dist||t>l.max.dist)&&b(l.max),this.options.store===d["c"].ALL)if(a){const e=new v(this._ray);b(e),this._results.hud.all.push(e)}else{const e=new m(this._ray);b(e),this._results.all.push(e)}}},o.shaderTransformation)}}sortResults(e=this._results.all){e.sort((e,t)=>e.dist!==t.dist?Object(n["s"])(e.dist,0)-Object(n["s"])(t.dist,0):e.drapedLayerOrder!==t.drapedLayerOrder?Object(n["s"])(e.drapedLayerOrder,Number.MAX_VALUE)-Object(n["s"])(t.drapedLayerOrder,Number.MAX_VALUE):Object(n["s"])(t.drapedLayerGraphicOrder,Number.MIN_VALUE)-Object(n["s"])(e.drapedLayerGraphicOrder,Number.MIN_VALUE))}}function g(e){return new p(e)}class j{constructor(){this.min=new m(Object(h["c"])()),this.max=new m(Object(h["c"])()),this.hud={min:new v(Object(h["c"])()),max:new v(Object(h["c"])()),all:new Array},this.ground=new m(Object(h["c"])()),this.all=[]}init(e){this.min.init(e),this.max.init(e),this.ground.init(e),this.all.length=0,this.hud.min.init(e),this.hud.max.init(e),this.hud.all.length=0}}class m{constructor(e){this.intersector=d["b"].OBJECT,this.normal=Object(o["f"])(),this.transformation=Object(s["d"])(),this._ray=Object(h["c"])(),this.init(e)}get ray(){return this._ray}get distanceInRenderSpace(){return Object(n["k"])(this.dist)?(Object(a["k"])(T,this.ray.direction,this.dist),Object(a["p"])(T)):null}getIntersectionPoint(e){return!!b(this)&&(Object(a["k"])(T,this.ray.direction,this.dist),Object(a["e"])(e,this.ray.origin,T),!0)}getTransformedNormal(e){return Object(a["g"])(w,this.normal),w[3]=0,Object(c["m"])(w,w,this.transformation),Object(a["g"])(e,w),Object(a["r"])(e,e)}init(e){this.dist=null,this.target=null,this.drapedLayerOrder=null,this.drapedLayerGraphicOrder=null,this.intersector=d["b"].OBJECT,Object(h["b"])(e,this._ray)}set(e,t,i,c,l,h,u){this.intersector=e,this.dist=i,Object(a["g"])(this.normal,Object(n["s"])(c,o["b"])),Object(r["c"])(this.transformation,Object(n["s"])(l,s["a"])),this.target=t,this.drapedLayerOrder=h,this.drapedLayerGraphicOrder=u}copy(e){Object(h["b"])(e.ray,this._ray),this.intersector=e.intersector,this.dist=e.dist,this.target=e.target,this.drapedLayerOrder=e.drapedLayerOrder,this.drapedLayerGraphicOrder=e.drapedLayerGraphicOrder,Object(a["g"])(this.normal,e.normal),Object(r["c"])(this.transformation,e.transformation)}}class v extends m{constructor(){super(...arguments),this.intersector=d["b"].HUD}}function y(e){return new m(e)}const T=Object(o["f"])(),w=Object(l["e"])()},9360:function(e,t,i){"use strict";i.d(t,"a",(function(){return L}));var n=i("e431"),r=i("0b2d"),s=i("0fc4"),a=i("4261"),o=i("8190"),c=i("fc00"),l=i("a05b"),h=i("b7c2"),u=i("d7f7"),d=i("b061"),b=i("35b3"),f=i("badc"),_=i("1153"),O=i("b7bd"),p=i("5957"),g=i("7c51"),j=i("a4ee"),m=i("c3a4"),v=i("ca98"),y=i("da35"),T=i("7438"),w=i("c829"),A=i("6d35"),P=i("692f"),E=i("d17d"),S=i("189c");class x extends v["a"]{initializeProgram(e){const t=x.shader.get().build(this.configuration);return new w["a"](e.rctx,t,M)}_setPipelineState(e){const t=this.configuration,i=e===h["i"].NONE,n=e===h["i"].FrontFace;return Object(S["f"])({blending:t.output!==l["a"].Color&&t.output!==l["a"].Alpha||!t.transparent?null:i?T["d"]:Object(T["f"])(e),culling:Object(S["b"])(t.cullFace),depthTest:{func:n?E["h"].LESS:t.shadingEnabled?E["h"].LEQUAL:E["h"].LESS},depthWrite:i?t.writeDepth&&S["d"]:Object(T["h"])(e),colorWrite:S["c"],polygonOffset:i||n?null:T["a"]})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}}x.shader=new m["a"](P["a"],()=>i.e("chunk-2d2219c9").then(i.bind(null,"caa6")));class R extends A["a"]{constructor(){super(...arguments),this.output=l["a"].Color,this.cullFace=h["b"].None,this.transparencyPassType=h["i"].NONE,this.hasSlicePlane=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}Object(j["a"])([Object(y["b"])({count:l["a"].COUNT})],R.prototype,"output",void 0),Object(j["a"])([Object(y["b"])({count:h["b"].COUNT})],R.prototype,"cullFace",void 0),Object(j["a"])([Object(y["b"])({count:h["i"].COUNT})],R.prototype,"transparencyPassType",void 0),Object(j["a"])([Object(y["b"])()],R.prototype,"hasSlicePlane",void 0),Object(j["a"])([Object(y["b"])()],R.prototype,"transparent",void 0),Object(j["a"])([Object(y["b"])()],R.prototype,"writeDepth",void 0),Object(j["a"])([Object(y["b"])()],R.prototype,"screenSizeEnabled",void 0),Object(j["a"])([Object(y["b"])()],R.prototype,"shadingEnabled",void 0),Object(j["a"])([Object(y["b"])()],R.prototype,"hasMultipassTerrain",void 0),Object(j["a"])([Object(y["b"])()],R.prototype,"cullAboveGround",void 0);const M=new Map([[O["a"].POSITION,0],[O["a"].NORMAL,1],[O["a"].OFFSET,2]]);class L extends b["a"]{constructor(e){super(e,new I),this.supportsEdges=!0,this.techniqueConfig=new R,this._vertexAttributeLocations=M}getConfiguration(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.parameters.cullFace,this.techniqueConfig.hasSlicePlane=this.parameters.hasSlicePlane,this.techniqueConfig.transparent=this.parameters.transparent,this.techniqueConfig.writeDepth=this.parameters.writeDepth,this.techniqueConfig.screenSizeEnabled=this.parameters.screenSizeEnabled,this.techniqueConfig.shadingEnabled=this.parameters.shadingEnabled,this.techniqueConfig.transparencyPassType=t.transparencyPassType,this.techniqueConfig.hasMultipassTerrain=t.multipassTerrain.enabled,this.techniqueConfig.cullAboveGround=t.multipassTerrain.cullAboveGround,this.techniqueConfig}intersect(e,t,i,r,s,o,c){if(this.parameters.screenSizeEnabled){const i=e.vertexAttributes.get(O["a"].OFFSET),l={applyToVertex:(e,t,s,a)=>{const o=Object(n["w"])(V,i.data[3*a+0],i.data[3*a+1],i.data[3*a+2]),c=Object(n["w"])(C,e,t,s);return Object(n["k"])(o,o,this.parameters.screenSizeScale*r.camera.computeRenderPixelSizeAt(o)),Object(n["e"])(c,c,o),[c[0],c[1],c[2]]},applyToAabb:e=>{const t=Object(a["d"])(e,V);return Object(a["v"])(e,this.parameters.screenSizeScale*r.camera.computeRenderPixelSizeAt(t))}};Object(g["e"])(e,t,r,s,o,l,c)}else Object(g["e"])(e,t,r,s,o,void 0,c)}requiresSlot(e,t){if(Object(d["b"])(t)===l["a"].Highlight)return e===f["a"].OPAQUE_MATERIAL;let i=f["a"].OPAQUE_MATERIAL;return this.parameters.transparent&&(i=this.parameters.writeDepth?f["a"].TRANSPARENT_MATERIAL:f["a"].TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),e===i||e===f["a"].DRAPED_MATERIAL}createGLMaterial(e){return e.output===l["a"].Color||e.output===l["a"].Alpha||e.output===l["a"].Highlight?new D(e):null}createBufferWriter(){return new N(this.parameters.screenSizeEnabled)}}class D extends u["a"]{beginSlot(e){return this.ensureTechnique(x,e)}}class I extends b["b"]{constructor(){super(...arguments),this.color=Object(s["g"])(1,1,1,1),this.shadingTint=Object(s["g"])(0,0,0,.25),this.shadingDirection=Object(n["r"])(Object(r["f"])(),[.5,-.5,-.5]),this.screenSizeScale=14,this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=h["b"].None,this.screenSizeEnabled=!1,this.shadingEnabled=!0}}class N{constructor(e){this.screenSizeEnabled=e;const t=Object(c["a"])().vec3f(O["a"].POSITION).vec3f(O["a"].NORMAL);this.screenSizeEnabled&&t.vec3f(O["a"].OFFSET),this.vertexBufferLayout=t}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(O["a"].POSITION).length}write(e,t,i,n){if(Object(p["c"])(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,i,n),this.screenSizeEnabled){if(!t.vertexAttributes.has(O["a"].OFFSET))throw new Error(O["a"].OFFSET+" vertex attribute required for screenSizeEnabled ShadedColorMaterial");{const r=t.vertexAttributes.get(O["a"].OFFSET),s=t.indices.get(O["a"].OFFSET);Object(_["a"])(3===r.size);const a=i.getField(O["a"].OFFSET,o["u"]);if(!a)throw new Error("unable to acquire view for "+O["a"].OFFSET);Object(p["e"])(s,r.data,e.invTranspTransformation,a,n)}}}}const V=Object(r["f"])(),C=Object(r["f"])()},9990:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return c}));var n=i("b2b2"),r=i("a915"),s=i("3349"),a=i("e431"),o=i("7361");function c(e,t,i){return l(e,e.screenToRender(t,Object(r["b"])(o["d"].get())),i)}function l(e,t,i){const c=Object(r["b"])(Object(s["c"])(o["d"].get(),t));if(c[2]=0,!e.unprojectFromRenderScreen(c,i.origin))return null;const l=Object(r["b"])(Object(s["c"])(o["d"].get(),t));l[2]=1;const h=e.unprojectFromRenderScreen(l,o["d"].get());return Object(n["j"])(h)?null:(Object(a["f"])(i.direction,h,i.origin),i)}},"9cc4":function(e,t,i){"use strict";function n(e,t,i){for(let n=0;n<i;++n)t[2*n]=e[n],t[2*n+1]=e[n]-t[2*n]}function r(e,t){const i=e.length;for(let n=0;n<i;++n)a[0]=e[n],t[n]=a[0];return t}function s(e,t){const i=e.length;for(let n=0;n<i;++n)a[0]=e[n],a[1]=e[n]-a[0],t[n]=a[1];return t}i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return s}));const a=new Float32Array(2)},"9e77":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("b2b2"),r=i("d047"),s=i("58c2"),a=i("d8a4"),o=i("ea32"),c=i("1fe9"),l=i("3886"),h=i("6a3c"),u=i("5d7f");function d(e,t){e.extensions.add("GL_OES_standard_derivatives");const i=e.fragment;i.include(r["a"]),e.include(s["a"]),i.uniforms.add([new c["a"]("globalAlpha",e=>e.globalAlpha),new o["a"]("glowColor",e=>e.glowColor),new c["a"]("glowWidth",(e,t)=>e.glowWidth*t.camera.pixelRatio),new c["a"]("glowFalloff",e=>e.glowFalloff),new o["a"]("innerColor",e=>e.innerColor),new c["a"]("innerWidth",(e,t)=>e.innerWidth*t.camera.pixelRatio),new h["a"]("depthMap",(e,t)=>t.linearDepthTexture),new a["a"]("nearFar",(e,t)=>t.camera.nearFar),new u["a"]("frameColor")]),i.code.add(l["b"]`vec4 blendPremultiplied(vec4 source, vec4 dest) {
float oneMinusSourceAlpha = 1.0 - source.a;
return vec4(
source.rgb + dest.rgb * oneMinusSourceAlpha,
source.a + dest.a * oneMinusSourceAlpha
);
}`),i.code.add(l["b"]`vec4 premultipliedColor(vec3 rgb, float alpha) {
return vec4(rgb * alpha, alpha);
}`),i.code.add(l["b"]`vec4 laserlineProfile(float dist) {
if (dist > glowWidth) {
return vec4(0.0);
}
float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));
float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);
return blendPremultiplied(
premultipliedColor(innerColor, innerAlpha),
premultipliedColor(glowColor, glowAlpha)
);
}`),i.code.add(l["b"]`bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float depthDiscontinuityAlpha) {
float depth = linearDepthFromTexture(depthMap, uv, nearFar);
if (-depth == nearFar[0]) {
return false;
}
pos = reconstructPosition(gl_FragCoord.xy, depth);
normal = normalize(cross(dFdx(pos), dFdy(pos)));
float ddepth = fwidth(depth);
depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / depth);
return true;
}`),t.contrastControlEnabled?(i.uniforms.add(new c["a"]("globalAlphaContrastBoost",e=>Object(n["k"])(e.globalAlphaContrastBoost)?e.globalAlphaContrastBoost:1)),i.code.add(l["b"]`float rgbToLuminance(vec3 color) {
return dot(vec3(0.2126, 0.7152, 0.0722), color);
}
vec4 laserlineOutput(vec4 color) {
float backgroundLuminance = rgbToLuminance(texture2D(frameColor, uv).rgb);
float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);
return color * alpha;
}`)):i.code.add(l["b"]`vec4 laserlineOutput(vec4 color) {
return color * globalAlpha;
}`)}},a05b:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Color=0]="Color",e[e.Depth=1]="Depth",e[e.Normal=2]="Normal",e[e.Shadow=3]="Shadow",e[e.Highlight=4]="Highlight",e[e.Draped=5]="Draped",e[e.Occlusion=6]="Occlusion",e[e.Alpha=7]="Alpha",e[e.COUNT=8]="COUNT"}(n||(n={}))},a13f:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));i("e431");var n=i("0b2d"),r=(i("ea51"),i("1219")),s=(i("8188"),i("5996"));i("40b6"),i("680b");function a(e){return"mouse"!==e.pointerType||0===e.button}const o=Object(n["f"])(),c=Object(n["f"])(),l=Object(n["f"])();new r["a"]({rings:[[o,c,l]],spatialReference:s["a"].WGS84}),Object(n["f"])()},a997:function(e,t,i){"use strict";i.d(t,"a",(function(){return m})),i.d(t,"b",(function(){return p})),i.d(t,"c",(function(){return O}));var n=i("38a4"),r=i("b2b2"),s=i("3349"),a=i("02f1"),o=i("9e77"),c=i("2aad"),l=i("d8a4"),h=i("666b"),u=i("db7b"),d=i("1fe9"),b=i("8a80"),f=i("3886"),_=i("690a");const O=Object(n["g"])(6);function p(e){const t=new _["a"];t.extensions.add("GL_OES_standard_derivatives"),t.include(c["a"]),t.include(o["a"],e);const i=t.fragment;return e.heightManifoldEnabled&&i.uniforms.add(new u["a"]("heightPlane")),e.pointDistanceEnabled&&i.uniforms.add(new u["a"]("pointDistanceSphere")),e.lineVerticalPlaneEnabled&&(i.uniforms.add(new u["a"]("lineVerticalPlane")),i.uniforms.add(new h["a"]("lineVerticalStart")),i.uniforms.add(new h["a"]("lineVerticalEnd"))),(e.heightManifoldEnabled||e.pointDistanceEnabled||e.lineVerticalPlaneEnabled)&&i.uniforms.add(new b["a"]("maxPixelDistance")),(e.lineVerticalPlaneEnabled||e.heightManifoldEnabled)&&i.code.add(f["b"]`float planeDistancePixels(vec4 plane, vec3 pos) {
float dist = dot(plane.xyz, pos) + plane.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`),e.pointDistanceEnabled&&i.code.add(f["b"]`float sphereDistancePixels(vec4 sphere, vec3 pos) {
float dist = distance(sphere.xyz, pos) - sphere.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`),e.intersectsLineEnabled&&(i.uniforms.add(new h["a"]("intersectsLineStart")),i.uniforms.add(new h["a"]("intersectsLineEnd")),i.uniforms.add(new h["a"]("intersectsLineDirection")),i.uniforms.add(new b["a"]("intersectsLineRadius")),i.uniforms.add(new d["a"]("perScreenPixelRatio",(e,t)=>t.camera.perScreenPixelRatio)),i.code.add(f["b"]`float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {
float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);
return abs(dist) - radius;
}`)),(e.lineVerticalPlaneEnabled||e.intersectsLineEnabled)&&i.code.add(f["b"]`bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {
vec3 dir = end - start;
float t2 = dot(dir, pos - start);
float l2 = dot(dir, dir);
return t2 >= 0.0 && t2 <= l2;
}`),i.code.add(f["b"]`void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
vec4 color = vec4(0, 0, 0, 0);`),e.heightManifoldEnabled&&(i.uniforms.add(new l["a"]("angleCutoff",e=>g(e))),i.code.add(f["b"]`{
float heightManifoldAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, heightPlane.xyz)));
vec4 heightManifoldColor = laserlineProfile(planeDistancePixels(heightPlane, pos));
color = max(color, heightManifoldColor * heightManifoldAlpha);
}`)),e.pointDistanceEnabled&&(i.uniforms.add(new l["a"]("angleCutoff",e=>g(e))),i.code.add(f["b"]`{
float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);
vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);
float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));
color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);
}`)),e.lineVerticalPlaneEnabled&&(i.uniforms.add(new l["a"]("angleCutoff",e=>g(e))),i.code.add(f["b"]`{
if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {
float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);
vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);
float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));
color = max(color, lineVerticalColor * lineVerticalAlpha);
}
}`)),e.intersectsLineEnabled&&(i.uniforms.add(new l["a"]("angleCutoff",e=>g(e))),i.code.add(f["b"]`{
if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {
float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);
vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);
float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));
color = max(color, intersectsLineColor * intersectsLineAlpha);
}
}`)),i.code.add(f["b"]`gl_FragColor = laserlineOutput(color * depthDiscontinuityAlpha);
}`),t}function g(e){const t=Object(r["k"])(e.angleCutoff)?e.angleCutoff:O;return Object(s["a"])(j,Math.cos(t),Math.cos(Math.max(0,t-Object(n["g"])(2))))}const j=Object(a["c"])(),m=Object.freeze(Object.defineProperty({__proto__:null,defaultAngleCutoff:O,build:p},Symbol.toStringTag,{value:"Module"}))},ad29:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("a4ee"),r=i("477c"),s=i("59b2"),a=(i("b50f"),i("c120"),i("cea0"),i("d386")),o=i("4772");let c=class extends o["a"]{constructor(e){super(e)}initialize(){this.own(Object(r["f"])(()=>this.analysisViewData.visible,e=>this.visible=e,r["e"]))}deactivate(){this.onDeactivate(),this.created||this.analysis.clear()}resetCreated(){this._set("created",!1)}};Object(n["a"])([Object(s["b"])({constructOnly:!0})],c.prototype,"analysis",void 0),Object(n["a"])([Object(s["b"])()],c.prototype,"analysisViewData",void 0),c=Object(n["a"])([Object(a["a"])("esri.views.interactive.AnalysisToolBase")],c)},b061:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return c}));var n=i("b2b2"),r=i("a05b"),s=i("b7c2"),a=i("614d");class o{constructor(e,t){this._material=e,this._repository=t,this._map=new Map}destroy(){this._map.forEach((e,t)=>{Object(n["k"])(e)&&this._repository.release(this._material,c(t))})}load(e,t){this._map.has(t)||this._map.set(t,this._repository.acquire(this._material,c(t)));const i=this._map.get(t);if(Object(n["k"])(i)){if(i.ensureResources(e)===s["g"].LOADED)return i;this._repository.requestRender()}return null}}function c(e){switch(e){case a["a"].MATERIAL:return r["a"].Color;case a["a"].MATERIAL_ALPHA:return r["a"].Alpha;case a["a"].MATERIAL_DEPTH:return r["a"].Depth;case a["a"].MATERIAL_NORMAL:return r["a"].Normal;case a["a"].MATERIAL_DEPTH_SHADOWMAP_ALL:return r["a"].Shadow;case a["a"].MATERIAL_HIGHLIGHT:return r["a"].Highlight;case a["a"].MATERIAL_DEPTH_SHADOWMAP_HIGHLIGHT:case a["a"].MATERIAL_DEPTH_SHADOWMAP_DEFAULT:return r["a"].Shadow}}},b4a5:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return x})),i.d(t,"c",(function(){return R})),i.d(t,"d",(function(){return M})),i.d(t,"e",(function(){return T})),i.d(t,"f",(function(){return A})),i.d(t,"g",(function(){return w})),i.d(t,"h",(function(){return j})),i.d(t,"i",(function(){return m})),i.d(t,"j",(function(){return E}));var n,r=i("b2b2"),s=i("a915"),a=i("e431"),o=i("0b2d"),c=i("8188"),l=i("7289"),h=i("d18f"),u=i("a1b1"),d=i("7361"),b=i("f408"),f=i("9990"),_=i("9250"),O=i("1942"),p=i("89bf"),g=i("c20d");function j(e,t){return v(e,()=>t)}function m(e){return v(e,e=>e.plane)}function v(e,t){const i=Object(o["f"])(),n=Object(o["f"])();let a=!1;return o=>{const c=t(o);if("start"===o.action){const t=Object(s["i"])(o.screenStart,Object(s["c"])(d["c"].get())),n=Object(f["b"])(e.state.camera,t,I);Object(r["k"])(n)&&(a=Object(l["m"])(c,n,i))}if(!a)return null;const h=Object(s["i"])(o.screenEnd,Object(s["c"])(d["c"].get())),u=Object(f["b"])(e.state.camera,h,I);return Object(r["j"])(u)?null:Object(l["m"])(c,u,n)?{...o,renderStart:i,renderEnd:n,plane:c,ray:u}:null}}function y(e,t,i,n=null,a=null){let o=null;return l=>{if("start"===l.action&&(o=e.sceneIntersectionHelper.intersectElevationFromScreen(Object(s["f"])(l.screenStart.x,l.screenStart.y),t,i,a),Object(r["k"])(o)&&Object(r["k"])(n)&&!Object(c["o"])(o,o,n)))return null;if(Object(r["j"])(o))return null;const h=e.sceneIntersectionHelper.intersectElevationFromScreen(Object(s["f"])(l.screenEnd.x,l.screenEnd.y),t,i,a);return Object(r["k"])(h)?Object(r["k"])(n)&&!Object(c["o"])(h,h,n)?null:{...l,mapStart:o,mapEnd:h}:null}}function T(e,t,i,n=null,r=null){return y(e,i,Object(b["g"])(t,e,i),n,r)}function w(e,t,i,n=null,r=null){return T(e,i,Object(b["e"])(t),n,r)}function A(e,t,i,n){const s=t.toMap(e.screenStart,{include:[i]});return Object(r["k"])(s)?w(t,i,s,n):null}function P(e,t){const i=L,n=D,r=Object(l["d"])();e.renderCoordsHelper.worldUpAtPosition(t,i);const s=Object(a["j"])(r,i,Object(a["f"])(n,t,e.state.camera.eye));return Object(a["j"])(s,s,i),Object(l["g"])(t,s,r)}function E(e,t,i){let n=null;const r=new g["a"];return r.next(j(e,P(e,t))).next(S(e,t)).next(x(e,i)).next(e=>{e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,n=e}),e=>(n=null,r.execute(e),n)}function S(e,t){const i=Object(o["f"])(),n=Object(a["p"])(t);e.renderCoordsHelper.worldUpAtPosition(t,i);const r=Object(o["f"])(),s=Object(o["f"])(),c=r=>(Object(a["f"])(r,r,t),Object(u["c"])(i,r,r),"global"===e.viewingMode&&Object(a["p"])(r)*Math.sign(Object(a["i"])(i,r))<.001-n&&Object(a["f"])(r,Object(a["k"])(r,i,.001),t),Object(a["e"])(r,r,t),r);return e=>(e.renderStart=c(Object(a["g"])(r,e.renderStart)),e.renderEnd=c(Object(a["g"])(s,e.renderEnd)),e)}function x(e,t){const i=e.renderCoordsHelper;return e=>{const n=i.fromRenderCoords(e.renderStart,t),s=i.fromRenderCoords(e.renderEnd,t);return Object(r["k"])(n)&&Object(r["k"])(s)?{...e,mapStart:n,mapEnd:s}:null}}function R(e){let t=null;return i=>{switch(i.action){case"start":t=e.disableDisplay();break;case"end":case"cancel":Object(r["k"])(t)&&(t.remove(),t=null)}return i}}function M(e,t=null){const i=Object(_["a"])(e.state.viewingMode);i.options.selectionMode=!0,i.options.store=O["c"].MIN,i.options.hud=!1;const a=Object(s["f"])(),c={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},l=Object(o["f"])(),h=Object(r["s"])(t,e.spatialReference),u=t=>{e.map.ground&&e.map.ground.opacity<1?c.exclude.add(p["b"]):c.exclude.delete(p["b"]),e.sceneIntersectionHelper.intersectIntersectorScreen(Object(s["i"])(t,a),i,c);const r=i.results.min;let o;if(r.getIntersectionPoint(l))o=r.intersector===O["b"].TERRAIN?n.GROUND:n.OTHER;else{if(!i.results.ground.getIntersectionPoint(l))return null;o=n.GROUND}return{location:e.renderCoordsHelper.fromRenderCoords(l,h),surfaceType:o}};let d;return e=>{if("start"===e.action){const t=u(e.screenStart);d=Object(r["k"])(t)?t.location:null}if(Object(r["j"])(d))return null;const t=u(e.screenEnd);return Object(r["k"])(t)&&Object(r["k"])(t.location)?{...e,mapStart:d,mapEnd:t.location,surfaceType:t.surfaceType}:null}}!function(e){e[e.GROUND=0]="GROUND",e[e.OTHER=1]="OTHER"}(n||(n={}));const L=Object(o["f"])(),D=Object(o["f"])(),I=Object(h["c"])()},b623:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return u})),i.d(t,"c",(function(){return d})),i.d(t,"d",(function(){return h})),i.d(t,"e",(function(){return l}));var n=i("b2b2"),r=i("d791"),s=i("afe1"),a=i("1153"),o=i("9cc4");function c(e,t){return Object(n["j"])(e)&&(e=[]),e.push(t),e}function l(e,t){if(Object(n["j"])(e))return null;const i=e.filter(e=>e!==t);return 0===i.length?null:i}function h(e){return!!Object(n["k"])(e)&&!e.visible}function u(e,t,i){const s=e.origin.vec3;Object(a["j"])(_,-s[0],-s[1],-s[2]),Object(n["k"])(e.transformation)?Object(r["m"])(t,_,e.transformation):Object(r["c"])(t,_),i&&(Object(r["a"])(i,t),Object(r["t"])(i,i))}function d(e,t,i,n,r){b[0]=e.get(t,0),b[1]=e.get(t,1),b[2]=e.get(t,2),Object(o["a"])(b,f,3),i.set(r,0,f[0]),n.set(r,0,f[1]),i.set(r,1,f[2]),n.set(r,1,f[3]),i.set(r,2,f[4]),n.set(r,2,f[5])}const b=new Float64Array(3),f=new Float32Array(6),_=Object(s["d"])()},b7c2:function(e,t,i){"use strict";var n,r,s,a,o,c,l,h,u,d,b,f,_,O;i.d(t,"a",(function(){return _})),i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"d",(function(){return u})),i.d(t,"e",(function(){return b})),i.d(t,"f",(function(){return d})),i.d(t,"g",(function(){return c})),i.d(t,"h",(function(){return l})),i.d(t,"i",(function(){return a})),i.d(t,"j",(function(){return h})),i.d(t,"k",(function(){return f})),function(e){e[e.None=0]="None",e[e.Front=1]="Front",e[e.Back=2]="Back",e[e.COUNT=3]="COUNT"}(n||(n={})),function(e){e[e.Less=0]="Less",e[e.Lequal=1]="Lequal",e[e.COUNT=2]="COUNT"}(r||(r={})),function(e){e[e.NONE=0]="NONE",e[e.SMAA=1]="SMAA"}(s||(s={})),function(e){e[e.Color=0]="Color",e[e.Alpha=1]="Alpha",e[e.FrontFace=2]="FrontFace",e[e.NONE=3]="NONE",e[e.COUNT=4]="COUNT"}(a||(a={})),function(e){e[e.BACKGROUND=0]="BACKGROUND",e[e.UPDATE=1]="UPDATE"}(o||(o={})),function(e){e[e.NOT_LOADED=0]="NOT_LOADED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED"}(c||(c={})),function(e){e[e.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",e[e.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(l||(l={})),function(e){e[e.ASYNC=0]="ASYNC",e[e.SYNC=1]="SYNC"}(h||(h={})),function(e){e[e.Highlight=0]="Highlight",e[e.MaskOccludee=1]="MaskOccludee",e[e.COUNT=2]="COUNT"}(u||(u={})),function(e){e[e.Triangle=0]="Triangle",e[e.Point=1]="Point",e[e.Line=2]="Line"}(d||(d={})),function(e){e[e.STRETCH=1]="STRETCH",e[e.PAD=2]="PAD"}(b||(b={})),function(e){e[e.CHANGED=0]="CHANGED",e[e.UNCHANGED=1]="UNCHANGED"}(f||(f={})),function(e){e[e.Blend=0]="Blend",e[e.Opaque=1]="Opaque",e[e.Mask=2]="Mask",e[e.MaskBlend=3]="MaskBlend",e[e.COUNT=4]="COUNT"}(_||(_={})),function(e){e[e.OFF=0]="OFF",e[e.ON=1]="ON"}(O||(O={}))},ba58:function(e,t,i){"use strict";i.d(t,"a",(function(){return p})),i.d(t,"b",(function(){return x})),i.d(t,"c",(function(){return A})),i.d(t,"d",(function(){return R})),i.d(t,"e",(function(){return y})),i.d(t,"f",(function(){return S})),i.d(t,"g",(function(){return w})),i.d(t,"h",(function(){return T})),i.d(t,"i",(function(){return E}));var n=i("b2b2"),r=i("d791"),s=i("afe1"),a=i("0b2d"),o=i("7577"),c=i("0fc4"),l=i("8188"),h=i("4261"),u=i("9180"),d=i("57e5"),b=i("32ed"),f=i("1a54"),_=i("d3cf"),O=i("b7bd");function p(e,t){if("point"===e.type)return v(e,t,!1);if(Object(_["d"])(e))switch(e.type){case"extent":return v(e.center,t,!1);case"polygon":return v(e.centroid,t,!1);case"polyline":return v(g(e),t,!0);case"mesh":return v(e.origin,t,!1)}else switch(e.type){case"extent":return v(j(e),t,!0);case"polygon":return v(m(e),t,!0);case"polyline":return v(g(e),t,!0)}}function g(e){const t=e.paths[0];if(!t||0===t.length)return null;const i=Object(b["g"])(t,Object(b["f"])(t)/2);return Object(f["g"])(i[0],i[1],i[2],e.spatialReference)}function j(e){const t=isFinite(e.zmin);return Object(f["g"])(.5*(e.xmax+e.xmin),.5*(e.ymax+e.ymin),t?.5*(e.zmax+e.zmin):void 0,e.spatialReference)}function m(e){const t=e.rings[0];if(!t||0===t.length)return null;const i=Object(d["c"])(e.rings,e.hasZ);return Object(f["g"])(i[0],i[1],i[2],e.spatialReference)}function v(e,t,i){const n=i?e:Object(_["a"])(e);return t&&e?Object(l["o"])(e,n,t)?n:null:n}function y(e,t,i,n=0){if(e){t||(t=Object(u["k"])());const r=e;let s=.5*r.width*(i-1),a=.5*r.height*(i-1);return r.width<1e-7*r.height?s+=a/20:r.height<1e-7*r.width&&(a+=s/20),Object(o["l"])(t,r.xmin-s-n,r.ymin-a-n,r.xmax+s+n,r.ymax+a+n),t}return null}function T(e,t){for(let i=0;i<e.geometries.length;++i){const n=e.geometries[i].getMutableAttribute(O["a"].AUXPOS1);n&&n.data[3]!==t&&(n.data[3]=t,e.geometryVertexAttrsUpdated(e.geometryRecords[i]))}}function w(e,t){const i=Object(c["f"])(c["a"]);return Object(n["k"])(e)&&(i[0]=e[0],i[1]=e[1],i[2]=e[2]),Object(n["k"])(t)?i[3]=t:Object(n["k"])(e)&&e.length>3&&(i[3]=e[3]),i}function A(e=a["a"],t,i,r=1){const s=new Array(3);if(Object(n["j"])(t)||Object(n["j"])(i))s[0]=1,s[1]=1,s[2]=1;else{let n,r=0;for(let a=2;a>=0;a--){const o=e[a];let c;const l=null!=o,h=0===a&&!n&&!l,u=i[a];"symbol-value"===o||h?c=0!==u?t[a]/u:1:l&&"proportional"!==o&&isFinite(o)&&(c=0!==u?o/u:1),null!=c&&(s[a]=c,n=c,r=Math.max(r,Math.abs(c)))}for(let e=2;e>=0;e--)null==s[e]?s[e]=n:0===s[e]&&(s[e]=.001*r)}for(let n=2;n>=0;n--)s[n]/=r;return Object(a["g"])(s)}function P(e){return null!=e.isPrimitive}function E(e){return P(e)&&(e=[e.width,e.depth,e.height]),S(e)?null:"Symbol sizes may not be negative values"}function S(e){if(Array.isArray(e)){for(const t of e)if(!S(t))return!1;return!0}return null==e||e>=0}function x(e,t,i,n=Object(s["d"])()){const a=e||0,o=t||0,c=i||0;return 0!==a&&Object(r["g"])(n,n,-a/180*Math.PI),0!==o&&Object(r["r"])(n,n,o/180*Math.PI),0!==c&&Object(r["o"])(n,n,c/180*Math.PI),n}function R(e,t){return null!=t.minDemResolution?t.minDemResolution:Object(h["s"])(e)?t.minDemResolutionForPoints:.01*Object(h["t"])(e)}},badc:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.INTEGRATED_MESH=0]="INTEGRATED_MESH",e[e.OPAQUE_TERRAIN=1]="OPAQUE_TERRAIN",e[e.OPAQUE_MATERIAL=2]="OPAQUE_MATERIAL",e[e.TRANSPARENT_MATERIAL=3]="TRANSPARENT_MATERIAL",e[e.TRANSPARENT_TERRAIN=4]="TRANSPARENT_TERRAIN",e[e.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL=5]="TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL",e[e.OCCLUDED_TERRAIN=6]="OCCLUDED_TERRAIN",e[e.OCCLUDER_MATERIAL=7]="OCCLUDER_MATERIAL",e[e.TRANSPARENT_OCCLUDER_MATERIAL=8]="TRANSPARENT_OCCLUDER_MATERIAL",e[e.OCCLUSION_PIXELS=9]="OCCLUSION_PIXELS",e[e.POSTPROCESSING_ENVIRONMENT_OPAQUE=10]="POSTPROCESSING_ENVIRONMENT_OPAQUE",e[e.POSTPROCESSING_ENVIRONMENT_TRANSPARENT=11]="POSTPROCESSING_ENVIRONMENT_TRANSPARENT",e[e.LASERLINES=12]="LASERLINES",e[e.LASERLINES_CONTRAST_CONTROL=13]="LASERLINES_CONTRAST_CONTROL",e[e.HUD_MATERIAL=14]="HUD_MATERIAL",e[e.LABEL_MATERIAL=15]="LABEL_MATERIAL",e[e.LINE_CALLOUTS=16]="LINE_CALLOUTS",e[e.LINE_CALLOUTS_HUD_DEPTH=17]="LINE_CALLOUTS_HUD_DEPTH",e[e.DRAPED_MATERIAL=18]="DRAPED_MATERIAL",e[e.DRAPED_WATER=19]="DRAPED_WATER",e[e.VOXEL=20]="VOXEL",e[e.MAX_SLOTS=21]="MAX_SLOTS"}(n||(n={}))},bea9:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("f2e0");class r{constructor(e){this.channel=e,this.id=Object(n["a"])()}}},c2d1:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("a05b"),r=i("501b"),s=i("3886");function a(e,t){e.fragment.include(r["a"]),t.output===n["a"].Shadow?(e.extensions.add("GL_OES_standard_derivatives"),e.fragment.code.add(s["b"]`float _calculateFragDepth(const in float depth) {
const float SLOPE_SCALE = 2.0;
const float BIAS = 2.0 * .000015259;
float m = max(abs(dFdx(depth)), abs(dFdy(depth)));
float result = depth + SLOPE_SCALE * m + BIAS;
return clamp(result, .0, .999999);
}
void outputDepth(float _linearDepth) {
gl_FragColor = float2rgba(_calculateFragDepth(_linearDepth));
}`)):t.output===n["a"].Depth&&e.fragment.code.add(s["b"]`void outputDepth(float _linearDepth) {
gl_FragColor = float2rgba(_linearDepth);
}`)}},c3a4:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t){this._module=e,this._loadModule=t}get(){return this._module}async reload(){return this._module=await this._loadModule(),this._module}}},c6d7:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return o}));var n=i("d047"),r=i("d8a4"),s=i("3886"),a=i("6a3c");function o(e,t){t.hasMultipassTerrain&&(e.fragment.include(n["a"]),e.fragment.uniforms.add(new a["a"]("terrainDepthTexture",(e,t)=>t.multipassTerrain.linearDepthTexture)),e.fragment.uniforms.add(new r["a"]("nearFar",(e,t)=>t.camera.nearFar)),e.fragment.uniforms.add(new r["a"]("inverseViewport",(e,t)=>t.inverseViewport)),e.fragment.code.add(s["b"]`
    void terrainDepthTest(vec4 fragCoord, float fragmentDepth){
      float terrainDepth = linearDepthFromTexture(terrainDepthTexture, fragCoord.xy * inverseViewport, nearFar);
      if(fragmentDepth ${t.cullAboveGround?">":"<="} terrainDepth){
        discard;
      }
    }
  `))}class c{constructor(){this.enabled=!1,this.cullAboveGround=!1}}},c829:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("b2b2"),r=i("8a44"),s=i("52b2"),a=i("1956");class o{constructor(e,t,i){this._context=e,this._locations=i,this._textures=new Map,this._freeTextureUnits=new r["a"]({deallocator:null}),this._glProgram=e.programCache.acquire(t.generate("vertex"),t.generate("fragment"),i),this._glProgram.stop=()=>{throw new Error("Wrapped _glProgram used directly")},this.bindPass=t.generateBind(s["a"].Pass,this),this.bindDraw=t.generateBind(s["a"].Draw,this),this._fragmentUniforms=Object(a["b"])()?t.fragmentUniforms:null}dispose(){this._glProgram.dispose()}get glName(){return this._glProgram.glName}get isCompiled(){return this._glProgram.isCompiled}setUniform1b(e,t){this._glProgram.setUniform1i(e,t?1:0)}setUniform1i(e,t){this._glProgram.setUniform1i(e,t)}setUniform1f(e,t){this._glProgram.setUniform1f(e,t)}setUniform2f(e,t,i){this._glProgram.setUniform2f(e,t,i)}setUniform2fv(e,t){this._glProgram.setUniform2fv(e,t)}setUniform3f(e,t,i,n){this._glProgram.setUniform3f(e,t,i,n)}setUniform3fv(e,t){this._glProgram.setUniform3fv(e,t)}setUniform4f(e,t,i,n,r){this._glProgram.setUniform4f(e,t,i,n,r)}setUniform4fv(e,t){this._glProgram.setUniform4fv(e,t)}setUniformMatrix3fv(e,t){this._glProgram.setUniformMatrix3fv(e,t)}setUniformMatrix4fv(e,t){this._glProgram.setUniformMatrix4fv(e,t)}setUniform1fv(e,t){this._glProgram.setUniform1fv(e,t)}setUniform1iv(e,t){this._glProgram.setUniform1iv(e,t)}setUniform2iv(e,t){this._glProgram.setUniform3iv(e,t)}setUniform3iv(e,t){this._glProgram.setUniform3iv(e,t)}setUniform4iv(e,t){this._glProgram.setUniform4iv(e,t)}assertCompatibleVertexAttributeLocations(e){e.locations!==this._locations&&console.error("VertexAttributeLocations are incompatible")}stop(){this._textures.clear(),this._freeTextureUnits.clear()}bindTexture(e,t){if(Object(n["j"])(t)||null==t.glName){const t=this._textures.get(e);return t&&(this._context.bindTexture(null,t.unit),this._freeTextureUnit(t),this._textures.delete(e)),null}let i=this._textures.get(e);return null==i?(i=this._allocTextureUnit(t),this._textures.set(e,i)):i.texture=t,this._context.useProgram(this),this.setUniform1i(e,i.unit),this._context.bindTexture(t,i.unit),i.unit}rebindTextures(){this._context.useProgram(this),this._textures.forEach((e,t)=>{this._context.bindTexture(e.texture,e.unit),this.setUniform1i(t,e.unit)}),Object(n["k"])(this._fragmentUniforms)&&this._fragmentUniforms.forEach(e=>{"sampler2D"!==e.type&&"samplerCube"!==e.type||this._textures.has(e.name)||console.error(`Texture sampler ${e.name} has no bound texture`)})}_allocTextureUnit(e){return{texture:e,unit:0===this._freeTextureUnits.length?this._textures.size:this._freeTextureUnits.pop()}}_freeTextureUnit(e){this._freeTextureUnits.push(e.unit)}}},ca98:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("b2b2"),r=i("d17d");class s{constructor(e,t,i){this.release=i,t&&(this.initializeConfiguration(e,t),this._configuration=t.snapshot()),this._program=this.initializeProgram(e),this._pipeline=this.initializePipeline(e.rctx.capabilities)}destroy(){this._program=Object(n["e"])(this._program),this._pipeline=this._configuration=null}reload(e){Object(n["e"])(this._program),this._program=this.initializeProgram(e),this._pipeline=this.initializePipeline(e.rctx.capabilities)}get program(){return this._program}get compiled(){return this.program.isCompiled}get key(){return this._configuration.key}get configuration(){return this._configuration}bindPass(e,t){this.program.bindPass(e,t)}bindDraw(e,t){this.program.bindDraw(e,t),this.program.rebindTextures()}bindPipelineState(e,t=null,i){e.setPipelineState(this.getPipelineState(t,i))}ensureAttributeLocations(e){this.program.assertCompatibleVertexAttributeLocations(e)}get primitiveType(){return r["r"].TRIANGLES}getPipelineState(e,t){return this._pipeline}initializeConfiguration(e,t){}}},caf7:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n,r=i("e431"),s=i("47f8"),a=i("0b2d"),o=i("7289"),c=i("d18f"),l=i("b7c2");!function(e){function t(e,t){const i=e[t],n=e[t+1],r=e[t+2];return Math.sqrt(i*i+n*n+r*r)}function i(e,t){const i=e[t],n=e[t+1],r=e[t+2],s=1/Math.sqrt(i*i+n*n+r*r);e[t]*=s,e[t+1]*=s,e[t+2]*=s}function n(e,t,i){e[t]*=i,e[t+1]*=i,e[t+2]*=i}function r(e,t,i,n,r,s=t){(r=r||e)[s]=e[t]+i[n],r[s+1]=e[t+1]+i[n+1],r[s+2]=e[t+2]+i[n+2]}function s(e,t,i,n,r,s=t){(r=r||e)[s]=e[t]-i[n],r[s+1]=e[t+1]-i[n+1],r[s+2]=e[t+2]-i[n+2]}e.length=t,e.normalize=i,e.scale=n,e.add=r,e.subtract=s}(n||(n={}));var h=i("0278"),u=i("1038"),d=i("1153"),b=i("b7bd");const f=n;var _,O,p,g;!function(e){const t=.5,i=[[-t,-t,t],[t,-t,t],[t,t,t],[-t,t,t],[-t,-t,-t],[t,-t,-t],[t,t,-t],[-t,t,-t]],n=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],r=[0,0,1,0,1,1,0,1],s=new Uint16Array([0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5]),a=new Uint16Array(36);for(let l=0;l<6;l++)for(let e=0;e<6;e++)a[6*l+e]=l;const o=new Uint16Array(36);for(let l=0;l<6;l++)o[6*l+0]=0,o[6*l+1]=1,o[6*l+2]=2,o[6*l+3]=2,o[6*l+4]=3,o[6*l+5]=0;function c(e){Array.isArray(e)||(e=[e,e,e]);const t=new Array(24);for(let n=0;n<8;n++)t[3*n]=i[n][0]*e[0],t[3*n+1]=i[n][1]*e[1],t[3*n+2]=i[n][2]*e[2];return new h["a"]([[b["a"].POSITION,{size:3,data:t,exclusive:!0}],[b["a"].NORMAL,{size:3,data:n}],[b["a"].UV0,{size:2,data:r}]],[[b["a"].POSITION,s],[b["a"].NORMAL,a],[b["a"].UV0,o]])}e.createGeometry=c}(_||(_={})),function(e){const t=.5,i=[[-t,0,-t],[t,0,-t],[t,0,t],[-t,0,t],[0,-t,0],[0,t,0]],n=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],r=new Uint16Array([5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0]),s=new Uint16Array([0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7]);function a(e){Array.isArray(e)||(e=[e,e,e]);const t=new Array(18);for(let n=0;n<6;n++)t[3*n]=i[n][0]*e[0],t[3*n+1]=i[n][1]*e[1],t[3*n+2]=i[n][2]*e[2];return new h["a"]([[b["a"].POSITION,{size:3,data:t,exclusive:!0}],[b["a"].NORMAL,{size:3,data:n}]],[[b["a"].POSITION,r],[b["a"].NORMAL,s]])}e.createGeometry=a}(O||(O={})),function(e){const t=.5,i=0,n=Object(s["c"])(-t,i,-t),a=Object(s["c"])(t,i,-t),o=Object(s["c"])(0,i,t),c=Object(s["c"])(0,i+t,0),l=Object(s["b"])(),u=Object(s["b"])(),d=Object(s["b"])(),f=Object(s["b"])(),_=Object(s["b"])();Object(r["f"])(l,n,c),Object(r["f"])(u,n,a),Object(r["j"])(d,l,u),Object(r["r"])(d,d),Object(r["f"])(l,a,c),Object(r["f"])(u,a,o),Object(r["j"])(f,l,u),Object(r["r"])(f,f),Object(r["f"])(l,o,c),Object(r["f"])(u,o,n),Object(r["j"])(_,l,u),Object(r["r"])(_,_);const O=[n,a,o,c],p=[0,-1,0,d[0],d[1],d[2],f[0],f[1],f[2],_[0],_[1],_[2]],g=[0,1,2,3,1,0,3,2,1,3,0,2],j=[0,0,0,1,1,1,2,2,2,3,3,3];function m(e){Array.isArray(e)||(e=[e,e,e]);const t=new Array(12);for(let i=0;i<4;i++)t[3*i]=O[i][0]*e[0],t[3*i+1]=O[i][1]*e[1],t[3*i+2]=O[i][2]*e[2];return new h["a"]([[b["a"].POSITION,{size:3,data:t,exclusive:!0}],[b["a"].NORMAL,{size:3,data:p}]],[[b["a"].POSITION,new Uint16Array(g)],[b["a"].NORMAL,new Uint16Array(j)]])}e.createGeometry=m}(p||(p={})),function(e){function t(e,t,i,n={uv:!0}){const r=-Math.PI,s=2*Math.PI,a=-Math.PI/2,o=Math.PI,c=Math.max(3,Math.floor(t)),l=Math.max(2,Math.floor(i)),u=(c+1)*(l+1),d=new Float32Array(3*u),f=new Float32Array(3*u),_=new Float32Array(2*u),O=[];let p=0;for(let h=0;h<=l;h++){const t=[],i=h/l,n=a+i*o,u=Math.cos(n);for(let a=0;a<=c;a++){const o=a/c,l=r+o*s,h=Math.cos(l)*u,b=Math.sin(n),O=-Math.sin(l)*u;d[3*p]=h*e,d[3*p+1]=b*e,d[3*p+2]=O*e,f[3*p]=h,f[3*p+1]=b,f[3*p+2]=O,_[2*p]=o,_[2*p+1]=i,t.push(p),++p}O.push(t)}const g=new Uint32Array(2*c*(l-1)*3);p=0;for(let h=0;h<l;h++)for(let e=0;e<c;e++){const t=O[h][e],i=O[h][e+1],n=O[h+1][e+1],r=O[h+1][e];0===h?(g[p++]=t,g[p++]=n,g[p++]=r):h===l-1?(g[p++]=t,g[p++]=i,g[p++]=n):(g[p++]=t,g[p++]=i,g[p++]=n,g[p++]=n,g[p++]=r,g[p++]=t)}const j=[[b["a"].POSITION,g],[b["a"].NORMAL,g]],m=[[b["a"].POSITION,{size:3,data:d,exclusive:!0}],[b["a"].NORMAL,{size:3,data:f,exclusive:!0}]];return n.uv&&(m.push([b["a"].UV0,{size:2,data:_,exclusive:!0}]),j.push([b["a"].UV0,g])),n.offset&&(j[0][0]=b["a"].OFFSET,m[0][0]=b["a"].OFFSET,j.push([b["a"].POSITION,new Uint32Array(g.length)]),m.push([b["a"].POSITION,{size:3,data:Float64Array.from(n.offset),exclusive:!0}])),new h["a"](m,j)}function i(e,t,i){const n=e;let r,s;if(i)r=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],s=new Uint32Array([0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1]);else{const e=n*(1+Math.sqrt(5))/2;r=[-n,e,0,n,e,0,-n,-e,0,n,-e,0,0,-n,e,0,n,e,0,-n,-e,0,n,-e,e,0,-n,e,0,n,-e,0,-n,-e,0,n],s=new Uint32Array([0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1])}for(let h=0;h<r.length;h+=3)f.scale(r,h,e/f.length(r,h));let a={};function o(t,i){t>i&&([t,i]=[i,t]);const n=t.toString()+"."+i.toString();if(a[n])return a[n];let s=r.length;return r.length+=3,f.add(r,3*t,r,3*i,r,s),f.scale(r,s,e/f.length(r,s)),s/=3,a[n]=s,s}for(let h=0;h<t;h++){const e=s.length,t=new Uint32Array(4*e);for(let i=0;i<e;i+=3){const e=s[i],n=s[i+1],r=s[i+2],a=o(e,n),c=o(n,r),l=o(r,e),h=4*i;t[h]=e,t[h+1]=a,t[h+2]=l,t[h+3]=n,t[h+4]=c,t[h+5]=a,t[h+6]=r,t[h+7]=l,t[h+8]=c,t[h+9]=a,t[h+10]=c,t[h+11]=l}s=t,a={}}const c=new Float32Array(r);for(let h=0;h<c.length;h+=3)f.normalize(c,h);const l=[[b["a"].POSITION,s],[b["a"].NORMAL,s]],u=[[b["a"].POSITION,{size:3,data:new Float32Array(r),exclusive:!0}],[b["a"].NORMAL,{size:3,data:c,exclusive:!0}]];return new h["a"](u,l)}function n(e,t,i,n,r,s,a){const o=t?[t[0],t[1],t[2]]:[0,0,0],c=e?[e[0],e[1],e[2]]:[0,0,1];s=s||[0,0];const u=i?[255*i[0],255*i[1],255*i[2],i.length>3?255*i[3]:255]:[255,255,255,255],d=null!=n&&2===n.length?n:[1,1],f=[[b["a"].POSITION,{size:3,data:o,exclusive:!0}],[b["a"].NORMAL,{size:3,data:c,exclusive:!0}],[b["a"].UV0,{size:s.length,data:s}],[b["a"].COLOR,{size:4,data:u,exclusive:!0}],[b["a"].SIZE,{size:2,data:d}]];if(null!=r){const e=new Float32Array([r[0],r[1],r[2],r[3]]);f.push([b["a"].AUXPOS1,{size:4,data:e}])}if(null!=a){const e=new Float32Array([a[0],a[1],a[2],a[3]]);f.push([b["a"].AUXPOS2,{size:4,data:e}])}return new h["a"](f,null,l["f"].Point)}function g(e,t,i,n,r,s,a,o){if(null!=e){const{data:t}=o.getMutableAttribute(b["a"].NORMAL);t[0]=e[0],t[1]=e[1],t[2]=e[2]}if(null!=t){const{data:e}=o.getMutableAttribute(b["a"].POSITION);e[0]=t[0],e[1]=t[1],e[2]=t[2]}if(null!=i){const{data:e}=o.getMutableAttribute(b["a"].COLOR);e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3]}if(null!=n){const{data:e}=o.getMutableAttribute(b["a"].SIZE);e[0]=n[0],e[1]=n[1]}if(null!=r){const{data:e}=o.getMutableAttribute(b["a"].AUXPOS1);e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3]}if(null!=s){const{data:e}=o.getMutableAttribute(b["a"].UV0);e[0]=s[0],e[1]=s[1]}if(null!=a){const{data:e}=o.getMutableAttribute(b["a"].AUXPOS2);e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3]}}function v(e,t){const i=new Float32Array(3*e.length),n=new Float32Array(t?3*e.length:3),r=new Uint32Array(e.length),s=new Uint32Array(e.length);for(let l=0;l<e.length;l++)i[3*l]=e[l][0],i[3*l+1]=e[l][1],i[3*l+2]=e[l][2],t&&(n[3*l]=t[l][0],n[3*l+1]=t[l][1],n[3*l+2]=t[l][2]),r[l]=l,s[l]=0;t||(n[0]=0,n[1]=1,n[2]=0);const a=[0,0],o=[[b["a"].POSITION,r],[b["a"].NORMAL,t?r:s],[b["a"].UV0,s]],c=[[b["a"].POSITION,{size:3,data:i,exclusive:!0}],[b["a"].NORMAL,{size:3,data:n,exclusive:!0}],[b["a"].UV0,{size:2,data:a,exclusive:!0}]];return new h["a"](c,o,l["f"].Point)}function y(){const e=[0,0,0,0,0,100,100,0,0],t=new Uint16Array([0,1,2]),i=[0,1,0],n=new Uint16Array([0,0,0]),r=[0,0],s=new Uint16Array([0,0,0]),a=[[b["a"].POSITION,t],[b["a"].NORMAL,n],[b["a"].UV0,s]],o=[[b["a"].POSITION,{size:3,data:e,exclusive:!0}],[b["a"].NORMAL,{size:3,data:i,exclusive:!0}],[b["a"].UV0,{size:2,data:r,exclusive:!0}]];return new h["a"](o,a)}e.createBoxGeometry=_.createGeometry,e.createDiamondGeometry=O.createGeometry,e.createTetrahedronGeometry=p.createGeometry,e.createSphereGeometry=t,e.createPolySphereGeometry=i,e.createPointGeometry=n,e.updatePointGeometry=g,e.createPointArrayGeometry=v,e.createTriangleGeometry=y;const T=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]];function w(e=T){const t=new Array(12);for(let l=0;l<4;l++)for(let i=0;i<3;i++)t[3*l+i]=e[l][i];const i=new Uint32Array([0,1,2,2,3,0]),n=[0,0,1],r=new Uint32Array([0,0,0,0,0,0]),s=[0,0,1,0,1,1,0,1],a=[255,255,255,255],o=[[b["a"].POSITION,i],[b["a"].NORMAL,r],[b["a"].UV0,i],[b["a"].COLOR,r]],c=[[b["a"].POSITION,{size:3,data:t,exclusive:!0}],[b["a"].NORMAL,{size:3,data:n,exclusive:!0}],[b["a"].UV0,{size:2,data:s,exclusive:!0}],[b["a"].COLOR,{size:4,data:a,exclusive:!0}]];return new h["a"](c,o)}function A(e,t,i,n,r=!0,a=!0){let o=0;const c=t,l=e;let u=Object(s["c"])(0,o,0),d=Object(s["c"])(0,o+l,0),f=Object(s["c"])(0,-1,0),_=Object(s["c"])(0,1,0);n&&(o=l,d=Object(s["c"])(0,0,0),u=Object(s["c"])(0,o,0),f=Object(s["c"])(0,1,0),_=Object(s["c"])(0,-1,0));const O=[d,u],p=[f,_],g=i+2,j=Math.sqrt(l*l+c*c);if(n)for(let h=i-1;h>=0;h--){const e=h*(2*Math.PI/i),t=Object(s["c"])(Math.cos(e)*c,o,Math.sin(e)*c);O.push(t);const n=Object(s["c"])(l*Math.cos(e)/j,-c/j,l*Math.sin(e)/j);p.push(n)}else for(let h=0;h<i;h++){const e=h*(2*Math.PI/i),t=Object(s["c"])(Math.cos(e)*c,o,Math.sin(e)*c);O.push(t);const n=Object(s["c"])(l*Math.cos(e)/j,c/j,l*Math.sin(e)/j);p.push(n)}const m=new Uint32Array(2*(i+2)*3),v=new Uint32Array(2*(i+2)*3);let y=0,T=0;if(r){for(let e=3;e<O.length;e++)m[y++]=1,m[y++]=e-1,m[y++]=e,v[T++]=0,v[T++]=0,v[T++]=0;m[y++]=O.length-1,m[y++]=2,m[y++]=1,v[T++]=0,v[T++]=0,v[T++]=0}if(a){for(let e=3;e<O.length;e++)m[y++]=e,m[y++]=e-1,m[y++]=0,v[T++]=e,v[T++]=e-1,v[T++]=1;m[y++]=0,m[y++]=2,m[y++]=O.length-1,v[T++]=1,v[T++]=2,v[T++]=p.length-1}const w=new Float32Array(3*g);for(let s=0;s<g;s++)w[3*s]=O[s][0],w[3*s+1]=O[s][1],w[3*s+2]=O[s][2];const A=new Float32Array(3*g);for(let s=0;s<g;s++)A[3*s]=p[s][0],A[3*s+1]=p[s][1],A[3*s+2]=p[s][2];const P=[[b["a"].POSITION,m],[b["a"].NORMAL,v]],E=[[b["a"].POSITION,{size:3,data:w,exclusive:!0}],[b["a"].NORMAL,{size:3,data:A,exclusive:!0}]];return new h["a"](E,P)}function P(e,t,i,n,a,o){const c=n?Object(s["a"])(n):Object(s["c"])(1,0,0),l=a?Object(s["a"])(a):Object(s["c"])(0,0,0);o=null==o||o;const u=Object(s["b"])();Object(r["r"])(u,c);const d=Object(s["b"])();Object(r["k"])(d,u,Math.abs(e));const f=Object(s["b"])();Object(r["k"])(f,d,-.5),Object(r["e"])(f,f,l);const _=Object(s["c"])(0,1,0);Math.abs(1-Object(r["i"])(u,_))<.2&&Object(r["w"])(_,0,0,1);const O=Object(s["b"])();Object(r["j"])(O,u,_),Object(r["r"])(O,O),Object(r["j"])(_,O,u);const p=2*i+(o?2:0),g=i+(o?2:0),j=new Float32Array(3*p),m=new Float32Array(3*g),v=new Float32Array(2*p),y=new Uint32Array(3*i*(o?4:2)),T=new Uint32Array(3*i*(o?4:2));o&&(j[3*(p-2)+0]=f[0],j[3*(p-2)+1]=f[1],j[3*(p-2)+2]=f[2],v[2*(p-2)]=0,v[2*(p-2)+1]=0,j[3*(p-1)+0]=j[3*(p-2)+0]+d[0],j[3*(p-1)+1]=j[3*(p-2)+1]+d[1],j[3*(p-1)+2]=j[3*(p-2)+2]+d[2],v[2*(p-1)]=1,v[2*(p-1)+1]=1,m[3*(g-2)+0]=-u[0],m[3*(g-2)+1]=-u[1],m[3*(g-2)+2]=-u[2],m[3*(g-1)+0]=u[0],m[3*(g-1)+1]=u[1],m[3*(g-1)+2]=u[2]);const w=(e,t,i)=>{y[e]=t,T[e]=i};let A=0;const P=Object(s["b"])(),E=Object(s["b"])();for(let s=0;s<i;s++){const e=s*(2*Math.PI/i);Object(r["k"])(P,_,Math.sin(e)),Object(r["k"])(E,O,Math.cos(e)),Object(r["e"])(P,P,E),m[3*s+0]=P[0],m[3*s+1]=P[1],m[3*s+2]=P[2],Object(r["k"])(P,P,t),Object(r["e"])(P,P,f),j[3*s+0]=P[0],j[3*s+1]=P[1],j[3*s+2]=P[2],v[2*s+0]=s/i,v[2*s+1]=0,j[3*(s+i)+0]=j[3*s+0]+d[0],j[3*(s+i)+1]=j[3*s+1]+d[1],j[3*(s+i)+2]=j[3*s+2]+d[2],v[2*(s+i)+0]=s/i,v[2*s+1]=1;const n=(s+1)%i;w(A++,s,s),w(A++,s+i,s),w(A++,n,n),w(A++,n,n),w(A++,s+i,s),w(A++,n+i,n)}if(o){for(let e=0;e<i;e++){const t=(e+1)%i;w(A++,p-2,g-2),w(A++,e,g-2),w(A++,t,g-2)}for(let e=0;e<i;e++){const t=(e+1)%i;w(A++,e+i,g-1),w(A++,p-1,g-1),w(A++,t+i,g-1)}}const S=[[b["a"].POSITION,y],[b["a"].NORMAL,T],[b["a"].UV0,y]],x=[[b["a"].POSITION,{size:3,data:j,exclusive:!0}],[b["a"].NORMAL,{size:3,data:m,exclusive:!0}],[b["a"].UV0,{size:2,data:v,exclusive:!0}]];return new h["a"](x,S)}function E(t,i,n,r,s){n=n||10,r=null==r||r,Object(d["a"])(t.length>1);const a=[[0,0,0]],o=[],c=[];for(let e=0;e<n;e++){o.push([0,-e-1,-(e+1)%n-1]);const t=e/n*2*Math.PI;c.push([Math.cos(t)*i,Math.sin(t)*i])}return e.createPathExtrusionGeometry(c,t,a,o,r,s)}function S(e,t,i,n,l,u=Object(s["c"])(0,0,0)){const d=e.length,f=new Float32Array(t.length*d*3+(6*i.length||0)),_=new Float32Array(t.length*d*3+(i?6:0)),O=(t.length-1)*d*6+3*n.length*2,p=new Uint32Array(O),g=new Uint32Array(O);let m=0,v=0,y=0,T=0;const w=Object(s["b"])(),A=Object(s["b"])(),P=Object(s["b"])(),E=Object(s["b"])(),S=Object(s["b"])(),x=Object(s["b"])(),R=Object(s["b"])(),M=Object(a["f"])(),L=Object(s["b"])(),D=Object(s["b"])(),N=Object(s["b"])(),V=Object(s["b"])(),C=Object(s["b"])(),F=Object(o["d"])();Object(r["w"])(L,0,1,0),Object(r["f"])(A,t[1],t[0]),Object(r["r"])(A,A),l?(Object(r["e"])(M,t[0],u),Object(r["r"])(P,M)):Object(r["w"])(P,0,0,1),I(A,P,L,L,S,P,j),Object(r["g"])(E,P),Object(r["g"])(V,S);for(let s=0;s<i.length;s++)Object(r["k"])(x,S,i[s][0]),Object(r["k"])(M,P,i[s][2]),Object(r["e"])(x,x,M),Object(r["e"])(x,x,t[0]),f[m++]=x[0],f[m++]=x[1],f[m++]=x[2];_[v++]=-A[0],_[v++]=-A[1],_[v++]=-A[2];for(let r=0;r<n.length;r++)p[y++]=n[r][0]>0?n[r][0]:-n[r][0]-1+i.length,p[y++]=n[r][1]>0?n[r][1]:-n[r][1]-1+i.length,p[y++]=n[r][2]>0?n[r][2]:-n[r][2]-1+i.length,g[T++]=0,g[T++]=0,g[T++]=0;let U=i.length;const k=i.length-1;for(let s=0;s<t.length;s++){let i=!1;s>0&&(Object(r["g"])(w,A),s<t.length-1?(Object(r["f"])(A,t[s+1],t[s]),Object(r["r"])(A,A)):i=!0,Object(r["e"])(D,w,A),Object(r["r"])(D,D),Object(r["e"])(N,t[s-1],E),Object(o["g"])(t[s],D,F),Object(o["m"])(F,Object(c["g"])(N,w),M)?(Object(r["f"])(M,M,t[s]),Object(r["r"])(P,M),Object(r["j"])(S,D,P),Object(r["r"])(S,S)):I(D,E,V,L,S,P,j),Object(r["g"])(E,P),Object(r["g"])(V,S)),l&&(Object(r["e"])(M,t[s],u),Object(r["r"])(C,M));for(let n=0;n<d;n++)if(Object(r["k"])(x,S,e[n][0]),Object(r["k"])(M,P,e[n][1]),Object(r["e"])(x,x,M),Object(r["r"])(R,x),_[v++]=R[0],_[v++]=R[1],_[v++]=R[2],Object(r["e"])(x,x,t[s]),f[m++]=x[0],f[m++]=x[1],f[m++]=x[2],!i){const e=(n+1)%d;p[y++]=U+n,p[y++]=U+d+n,p[y++]=U+e,p[y++]=U+e,p[y++]=U+d+n,p[y++]=U+d+e;for(let t=0;t<6;t++)g[T++]=p[y-6+t]-k}U+=d}const B=t[t.length-1];for(let s=0;s<i.length;s++)Object(r["k"])(x,S,i[s][0]),Object(r["k"])(M,P,i[s][1]),Object(r["e"])(x,x,M),Object(r["e"])(x,x,B),f[m++]=x[0],f[m++]=x[1],f[m++]=x[2];const z=v/3;_[v++]=A[0],_[v++]=A[1],_[v++]=A[2];const G=U-d;for(let r=0;r<n.length;r++)p[y++]=n[r][0]>=0?U+n[r][0]:-n[r][0]-1+G,p[y++]=n[r][2]>=0?U+n[r][2]:-n[r][2]-1+G,p[y++]=n[r][1]>=0?U+n[r][1]:-n[r][1]-1+G,g[T++]=z,g[T++]=z,g[T++]=z;const H=[[b["a"].POSITION,p],[b["a"].NORMAL,g]],q=[[b["a"].POSITION,{size:3,data:f,exclusive:!0}],[b["a"].NORMAL,{size:3,data:_,exclusive:!0}]];return new h["a"](q,H)}function x(e,t,i){Object(d["a"])(e.length>1,"createPolylineGeometry(): polyline needs at least 2 points"),Object(d["a"])(3===e[0].length,"createPolylineGeometry(): malformed vertex"),Object(d["a"])(null==t||t.length===e.length,"createPolylineGeometry: need same number of points and normals"),Object(d["a"])(null==t||3===t[0].length,"createPolylineGeometry(): malformed normal");const n=new Float64Array(3*e.length),r=new Uint32Array(2*(e.length-1));let s=0,a=0;for(let l=0;l<e.length;l++){for(let t=0;t<3;t++)n[s++]=e[l][t];l>0&&(r[a++]=l-1,r[a++]=l)}const o=[],c=[];if(o.push([b["a"].POSITION,r]),c.push([b["a"].POSITION,{size:3,data:n,exclusive:!0}]),t){const i=new Float32Array(3*t.length);let n=0;for(let r=0;r<e.length;r++)for(let e=0;e<3;e++)i[n++]=t[r][e];o.push([b["a"].NORMAL,r]),c.push([b["a"].NORMAL,{size:3,data:i,exclusive:!0}])}return i&&(c.push([b["a"].COLOR,{size:4,data:i}]),o.push([b["a"].COLOR,Object(u["d"])(i.length/4)])),new h["a"](c,o,l["f"].Line)}function R(e,t,i,n,r=0){const s=new Array(18),a=[[-t,r,n/2],[i,r,n/2],[0,e+r,n/2],[-t,r,-n/2],[i,r,-n/2],[0,e+r,-n/2]],o=new Uint16Array([0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5]);for(let c=0;c<6;c++)s[3*c]=a[c][0],s[3*c+1]=a[c][1],s[3*c+2]=a[c][2];return new h["a"]([[b["a"].POSITION,{size:3,data:s,exclusive:!0}]],[[b["a"].POSITION,o]])}function M(e,t){const i=e.getMutableAttribute(b["a"].POSITION).data;for(let n=0;n<i.length;n+=3){const e=i[n],s=i[n+1],a=i[n+2];Object(r["w"])(m,e,s,a),Object(r["q"])(m,m,t),i[n]=m[0],i[n+1]=m[1],i[n+2]=m[2]}}function L(e,t=e){const i=e.vertexAttributes,n=i.get(b["a"].POSITION).data,r=i.get(b["a"].NORMAL).data;if(r){const e=t.getMutableAttribute(b["a"].NORMAL).data;for(let t=0;t<r.length;t+=3){const i=r[t+1];e[t+1]=-r[t+2],e[t+2]=i}}if(n){const e=t.getMutableAttribute(b["a"].POSITION).data;for(let t=0;t<n.length;t+=3){const i=n[t+1];e[t+1]=-n[t+2],e[t+2]=i}}return t}function D(e,t,i,n,s){return!(Math.abs(Object(r["i"])(t,e))>s)&&(Object(r["j"])(i,e,t),Object(r["r"])(i,i),Object(r["j"])(n,i,e),Object(r["r"])(n,n),!0)}function I(e,t,i,n,r,s,a){return D(e,t,r,s,a)||D(e,i,r,s,a)||D(e,n,r,s,a)}e.createSquareGeometry=w,e.createConeGeometry=A,e.createCylinderGeometry=P,e.createTubeGeometry=E,e.createPathExtrusionGeometry=S,e.createPolylineGeometry=x,e.createExtrudedTriangle=R,e.transformInPlace=M,e.cgToGIS=L,e.makeOrthoBasisDirUp=D,e.makeOrthoBasisDirUpFallback=I}(g||(g={}));const j=.99619469809,m=Object(s["b"])(),v=g},d047:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("501b"),r=i("3886");function s(e){e.include(n["a"]),e.code.add(r["b"]`float linearDepthFromFloat(float depth, vec2 nearFar) {
return -(depth * (nearFar[1] - nearFar[0]) + nearFar[0]);
}
float linearDepthFromTexture(sampler2D depthTex, vec2 uv, vec2 nearFar) {
return linearDepthFromFloat(rgba2float(texture2D(depthTex, uv)), nearFar);
}`)}},d0f8:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return J}));var n=i("a4ee"),r=i("f4cc"),s=i("8048"),a=i("4adc"),o=(i("b50f"),i("c120"),i("cea0"),i("59b2")),c=i("d386"),l=i("121a"),h=i("dabc"),u=i("b2b2"),d=i("3af1"),b=i("4ae5");let f=class extends h["a"]{constructor(e){super(e),this.type="direct-line-measurement",this.startPoint=null,this.endPoint=null,this.unit=null,this.nonEditableMessage="Assign start and end points to the analysis to allow editing."}get extent(){if(Object(u["j"])(this.startPoint))return null;const e=d["a"].fromPoint(this.startPoint);return Object(u["k"])(this.endPoint)&&e.union(d["a"].fromPoint(this.endPoint)),e}get requiredPropertiesForEditing(){return[this.startPoint,this.endPoint]}clear(){this.startPoint=null,this.endPoint=null}};Object(n["a"])([Object(o["b"])({type:["direct-line-measurement"]})],f.prototype,"type",void 0),Object(n["a"])([Object(o["b"])({type:b["a"]})],f.prototype,"startPoint",void 0),Object(n["a"])([Object(o["b"])({type:b["a"]})],f.prototype,"endPoint",void 0),Object(n["a"])([Object(o["b"])()],f.prototype,"extent",null),Object(n["a"])([Object(o["b"])({type:s["q"],value:null})],f.prototype,"unit",void 0),Object(n["a"])([Object(o["b"])({readOnly:!0})],f.prototype,"requiredPropertiesForEditing",null),Object(n["a"])([Object(o["b"])({readOnly:!0})],f.prototype,"nonEditableMessage",void 0),f=Object(n["a"])([Object(c["a"])("esri.analysis.DirectLineMeasurementAnalysis")],f);const _=f;var O,p,g,j=i("caf1"),m=(i("e06a"),i("af40")),v=i("477c"),y=i("a915"),T=i("0b2d"),w=i("d3cf"),A=i("a13f"),P=i("b4a5"),E=i("fc29"),S=i("bd7e");!function(e){e[e.Auto=0]="Auto",e[e.Euclidean=1]="Euclidean",e[e.Geodesic=2]="Geodesic"}(O||(O={})),function(e){e[e.None=0]="None",e[e.Direct=1]="Direct",e[e.Triangle=2]="Triangle",e[e.ProjectedGeodesic=3]="ProjectedGeodesic"}(p||(p={})),function(e){e[e.Auto=0]="Auto",e[e.AboveSegment=1]="AboveSegment",e[e.BelowSegment=2]="BelowSegment"}(g||(g={}));var x=i("74af"),R=i("647b");const M={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:.75,laserLineGlobalAlpha:.75,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5};var L;!function(e){e.Manipulators="manipulators",e.AnalysisViewDestroyed="analysis-view-destroyed",e.AnalysisView="analysis-view"}(L||(L={}));let D=class extends E["a"]{constructor(e){super(e),this.params=M,this.analysisViewData=null,this.cursorPoint=null,this._visible=!1,this._laserLine=null,this.laserLineEnabled=!0,this._handles=new m["a"],this._lastDraggedHandle=null}initialize(){this._laserLine=new R["a"]({view:this.view,attached:!0}),this._updateVisibility(this._visible),this._connectToAnalysisView()}destroy(){this._handles=Object(u["d"])(this._handles),this._laserLine=Object(u["d"])(this._laserLine)}get visible(){return this._visible}set visible(e){e?this.show():this.hide()}get testData(){const e=this._laserLine.testData,t=this.analysisViewData.testData;return{labels:null==t?void 0:t.labels,stripeLength:null==t?void 0:t.stripeLength,laserLineRenderer:{heightManifoldEnabled:!!Object(u["k"])(e)&&e.heightManifoldEnabled,heightManifoldTarget:Object(u["k"])(e)?e.heightManifoldTarget:null,pointDistanceEnabled:!!Object(u["k"])(e)&&e.pointDistanceEnabled,pointDistanceOrigin:Object(u["k"])(e)?e.pointDistanceOrigin:null,pointDistanceTarget:Object(u["k"])(e)?e.pointDistanceTarget:null,lineVerticalPlaneEnabled:!!Object(u["k"])(e)&&e.lineVerticalPlaneEnabled}}}get _cursorPosition(){const e=Object(T["f"])();return Object(u["b"])(this.cursorPoint,t=>this.view.renderCoordsHelper.toRenderCoords(t,e)),e}get _startPosition(){const e=Object(T["f"])();return Object(u["b"])(this.analysis.startPoint,t=>this.view.renderCoordsHelper.toRenderCoords(t,e)),e}get _endPosition(){const e=Object(T["f"])();return Object(u["b"])(this.analysis.endPoint,t=>this.view.renderCoordsHelper.toRenderCoords(t,e)),e}get _laserLineParams(){const e=this._focusPosition,{active:t,lineState:i}=this.toolState,n=this.analysisViewData,r=this.laserLineEnabled&&!!e&&"measured"!==i&&t;if(!r||!this.visible||Object(u["j"])(n)||n.destroyed)return{heightManifoldTarget:null,pointDistanceLine:null,lineVerticalPlaneSegment:null};const s=n.actualVisualizedMeasurement,a="local"!==this.view.viewingMode&&r&&!!this.analysis.startPoint&&"geodesic"===s,o=r&&n.viewMode===p.Triangle;return{heightManifoldTarget:"euclidean"===s?e:null,pointDistanceLine:a?this._pointDistanceLine:null,lineVerticalPlaneSegment:o?Object(S["f"])(this._startPosition,this._endPosition):null}}get _focusPosition(){const{lineState:e}=this.toolState,t=this.analysisViewData,i=Object(u["k"])(t)&&!t.destroyed&&t.measurementMode===O.Euclidean&&t.viewMode===p.Direct;switch(e){case"drawing":return i?this._startPosition:this.analysis.endPoint?this._endPosition:this._startPosition;case"editing":return i?"start"===this._lastDraggedHandle?this._endPosition:this._startPosition:"start"===this._lastDraggedHandle?this._startPosition:this._endPosition;default:return Object(u["k"])(this.cursorPoint)?this._cursorPosition:null}}get _pointDistanceLine(){return{origin:"drawing"===this.toolState.lineState||"end"===this._lastDraggedHandle?this._startPosition:this._endPosition,target:this._focusPosition}}createManipulators(){const e=()=>{const e=Object(x["e"])(this.view,this.params.handleColor,this.params.handleOpacity);return e.available=!1,e.radius=this.params.handleRadius,e},t=e(),i=e();Object(u["k"])(this.analysis.startPoint)&&(t.location=this.analysis.startPoint,t.available=!0),Object(u["k"])(this.analysis.endPoint)&&(i.location=this.analysis.endPoint,i.available=!0);const n=()=>{let e=this._lastDraggedHandle;t.grabbing&&!i.grabbing&&(e="start"),i.grabbing&&!t.grabbing&&(e="end"),t.grabbing||i.grabbing||(e=null),this._lastDraggedHandle=e},r=t.events.on("grab-changed",n),s=i.events.on("grab-changed",n);return this._handles.add([r,s],L.Manipulators),{start:t,end:i}}show(){this.destroyed||this._visible||this._updateVisibility(!0)}hide(){!this.destroyed&&this._visible&&this._updateVisibility(!1)}_connectToAnalysisView(){this._handles.remove(L.AnalysisView),this._handles.add([Object(v["f"])(()=>Object(u["b"])(this.analysisViewData,e=>e.destroyed),e=>{e&&this._handles.remove(L.AnalysisView)},v["a"]),Object(v["f"])(()=>["measured"===this.toolState.lineState,this.analysisViewData],([e,t])=>{Object(u["k"])(t)&&!t.destroyed&&(t.allowVisualElementsOrientationChange=!e)},v["a"]),Object(v["f"])(()=>this._laserLineParams,e=>{const t=this._laserLine;t.heightManifoldTarget=e.heightManifoldTarget,t.pointDistanceLine=e.pointDistanceLine,t.lineVerticalPlaneSegment=e.lineVerticalPlaneSegment},v["a"])],L.AnalysisView)}_updateVisibility(e){this.constructed&&(this._visible=e,e?this._laserLine.style={innerColor:this.params.laserLineInnerColor,innerWidth:this.params.laserLineInnerWidth,glowColor:this.params.laserLineGlowColor,glowWidth:this.params.laserLineGlowWidth,glowFalloff:this.params.laserLineGlowFalloff,globalAlpha:this.params.laserLineGlobalAlpha}:this.view.cursor=null,this._laserLine.visible=e)}};Object(n["a"])([Object(o["b"])()],D.prototype,"view",void 0),Object(n["a"])([Object(o["b"])()],D.prototype,"params",void 0),Object(n["a"])([Object(o["b"])({constructOnly:!0})],D.prototype,"analysis",void 0),Object(n["a"])([Object(o["b"])({constructOnly:!0})],D.prototype,"analysisViewData",void 0),Object(n["a"])([Object(o["b"])()],D.prototype,"cursorPoint",void 0),Object(n["a"])([Object(o["b"])()],D.prototype,"toolState",void 0),Object(n["a"])([Object(o["b"])()],D.prototype,"visible",null),Object(n["a"])([Object(o["b"])()],D.prototype,"testData",null),Object(n["a"])([Object(o["b"])()],D.prototype,"_visible",void 0),Object(n["a"])([Object(o["b"])()],D.prototype,"_laserLine",void 0),Object(n["a"])([Object(o["b"])()],D.prototype,"laserLineEnabled",void 0),Object(n["a"])([Object(o["b"])()],D.prototype,"_cursorPosition",null),Object(n["a"])([Object(o["b"])()],D.prototype,"_startPosition",null),Object(n["a"])([Object(o["b"])()],D.prototype,"_endPosition",null),Object(n["a"])([Object(o["b"])()],D.prototype,"_lastDraggedHandle",void 0),Object(n["a"])([Object(o["b"])()],D.prototype,"_laserLineParams",null),Object(n["a"])([Object(o["b"])()],D.prototype,"_focusPosition",null),Object(n["a"])([Object(o["b"])()],D.prototype,"_pointDistanceLine",null),D=Object(n["a"])([Object(c["a"])("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DView")],D);var I=i("413d"),N=i("0cb9"),V=i("9250"),C=i("1942"),F=i("ad29"),U=i("c20d"),k=i("412f");let B=class extends F["a"]{constructor(e){super(e),this._handles=new m["a"],this._cachedPickRequest=null,this._isAnyPointerDown=!1,this.lineState="initial",this.analysisViewData=null,this.startPointSurfaceLocation=null,this.endPointSurfaceLocation=null,this.startManipulator=null,this.endManipulator=null}initialize(){const{view:e,analysis:t,analysisViewData:i,cursorPoint:n,visible:r}=this;this.measurementView=new D({toolState:this,view:e,analysis:t,analysisViewData:i,cursorPoint:n,visible:r}),this._intersector=Object(V["a"])(this.view.state.viewingMode),this._intersector.options.store=C["c"].MIN;const{start:s,end:a}=this.measurementView.createManipulators(),o=(e,t,i)=>Object(U["e"])(e,(e,n,r)=>{const s=Object(P["c"])(e);n.next(s).next(Object(P["d"])(this.view)).next(e=>"start"!==e.action?e:null).next(n=>{const r=Object(w["a"])(n.mapEnd,new b["a"]);this.analysis[t]=r,e.location=r,this[i]=this._surfaceLocation(r,n.surfaceType)}),r.next(s).next(Object(U["k"])(this.analysis,[t])).next(Object(U["k"])(this,[i])).next(()=>{e.location=Object(u["r"])(this.analysis[t])})}),c=e=>e.events.on("grab-changed",()=>{const e=s.grabbing||a.grabbing;this.lineState=e?"editing":"measured"});this._handles.add([o(s,"startPoint","startPointSurfaceLocation"),o(a,"endPoint","endPointSurfaceLocation"),c(s),c(a)]),this.manipulators.add(s),this.manipulators.add(a),this.startManipulator=s,this.endManipulator=a,this._handles.add(Object(v["f"])(()=>this.state,e=>{"measured"===e&&this.finishToolCreation()},v["e"]))}destroy(){this.measurementView=Object(u["d"])(this.measurementView),this._handles=Object(u["d"])(this._handles)}get state(){return Object(u["j"])(this.analysis.startPoint)&&Object(u["j"])(this.analysis.endPoint)?"ready":this.validMeasurement&&"editing"!==this.lineState&&"drawing"!==this.lineState?"measured":"measuring"}get cursor(){return"ready"===this.state||"drawing"===this.lineState?"crosshair":null}set cursorPoint(e){this._set("cursorPoint",e),this.measurementView.cursorPoint=e}get validMeasurement(){return Object(u["k"])(this.analysis.startPoint)&&Object(u["k"])(this.analysis.endPoint)}onShow(){this.measurementView.show(),this._updateManipulatorAvailability()}onHide(){this.measurementView.hide()}onInputEvent(e){switch(e.type){case"immediate-click":this._handleImmediateClick(e);break;case"pointer-move":this._handlePointerMove(e);break;case"pointer-down":this._handlePointerDown();break;case"pointer-up":this._handlePointerUp()}this._updateManipulatorAvailability()}_handlePointerMove(e){this._clearCachedPickRequest();const t=Object(k["a"])(e);"mouse"===e.pointerType&&(this._hoverAt(t),"drawing"===this.lineState&&(this.endManipulator.events.emit("drag",{action:"update",start:t,screenPoint:t}),e.stopPropagation()))}_handlePointerDown(){this._isAnyPointerDown=!0}_handlePointerUp(){this._isAnyPointerDown=!1}_handleImmediateClick(e){if(this._clearCachedPickRequest(),!Object(A["a"])(e))return;const t=Object(k["a"])(e),i=e.pointerType;let n=!1;if(this.active)switch(this.lineState){case"initial":this.startManipulator.events.emit("drag",{action:"start",pointerType:i,start:t,screenPoint:t}),this.startManipulator.events.emit("drag",{action:"end",start:t,screenPoint:t}),Object(u["k"])(this.analysis.startPoint)&&(this.startManipulator.interactive=!1,this.endManipulator.interactive=!1,this.lineState="drawing",this.endManipulator.events.emit("drag",{action:"start",pointerType:i,start:t,screenPoint:t}),n=!0);break;case"drawing":this.endManipulator.events.emit("drag",{action:"update",start:t,screenPoint:t}),Object(u["k"])(this.analysis.endPoint)&&(this.endManipulator.events.emit("drag",{action:"end",start:t,screenPoint:t}),this.startManipulator.interactive=!0,this.endManipulator.interactive=!0,this.lineState="measured",n=!0)}n&&e.stopPropagation(),"mouse"===e.pointerType&&this._hoverAt(t)}_hoverAt(e){const t=this._isAnyPointerDown&&"drawing"!==this.lineState&&"editing"!==this.lineState;if((Object(u["j"])(this.analysis.startPoint)||Object(u["j"])(this.analysis.endPoint))&&this.active&&!t){const t=this._pick(e);Object(u["k"])(t)&&(this.cursorPoint=t)}else this.cursorPoint=null}_pick(e){if(Object(u["k"])(this._cachedPickRequest)&&Object(u["k"])(this._cachedPickRequest.result)){const t=this._cachedPickRequest.screenPoint;if(t.x===e.x&&t.y===e.y)return this._cachedPickRequest.result.mapPoint}else this._cachedPickRequest=new I["a"](e);const t=Object(y["i"])(e);this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(t,this._intersector);const i=this._intersector.results.min,n=z;if(!i.getIntersectionPoint(n))return null;const r=this.view.renderCoordsHelper.fromRenderCoords(n,this.view.spatialReference);return this._cachedPickRequest.result=new I["b"](n,r),r}_clearCachedPickRequest(){this._cachedPickRequest=null}_surfaceLocation(e,t){return t===P["a"].GROUND?"on-the-surface":e.z>=this._getElevation(e)?"above-the-surface":"below-the-surface"}_updateManipulatorAvailability(){this.startManipulator.available=Object(u["k"])(this.analysis.startPoint),this.endManipulator.available=Object(u["k"])(this.analysis.endPoint)}_getElevation(e){return this.view.basemapTerrain.ready?Object(u["s"])(Object(N["b"])(this.view.elevationProvider,e),0):0}};Object(n["a"])([Object(o["b"])({readOnly:!0})],B.prototype,"state",null),Object(n["a"])([Object(o["b"])()],B.prototype,"lineState",void 0),Object(n["a"])([Object(o["b"])({readOnly:!0})],B.prototype,"cursor",null),Object(n["a"])([Object(o["b"])()],B.prototype,"cursorPoint",null),Object(n["a"])([Object(o["b"])({constructOnly:!0})],B.prototype,"analysis",void 0),Object(n["a"])([Object(o["b"])({constructOnly:!0})],B.prototype,"analysisViewData",void 0),Object(n["a"])([Object(o["b"])()],B.prototype,"measurementView",void 0),Object(n["a"])([Object(o["b"])({constructOnly:!0})],B.prototype,"view",void 0),Object(n["a"])([Object(o["b"])({readOnly:!0})],B.prototype,"validMeasurement",null),Object(n["a"])([Object(o["b"])({value:null})],B.prototype,"startPointSurfaceLocation",void 0),Object(n["a"])([Object(o["b"])({value:null})],B.prototype,"endPointSurfaceLocation",void 0),B=Object(n["a"])([Object(c["a"])("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DTool")],B);const z=Object(T["f"])(),G=B;var H=i("dc25");let q=class extends H["a"]{constructor(e){super(e),this.analysis=null,this.supportedViewType="3d",this.unsupportedErrorMessage="DirectLineMeasurement3DViewModel is only supported in 3D views.",this._userUnit=null,this._userUnitOptions=null}get state(){return this.disabled||!this.ready?"disabled":Object(u["j"])(this.tool)?"ready":this.tool.state}get measurement(){if(Object(u["j"])(this.tool))return null;const e={mode:"euclidean",directDistance:{text:null,state:"unavailable"},horizontalDistance:{text:null,state:"unavailable"},verticalDistance:{text:null,state:"unavailable"}},{analysisViewData:t}=this.tool;if(Object(u["j"])(t))return e;const i=t.actualVisualizedMeasurement,n=Object(u["k"])(t.result)?"available":"unavailable";switch(i){case"euclidean":return{mode:"euclidean",directDistance:{text:t.directLabelText,state:n},horizontalDistance:{text:t.horizontalLabelText,state:n},verticalDistance:{text:t.verticalLabelText,state:n}};case"geodesic":return{mode:"geodesic",directDistance:{text:null,state:"unavailable"},horizontalDistance:{text:t.horizontalLabelText,state:n},verticalDistance:{text:t.verticalLabelText,state:n}};default:return e}}set unitOptions(e){this._userUnitOptions=e,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}get unitOptions(){return this._filteredOrAllUnits(this._userUnitOptions)}set unit(e){this._userUnit=e?this._findSelectableUnit(e,this._userUnit):null,this.analysis.unit=e}get unit(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)}constructAnalysis(){return new _}constructTool(){return new G({view:Object(u["r"])(this.view),analysis:this.analysis,analysisViewData:Object(u["r"])(this.analysisView),visible:this.visible})}_findSelectableUnit(e,t){const i=this.unitOptions;return i.includes(e)?e:t?this._findSelectableUnit(t):i[0]}_filteredOrAllUnits(e){if(!e)return s["q"].slice();const t=e.filter(e=>s["q"].includes(e));return 0===t.length?s["q"].slice():t}};Object(n["a"])([Object(o["b"])({type:_})],q.prototype,"analysis",void 0),Object(n["a"])([Object(o["b"])({readOnly:!0})],q.prototype,"state",null),Object(n["a"])([Object(o["b"])({readOnly:!0})],q.prototype,"measurement",null),Object(n["a"])([Object(o["b"])()],q.prototype,"unitOptions",null),Object(n["a"])([Object(o["b"])()],q.prototype,"unit",null),Object(n["a"])([Object(o["b"])(j["a"])],q.prototype,"defaultUnit",void 0),Object(n["a"])([Object(o["b"])()],q.prototype,"_userUnit",void 0),Object(n["a"])([Object(o["b"])()],q.prototype,"_userUnitOptions",void 0),q=Object(n["a"])([Object(c["a"])("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel")],q);const W=q;var $=i("8750"),X=i("755e"),Y=i("d822");i("702a");const K="esri-direct-line-measurement-3d",Z={buttonDisabled:"esri-button--disabled",base:K+" esri-widget esri-widget--panel",container:K+"__container",hint:K+"__hint",hintText:K+"__hint-text",panelError:K+"__panel--error",measurement:K+"__measurement",measurementItem:K+"__measurement-item",measurementItemDisabled:K+"__measurement-item--disabled",measurementItemTitle:K+"__measurement-item-title",measurementItemValue:K+"__measurement-item-value",settings:K+"__settings",units:K+"__units",unitsLabel:K+"__units-label",unitsSelect:K+"__units-select esri-select",unitsSelectWrapper:K+"__units-select-wrapper",actionSection:K+"__actions",newMeasurementButton:K+"__clear-button esri-button esri-button--primary",widgetIcon:"esri-icon-measure-line"};let Q=class extends l["a"]{constructor(e,t){super(e,t),this.view=null,this.visible=null,this.iconClass=Z.widgetIcon,this.label=void 0,this.messages=null,this.messagesUnits=null,this.viewModel=new W,this.unitOptions=null,this.unit=null}get analysis(){return this.viewModel.analysis}set analysis(e){this.viewModel.analysis=e}render(){const{supported:e,active:t,state:i,measurement:n,unit:r}=this.viewModel,a="disabled"===i,o="ready"===i,c="measuring"===i||"measured"===i,{messages:l,messagesUnits:h}=this,u=t&&o?Object(Y["a"])("section",{key:"esri-direct-line-measurement-3d__hint",class:Z.hint},Object(Y["a"])("p",{class:Z.hintText},l.hint)):null,d=e?null:Object(Y["a"])("section",{key:"esri-direct-line-measurement-3d__unsupported",class:Z.panelError},Object(Y["a"])("p",null,l.unsupported)),b=(e,t,i)=>{switch(t.state){case"available":return Object(Y["a"])("div",{key:i+"-enabled",class:Z.measurementItem},Object(Y["a"])("span",{class:Z.measurementItemTitle},e),Object(Y["a"])("span",{class:Z.measurementItemValue},t.text));case"unavailable":return Object(Y["a"])("div",{key:i+"-disabled",class:this.classes(Z.measurementItem,Z.measurementItemDisabled)},Object(Y["a"])("span",{class:Z.measurementItemTitle},e))}},f=c?Object(Y["a"])("section",{key:"esri-direct-line-measurement-3d__measurement",class:Z.measurement},b(l.direct,n.directDistance,"direct"),b(l.horizontal,n.horizontalDistance,"horizontal"),b(l.vertical,n.verticalDistance,"vertical")):null,_=this.id+"__units",O=Object(Y["a"])("label",{class:Z.unitsLabel,for:_},l.unit),p=Object(Y["a"])("div",{class:Z.unitsSelectWrapper},Object(Y["a"])("select",{class:Z.unitsSelect,id:_,onchange:this._changeUnit,bind:this,value:r},this.viewModel.unitOptions.map(e=>{var t;return Object(Y["a"])("option",{key:e,value:e},Object(s["l"])(e)?h.systems[e]:null==(t=h.units[e])?void 0:t.pluralCapitalized)}))),g=Object(Y["a"])("section",{key:"esri-direct-line-measurement-3d__units",class:Z.units},O,p),j=c?Object(Y["a"])("div",{key:"settings",class:Z.settings},g):null,m=!e||t&&!c?null:Object(Y["a"])("div",{class:Z.actionSection},Object(Y["a"])("button",{disabled:a,class:this.classes(Z.newMeasurementButton,a&&Z.buttonDisabled),bind:this,onclick:this._newMeasurement,type:"button"},l.newMeasurement)),v=this.visible?Object(Y["a"])("div",{class:Z.container},d,u,j,f,m):null;return Object(Y["a"])("div",{key:this,class:Z.base,role:"presentation"},v)}_newMeasurement(){Object(r["i"])(this.viewModel.start())}_changeUnit(e){const t=e.target,i=t.options[t.selectedIndex];i&&(this.unit=i.value)}};Object(n["a"])([Object(a["a"])("viewModel.view")],Q.prototype,"view",void 0),Object(n["a"])([Object(a["a"])("viewModel.visible")],Q.prototype,"visible",void 0),Object(n["a"])([Object(a["a"])("viewModel.active")],Q.prototype,"active",void 0),Object(n["a"])([Object(o["b"])({constructOnly:!0,nonNullable:!0})],Q.prototype,"analysis",null),Object(n["a"])([Object(o["b"])()],Q.prototype,"iconClass",void 0),Object(n["a"])([Object(o["b"])({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Q.prototype,"label",void 0),Object(n["a"])([Object(o["b"])(),Object(X["a"])("esri/widgets/DirectLineMeasurement3D/t9n/DirectLineMeasurement3D")],Q.prototype,"messages",void 0),Object(n["a"])([Object(o["b"])(),Object(X["a"])("esri/core/t9n/Units")],Q.prototype,"messagesUnits",void 0),Object(n["a"])([Object(o["b"])()],Q.prototype,"uiStrings",void 0),Object(n["a"])([Object(o["b"])({type:W})],Q.prototype,"viewModel",void 0),Object(n["a"])([Object(a["a"])("viewModel.unitOptions")],Q.prototype,"unitOptions",void 0),Object(n["a"])([Object(a["a"])("viewModel.unit")],Q.prototype,"unit",void 0),Object(n["a"])([Object($["a"])()],Q.prototype,"_newMeasurement",null),Object(n["a"])([Object($["a"])()],Q.prototype,"_changeUnit",null),Q=Object(n["a"])([Object(c["a"])("esri.widgets.DirectLineMeasurement3D")],Q);const J=Q},d272:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("b2b2"),r=i("d791"),s=i("afe1"),a=i("e431"),o=i("0b2d"),c=i("35f0"),l=(i("ea32"),i("3886"));l["a"];function h(e,t){u(e,t,[new c["a"]("slicePlaneOrigin",(e,i)=>_(t,e,i)),new c["a"]("slicePlaneBasis1",(e,i)=>{var r;return O(t,e,i,null==(r=Object(n["r"])(i.slicePlane))?void 0:r.basis1)}),new c["a"]("slicePlaneBasis2",(e,i)=>{var r;return O(t,e,i,null==(r=Object(n["r"])(i.slicePlane))?void 0:r.basis2)})])}function u(e,t,i){if(!t.hasSlicePlane){const i=l["b"]`#define rejectBySlice(_pos_) false
#define discardBySlice(_pos_) {}
#define highlightSlice(_color_, _pos_) (_color_)`;return t.hasSliceInVertexProgram&&e.vertex.code.add(i),void e.fragment.code.add(i)}e.extensions.add("GL_OES_standard_derivatives"),t.hasSliceInVertexProgram&&e.vertex.uniforms.add(i),e.fragment.uniforms.add(i);const n=l["b"]`struct SliceFactors {
float front;
float side0;
float side1;
float side2;
float side3;
};
SliceFactors calculateSliceFactors(vec3 pos) {
vec3 rel = pos - slicePlaneOrigin;
vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);
float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);
float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);
float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);
float basis1Dot = dot(slicePlaneBasis1, rel);
float basis2Dot = dot(slicePlaneBasis2, rel);
return SliceFactors(
dot(slicePlaneNormal, pos) + slicePlaneW,
-basis1Dot - basis1Len2,
basis1Dot - basis1Len2,
-basis2Dot - basis2Len2,
basis2Dot - basis2Len2
);
}
bool sliceByFactors(SliceFactors factors) {
return factors.front < 0.0
&& factors.side0 < 0.0
&& factors.side1 < 0.0
&& factors.side2 < 0.0
&& factors.side3 < 0.0;
}
bool sliceEnabled() {
return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;
}
bool sliceByPlane(vec3 pos) {
return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));
}
#define rejectBySlice(_pos_) sliceByPlane(_pos_)
#define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }`,r=l["b"]`vec4 applySliceHighlight(vec4 color, vec3 pos) {
SliceFactors factors = calculateSliceFactors(pos);
const float HIGHLIGHT_WIDTH = 1.0;
const vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);
factors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);
factors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);
factors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);
factors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);
factors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);
if (sliceByFactors(factors)) {
return color;
}
float highlightFactor = (1.0 - step(0.5, factors.front))
* (1.0 - step(0.5, factors.side0))
* (1.0 - step(0.5, factors.side1))
* (1.0 - step(0.5, factors.side2))
* (1.0 - step(0.5, factors.side3));
return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);
}`,s=t.hasSliceHighlight?l["b"]`
        ${r}
        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))
      `:l["b"]`#define highlightSlice(_color_, _pos_) (_color_)`;t.hasSliceInVertexProgram&&e.vertex.code.add(n),e.fragment.code.add(n),e.fragment.code.add(s)}function d(e,t,i){return e.instancedDoublePrecision?Object(a["w"])(p,i.camera.viewInverseTransposeMatrix[3],i.camera.viewInverseTransposeMatrix[7],i.camera.viewInverseTransposeMatrix[11]):t.slicePlaneLocalOrigin}function b(e,t){return Object(n["k"])(e)?Object(a["f"])(g,t.origin,e):t.origin}function f(e,t,i){return e.hasSliceTranslatedView?Object(n["k"])(t)?Object(r["j"])(m,i.camera.viewMatrix,t):i.camera.viewMatrix:null}function _(e,t,i){if(Object(n["j"])(i.slicePlane))return o["c"];const r=d(e,t,i),s=b(r,i.slicePlane),c=f(e,r,i);return Object(n["k"])(c)?Object(a["q"])(g,s,c):s}function O(e,t,i,r){if(Object(n["j"])(r)||Object(n["j"])(i.slicePlane))return o["c"];const s=d(e,t,i),c=b(s,i.slicePlane),l=f(e,s,i);return Object(n["k"])(l)?(Object(a["e"])(j,r,c),Object(a["q"])(g,c,l),Object(a["q"])(j,j,l),Object(a["f"])(j,j,g)):r}const p=Object(o["f"])(),g=Object(o["f"])(),j=Object(o["f"])(),m=Object(s["d"])()},d359:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return O})),i.d(t,"c",(function(){return f})),i.d(t,"d",(function(){return p})),i.d(t,"e",(function(){return m})),i.d(t,"f",(function(){return j}));var n,r,s=i("2119"),a=i("d791"),o=i("e431"),c=i("0b2d"),l=i("7577"),h=i("0fc4"),u=i("4f8b"),d=i("7289"),b=i("7361");function f(e){return e?[Object(d["d"])(e[0]),Object(d["d"])(e[1]),Object(d["d"])(e[2]),Object(d["d"])(e[3]),Object(d["d"])(e[4]),Object(d["d"])(e[5])]:[Object(d["d"])(),Object(d["d"])(),Object(d["d"])(),Object(d["d"])(),Object(d["d"])(),Object(d["d"])()]}function _(){return[Object(c["f"])(),Object(c["f"])(),Object(c["f"])(),Object(c["f"])(),Object(c["f"])(),Object(c["f"])(),Object(c["f"])(),Object(c["f"])()]}function O(e,t){for(let i=0;i<v.NUM;i++)Object(d["c"])(e[i],t[i])}function p(e,t,i,n=w){const r=Object(a["m"])(b["a"].get(),t,e);Object(a["a"])(r,r);for(let s=0;s<y.NUM;++s){const e=Object(l["m"])(b["e"].get(),T[s],r);Object(o["w"])(n[s],e[0]/e[3],e[1]/e[3],e[2]/e[3])}g(i,n)}function g(e,t){Object(d["f"])(t[r.FAR_BOTTOM_LEFT],t[r.NEAR_BOTTOM_LEFT],t[r.NEAR_TOP_LEFT],e[n.LEFT]),Object(d["f"])(t[r.NEAR_BOTTOM_RIGHT],t[r.FAR_BOTTOM_RIGHT],t[r.FAR_TOP_RIGHT],e[n.RIGHT]),Object(d["f"])(t[r.FAR_BOTTOM_LEFT],t[r.FAR_BOTTOM_RIGHT],t[r.NEAR_BOTTOM_RIGHT],e[n.BOTTOM]),Object(d["f"])(t[r.NEAR_TOP_LEFT],t[r.NEAR_TOP_RIGHT],t[r.FAR_TOP_RIGHT],e[n.TOP]),Object(d["f"])(t[r.NEAR_BOTTOM_LEFT],t[r.NEAR_BOTTOM_RIGHT],t[r.NEAR_TOP_RIGHT],e[n.NEAR]),Object(d["f"])(t[r.FAR_BOTTOM_RIGHT],t[r.FAR_BOTTOM_LEFT],t[r.FAR_TOP_LEFT],e[n.FAR])}function j(e,t){for(let i=0;i<v.NUM;i++){const n=e[i];if(n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]>=t[3])return!1}return!0}function m(e,t){for(let i=0;i<v.NUM;i++){const n=e[i];if(!Object(d["b"])(n,t))return!1}return!0}!function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.BOTTOM=2]="BOTTOM",e[e.TOP=3]="TOP",e[e.NEAR=4]="NEAR",e[e.FAR=5]="FAR"}(n||(n={})),function(e){e[e.NEAR_BOTTOM_LEFT=0]="NEAR_BOTTOM_LEFT",e[e.NEAR_BOTTOM_RIGHT=1]="NEAR_BOTTOM_RIGHT",e[e.NEAR_TOP_RIGHT=2]="NEAR_TOP_RIGHT",e[e.NEAR_TOP_LEFT=3]="NEAR_TOP_LEFT",e[e.FAR_BOTTOM_LEFT=4]="FAR_BOTTOM_LEFT",e[e.FAR_BOTTOM_RIGHT=5]="FAR_BOTTOM_RIGHT",e[e.FAR_TOP_RIGHT=6]="FAR_TOP_RIGHT",e[e.FAR_TOP_LEFT=7]="FAR_TOP_LEFT"}(r||(r={}));r.FAR_BOTTOM_RIGHT,r.NEAR_BOTTOM_RIGHT,r.NEAR_BOTTOM_LEFT,r.FAR_BOTTOM_LEFT,r.NEAR_BOTTOM_LEFT,r.NEAR_BOTTOM_RIGHT,r.NEAR_TOP_RIGHT,r.NEAR_TOP_LEFT,r.FAR_BOTTOM_RIGHT,r.FAR_BOTTOM_LEFT,r.FAR_TOP_LEFT,r.FAR_TOP_RIGHT,r.NEAR_BOTTOM_RIGHT,r.FAR_BOTTOM_RIGHT,r.FAR_TOP_RIGHT,r.NEAR_TOP_RIGHT,r.FAR_BOTTOM_LEFT,r.NEAR_BOTTOM_LEFT,r.NEAR_TOP_LEFT,r.FAR_TOP_LEFT,r.FAR_TOP_LEFT,r.NEAR_TOP_LEFT,r.NEAR_TOP_RIGHT,r.FAR_TOP_RIGHT;var v,y;!function(e){e[e.NUM=6]="NUM"}(v||(v={})),function(e){e[e.NUM=8]="NUM"}(y||(y={}));const T=[Object(h["g"])(-1,-1,-1,1),Object(h["g"])(1,-1,-1,1),Object(h["g"])(1,1,-1,1),Object(h["g"])(-1,1,-1,1),Object(h["g"])(-1,-1,1,1),Object(h["g"])(1,-1,1,1),Object(h["g"])(1,1,1,1),Object(h["g"])(-1,1,1,1)],w=(new s["a"](u["a"]),_())},d36e:function(e,t,i){"use strict";i.d(t,"a",(function(){return P}));var n=i("0fc4"),r=i("a05b"),s=i("b7c2"),a=i("d7f7"),o=i("b061"),c=i("35b3"),l=i("7438"),h=i("badc"),u=i("8675"),d=i("7c51"),b=i("c3a4"),f=i("ca98"),_=i("fa1e"),O=i("c829"),p=i("87b7"),g=i("1962"),j=i("189c");class m extends f["a"]{initializeProgram(e){const t=m.shader.get().build(this.configuration);return new O["a"](e.rctx,t,_["a"])}_createPipeline(e,t){const i=this.configuration,n=e===s["i"].NONE,a=e===s["i"].FrontFace;return Object(j["f"])({blending:i.output!==r["a"].Color&&i.output!==r["a"].Alpha||!i.transparent?null:n?l["d"]:Object(l["f"])(e),culling:Object(j["b"])(i.cullFace),depthTest:{func:Object(l["g"])(e)},depthWrite:n||a?i.writeDepth&&j["d"]:null,colorWrite:j["c"],stencilWrite:i.hasOccludees?p["h"]:null,stencilTest:i.hasOccludees?t?p["d"]:p["c"]:null,polygonOffset:n||a?i.polygonOffset&&v:Object(l["e"])(i.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._createPipeline(this.configuration.transparencyPassType,!0),this._createPipeline(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}}m.shader=new b["a"](g["a"],()=>i.e("chunk-2d0de726").then(i.bind(null,"864f")));const v={factor:1,units:1};var y=i("a4ee"),T=i("da35"),w=i("6d35");class A extends w["a"]{constructor(){super(...arguments),this.output=r["a"].Color,this.cullFace=s["b"].None,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.transparent=!1,this.polygonOffset=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=s["i"].NONE,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}Object(y["a"])([Object(T["b"])({count:r["a"].COUNT})],A.prototype,"output",void 0),Object(y["a"])([Object(T["b"])({count:s["b"].COUNT})],A.prototype,"cullFace",void 0),Object(y["a"])([Object(T["b"])()],A.prototype,"hasSlicePlane",void 0),Object(y["a"])([Object(T["b"])()],A.prototype,"hasVertexColors",void 0),Object(y["a"])([Object(T["b"])()],A.prototype,"transparent",void 0),Object(y["a"])([Object(T["b"])()],A.prototype,"polygonOffset",void 0),Object(y["a"])([Object(T["b"])()],A.prototype,"enableOffset",void 0),Object(y["a"])([Object(T["b"])()],A.prototype,"writeDepth",void 0),Object(y["a"])([Object(T["b"])()],A.prototype,"hasOccludees",void 0),Object(y["a"])([Object(T["b"])({count:s["i"].COUNT})],A.prototype,"transparencyPassType",void 0),Object(y["a"])([Object(T["b"])()],A.prototype,"hasMultipassTerrain",void 0),Object(y["a"])([Object(T["b"])()],A.prototype,"cullAboveGround",void 0);class P extends c["a"]{constructor(e){super(e,new S),this.supportsEdges=!0,this._configuration=new A}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<l["b"],this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,t,i,n,r,s,a){Object(d["e"])(e,t,n,r,s,void 0,a)}requiresSlot(e,t){return e===h["a"].DRAPED_MATERIAL||(Object(o["b"])(t)===r["a"].Highlight?e===h["a"].OPAQUE_MATERIAL:e===(this.parameters.transparent?this.parameters.writeDepth?h["a"].TRANSPARENT_MATERIAL:h["a"].TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:h["a"].OPAQUE_MATERIAL))}createGLMaterial(e){return e.output===r["a"].Color||e.output===r["a"].Alpha||e.output===r["a"].Highlight||e.output===r["a"].Depth&&this.parameters.writeLinearDepth?new E(e):null}createBufferWriter(){return new u["a"](u["b"])}}class E extends a["a"]{_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){return this._output!==r["a"].Color&&this._output!==r["a"].Alpha||this._updateOccludeeState(e),this.ensureTechnique(m,e)}}class S extends c["b"]{constructor(){super(...arguments),this.color=n["b"],this.transparent=!1,this.writeDepth=!0,this.writeLinearDepth=!1,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=s["b"].None,this.hasOccludees=!1}}},d3cf:function(e,t,i){"use strict";i.d(t,"a",(function(){return j})),i.d(t,"b",(function(){return b})),i.d(t,"c",(function(){return d})),i.d(t,"d",(function(){return l}));var n=i("8d60"),r=(i("c120"),i("7ffa")),s=i("b2b2"),a=i("a21b"),o=i("a9ab"),c=i("1a54");function l(e){return"declaredClass"in e}function h(e){return"declaredClass"in e}function u(e){return"declaredClass"in e}function d(e,t){if(!e)return null;if(u(e))return e;const i=new n["a"]({layer:t,sourceLayer:t});return i.visible=e.visible,i.symbol=Object(r["a"])(e.symbol),i.attributes=Object(r["a"])(e.attributes),i.geometry=b(e.geometry),i}function b(e){return Object(s["j"])(e)?null:l(e)?e:Object(o["a"])(f(e))}function f(e){const t=e.spatialReference.toJSON();switch(e.type){case"point":{const{x:i,y:n,z:r,m:s}=e;return{x:i,y:n,z:r,m:s,spatialReference:t}}case"polygon":{const{rings:i,hasZ:n,hasM:r}=e;return{rings:_(i),hasZ:n,hasM:r,spatialReference:t}}case"polyline":{const{paths:i,hasZ:n,hasM:r}=e;return{paths:_(i),hasZ:n,hasM:r,spatialReference:t}}case"extent":{const{xmin:i,xmax:n,ymin:r,ymax:s,zmin:a,zmax:o,mmin:c,mmax:l,hasZ:h,hasM:u}=e;return{xmin:i,xmax:n,ymin:r,ymax:s,zmin:a,zmax:o,mmin:c,mmax:l,hasZ:h,hasM:u,spatialReference:t}}case"multipoint":{const{points:i,hasZ:n,hasM:r}=e;return{points:g(i)?O(i):i,hasZ:n,hasM:r,spatialReference:t}}default:return}}function _(e){return p(e)?e.map(e=>O(e)):e}function O(e){return e.map(e=>Object(a["n"])(e))}function p(e){for(const t of e)if(0!==t.length)return g(t);return!1}function g(e){return e.length&&(Object(a["d"])(e[0])||Object(a["e"])(e[0]))}function j(e,t){if(!e)return null;let i;if(h(e)){if(null==t)return e.clone();if(h(t))return t.copy(e)}return null!=t?(i=t,i.x=e.x,i.y=e.y,i.spatialReference=e.spatialReference,e.hasZ?(i.z=e.z,i.hasZ=e.hasZ):(i.z=null,i.hasZ=!1),e.hasM?(i.m=e.m,i.hasM=!0):(i.m=null,i.hasM=!1)):(i=Object(c["g"])(e.x,e.y,e.z,e.spatialReference),e.hasM&&(i.m=e.m,i.hasM=!0)),i}},d5f7:function(e,t,i){"use strict";i.d(t,"a",(function(){return b})),i.d(t,"b",(function(){return d}));var n=i("fa1e"),r=i("b7bd"),s=i("d17d"),a=i("3f3e");new a["a"](r["a"].POSITION,3,s["k"].FLOAT,0,12),new a["a"](r["a"].POSITION,3,s["k"].FLOAT,0,20),new a["a"](r["a"].UV0,2,s["k"].FLOAT,12,20),new a["a"](r["a"].POSITION,3,s["k"].FLOAT,0,32),new a["a"](r["a"].NORMAL,3,s["k"].FLOAT,12,32),new a["a"](r["a"].UV0,2,s["k"].FLOAT,24,32),new a["a"](r["a"].POSITION,3,s["k"].FLOAT,0,16),new a["a"](r["a"].COLOR,4,s["k"].UNSIGNED_BYTE,12,16);const o=[new a["a"](r["a"].POSITION,2,s["k"].FLOAT,0,8)],c=[new a["a"](r["a"].POSITION,2,s["k"].FLOAT,0,16),new a["a"](r["a"].UV0,2,s["k"].FLOAT,8,16)];var l=i("7ce4"),h=i("a1ff"),u=i("0fa6");function d(e,t=o,i=n["a"],r=-1,a=1){let h=null;return h=t===c?new Float32Array([r,r,0,0,a,r,1,0,r,a,0,1,a,a,1,1]):new Float32Array([r,r,a,r,r,a,a,a]),new u["a"](e,i,{geometry:t},{geometry:l["a"].createVertex(e,s["D"].STATIC_DRAW,h)})}function b(e){return new h["a"](e,{target:s["A"].TEXTURE_2D,pixelFormat:s["p"].RGBA,dataType:s["q"].UNSIGNED_BYTE,samplingMode:s["z"].NEAREST,width:1,height:1},new Uint8Array([255,255,255,255]))}},d7f7:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("b7c2");class r{constructor(e){this._material=e.material,this._techniqueRepository=e.techniqueRep,this._output=e.output}dispose(){this._techniqueRepository.release(this._technique)}get technique(){return this._technique}ensureTechnique(e,t,i=this._output){return this._technique=this._techniqueRepository.releaseAndAcquire(e,this._material.getConfiguration(i,t),this._technique),this._technique}ensureResources(e){return n["g"].LOADED}}},d8a4:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("62ae"),r=i("52b2");class s extends n["a"]{constructor(e,t){super(e,"vec2",r["a"].Pass,(i,n,r)=>i.setUniform2fv(e,t(n,r)))}}},da1c:function(e,t,i){"use strict";i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return l})),i.d(t,"d",(function(){return u}));var n=i("38a4");i("3c9c");function r(e){return Math.abs(e*e*e)}function s(e,t,i){const n=i.parameters,s=i.paddingPixelsOverride;return d.scale=Math.min(n.divisor/(t-n.offset),1),d.factor=r(e),d.minPixelSize=n.minPixelSize,d.paddingPixels=s,d}function a(e,t){return 0===e?t.minPixelSize:t.minPixelSize*(1+2*t.paddingPixels/e)}function o(e,t){return Math.max(Object(n["l"])(e*t.scale,e,t.factor),a(e,t))}function c(e,t,i){const n=s(e,t,i);return n.minPixelSize=0,n.paddingPixels=0,o(1,n)}function l(e,t,i,n){n.scale=c(e,t,i),n.factor=0,n.minPixelSize=i.parameters.minPixelSize,n.paddingPixels=i.paddingPixelsOverride}function h(e,t,i=[0,0]){const n=Math.min(Math.max(t.scale,a(e[1],t)/Math.max(1e-5,e[1])),1);return i[0]=e[0]*n,i[1]=e[1]*n,i}function u(e,t,i,n){return o(e,s(t,i,n))}Object(n["g"])(10),Object(n["g"])(12),Object(n["g"])(70),Object(n["g"])(40);const d={scale:0,factor:0,minPixelSize:0,paddingPixels:0}},da35:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}));class n{constructor(){this._key="",this._keyDirty=!1,this._parameterBits=this._parameterBits?this._parameterBits.map(()=>0):[],this._parameterNames||(this._parameterNames=[])}get key(){return this._keyDirty&&(this._keyDirty=!1,this._key=String.fromCharCode.apply(String,this._parameterBits)),this._key}snapshot(){const e=this._parameterNames,t={key:this.key};for(const i of e)t[i]=this[i];return t}}function r(e={}){return(t,i)=>{var n;if(t._parameterNames=null!=(n=t._parameterNames)?n:[],t._parameterNames.push(i),null!=e.constValue)Object.defineProperty(t,i,{get:()=>e.constValue});else{var r;const n=t._parameterNames.length-1,s=e.count||2,a=Math.ceil(Math.log2(s)),o=null!=(r=t._parameterBits)?r:[0];let c=0;for(;o[c]+a>16;)c++,c>=o.length&&o.push(0);t._parameterBits=o;const l=o[c],h=(1<<a)-1<<l;o[c]+=a,Object.defineProperty(t,i,{get(){return this[n]},set(e){if(this[n]!==e&&(this[n]=e,this._keyDirty=!0,this._parameterBits[c]=this._parameterBits[c]&~h|+e<<l&h,"number"!=typeof e&&"boolean"!=typeof e))throw"Configuration value for "+i+" must be boolean or number, got "+typeof e}})}}}},dabc:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("a4ee"),r=i("fc29"),s=i("d3ac"),a=i("a5d8"),o=i("6a0e"),c=i("b2b2"),l=i("59b2"),h=(i("b50f"),i("c120"),i("cea0"),i("d386"));let u=0,d=class extends(Object(o["b"])(Object(s["b"])(Object(a["a"])(r["a"])))){constructor(e){super(e),this.id=`${Date.now().toString(16)}-analysis-${u++}`,this.title=null}get parent(){return this._get("parent")}set parent(e){const t=this.parent;if(Object(c["k"])(t))switch(t.type){case"line-of-sight":t.removeAnalysis(this);break;case"2d":case"3d":t.analyses.includes(this)&&t.analyses.remove(this)}this._set("parent",e)}get isEditable(){return this.requiredPropertiesForEditing.every(c["k"])}};Object(n["a"])([Object(l["b"])({type:String,constructOnly:!0,clonable:!1})],d.prototype,"id",void 0),Object(n["a"])([Object(l["b"])({type:String})],d.prototype,"title",void 0),Object(n["a"])([Object(l["b"])({constructOnly:!0})],d.prototype,"type",void 0),Object(n["a"])([Object(l["b"])({clonable:!1,value:null})],d.prototype,"parent",null),Object(n["a"])([Object(l["b"])({readOnly:!0})],d.prototype,"extent",void 0),Object(n["a"])([Object(l["b"])({readOnly:!0})],d.prototype,"isEditable",null),Object(n["a"])([Object(l["b"])({readOnly:!0})],d.prototype,"requiredPropertiesForEditing",void 0),Object(n["a"])([Object(l["b"])({readOnly:!0})],d.prototype,"nonEditableMessage",void 0),d=Object(n["a"])([Object(h["a"])("esri.analysis.Analysis")],d);const b=d},db7b:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("62ae");class r extends n["a"]{constructor(e){super(e,"vec4")}}},dc25:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n,r=i("a4ee"),s=i("af40"),a=i("b2b2"),o=i("f4cc"),c=i("477c"),l=i("59b2"),h=(i("b50f"),i("c120"),i("cea0"),i("d386")),u=i("7ea8");!function(e){e[e.PENDING=0]="PENDING",e[e.WAIT_FOR_VIEW_READY=1]="WAIT_FOR_VIEW_READY",e[e.RUNNING=2]="RUNNING"}(n||(n={}));let d=class extends u["a"]{constructor(e={}){super(e),this.analysisView=null,this._reconnectViewTask=null,this._analysisBaseHandles=new s["a"],this._parentChangeFromReconnect=!1,this._startUserOperation=null;const t=null==e?void 0:e.analysis;Object(a["k"])(t)?this.analysis=t:(this._set("analysis",this.constructAnalysis()),this._set("isAnalysisOwner",!0))}normalizeCtorArgs(e){const{analysis:t,...i}=e;return i}initialize(){this._analysisBaseHandles.add([Object(c["f"])(()=>Object(a["b"])(this.analysis,({parent:e})=>e),e=>{this._parentChangeFromReconnect||e===this.view||this._set("isAnalysisOwner",!1);const t=!this._parentChangeFromReconnect;this._parentChangeFromReconnect=!1,t&&this._scheduleViewReconnect()},c["d"]),Object(c["f"])(()=>({view:this.view,ready:Object(a["k"])(this.view)&&this.view.ready,supported:this.supported}),({view:e},{view:t})=>{e!==t&&(this._startUserOperation=Object(a["a"])(this._startUserOperation),this._disconnectFromView(t)),this._scheduleViewReconnect()},c["e"]),Object(c["f"])(()=>this.analysis.isEditable,(e,t)=>{Object(a["j"])(this.analysisView)||(e&&!t&&Object(a["j"])(this.tool)?this.createTool():!e&&t&&Object(a["k"])(this.tool)&&!this.tool.active&&this.removeTool())})])}destroy(){this._analysisBaseHandles=Object(a["d"])(this._analysisBaseHandles),this._reconnectViewTask=Object(a["a"])(this._reconnectViewTask),this._startUserOperation=Object(a["a"])(this._startUserOperation),Object(a["k"])(this.analysisView)&&(this.analysisView.visible=void 0),this._disconnectFromView(this.view),Object(a["k"])(this.analysis)&&this.isAnalysisOwner&&(this.analysis.destroy(),this._set("analysis",null))}set analysis(e){e!==this._get("analysis")&&(this._startUserOperation=Object(a["a"])(this._startUserOperation),this._disconnectFromView(this.view),this._setExternalAnalysis(e),this._scheduleViewReconnect())}get ready(){return Object(a["k"])(this.analysisView)&&!this.connectingToView}get connectingToView(){return Object(a["k"])(this._reconnectViewTask)}get isAnalysisOwner(){return this._get("isAnalysisOwner")}set visible(e){this._set("visible",e),Object(a["k"])(this.analysisView)&&(this.analysisView.visible=e)}async start(){this.clear();const e={task:null,abort:null,state:n.PENDING},t=Object(o["e"])(async t=>{e.state=n.WAIT_FOR_VIEW_READY,await Object(c["h"])(()=>this.ready,t),e.state=n.RUNNING,this.createTool({interactive:!0})});return e.task=t,e.abort=()=>t.abort(),this._startUserOperation=e,t.promise}clear(){this._startUserOperation=Object(a["a"])(this._startUserOperation),this.removeTool(),this.analysis.clear()}onConnectToAnalysisView(e){}onDisconnectFromAnalysisView(){}_scheduleViewReconnect(){this._reconnectViewTask=Object(a["a"])(this._reconnectViewTask);const e=Object(o["e"])(async t=>{try{await this._reconnectView(t)}catch(i){if(Object(o["p"])(t),!Object(o["j"])(i))return void this.logger.warn("Failed to use analysis in view model",i);throw i}finally{e===this._reconnectViewTask&&(this._reconnectViewTask=null)}});this._reconnectViewTask=e}async _reconnectView(e){const{view:t}=this,i=Object(a["k"])(t)&&t.ready&&this.supported,n=this.analysis;if(this._startUserOperation=b(this._startUserOperation),this._disconnectFromView(t),i&&!Object(a["j"])(t)&&!Object(a["j"])(n)){if(this.isAnalysisOwner){if(Object(a["k"])(n.parent))return void this.logError("expected owned analysis to have null parent when connecting to view");this._parentChangeFromReconnect=!0,t.analyses.add(n)}this.analysisView=await t.whenAnalysisView(n),Object(o["k"])(e)?this._startUserOperation=b(this._startUserOperation):(this.analysisView.visible=this.visible,this.onConnectToAnalysisView(this.analysisView),this.createTool())}}_disconnectFromView(e){this.removeTool(),Object(a["k"])(e)&&this.isAnalysisOwner&&(this._parentChangeFromReconnect=!0,e.analyses.remove(this.analysis),this.analysis.clear()),this.analysisView=null,this.onDisconnectFromAnalysisView()}_setExternalAnalysis(e){if(Object(a["k"])(this.analysisView)&&!this.isAnalysisOwner&&(this.analysisView.visible=!0),this.analysisView=null,this._set("isAnalysisOwner",!1),this._set("analysis",e),this._parentChangeFromReconnect=!1,!e.isEditable){const t=e.nonEditableMessage;this.logger.warn(`The assigned ${e.type} analysis object will not be editable in the view. ${t}`)}}get testInfo(){return{analysisView:this.analysisView}}};function b(e){return Object(a["k"])(e)&&e.state>=n.RUNNING?(e.abort(),null):e}Object(r["a"])([Object(l["b"])({nonNullable:!0})],d.prototype,"analysis",null),Object(r["a"])([Object(l["b"])()],d.prototype,"analysisView",void 0),Object(r["a"])([Object(l["b"])()],d.prototype,"ready",null),Object(r["a"])([Object(l["b"])()],d.prototype,"connectingToView",null),Object(r["a"])([Object(l["b"])({readOnly:!0})],d.prototype,"isAnalysisOwner",null),Object(r["a"])([Object(l["b"])({type:Boolean,value:!0})],d.prototype,"visible",null),Object(r["a"])([Object(l["b"])()],d.prototype,"_reconnectViewTask",void 0),d=Object(r["a"])([Object(h["a"])("esri.widgets.support.InteractiveAnalysisViewModel")],d)},ea32:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("62ae"),r=i("52b2");class s extends n["a"]{constructor(e,t){super(e,"vec3",r["a"].Pass,(i,n,r)=>i.setUniform3fv(e,t(n,r)))}}},f53a:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("477c");class r{constructor(e){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=e,this._handle=Object(n["f"])(()=>this.view.ready,e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources())})}applyProps(e){let t=!1;for(const i in e)i in this?"attached"===i?t=e[i]:this[i]=e[i]:console.error("Cannot set unknown property",i);this.attached=t}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}},fa1e:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("b7bd");const r=new Map([[n["a"].POSITION,0],[n["a"].NORMAL,1],[n["a"].UV0,2],[n["a"].COLOR,3],[n["a"].SIZE,4],[n["a"].TANGENT,4],[n["a"].AUXPOS1,5],[n["a"].SYMBOLCOLOR,5],[n["a"].AUXPOS2,6],[n["a"].FEATUREATTRIBUTE,6],[n["a"].INSTANCEFEATUREATTRIBUTE,6],[n["a"].INSTANCECOLOR,7],[n["a"].MODEL,8],[n["a"].MODELNORMAL,12],[n["a"].MODELORIGINHI,11],[n["a"].MODELORIGINLO,15]])},fd48:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("62ae"),r=i("52b2");class s extends n["a"]{constructor(e,t){super(e,"vec4",r["a"].Pass,(i,n,r)=>i.setUniform4fv(e,t(n,r)))}}}}]);
//# sourceMappingURL=chunk-3a6c8cc3.bb079dc7.js.map