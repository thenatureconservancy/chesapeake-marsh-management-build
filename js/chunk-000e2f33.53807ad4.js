(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-000e2f33"],{1803:function(e,t,i){"use strict";i.r(t),i.d(t,"DrawGraphicTool2D",(function(){return g}));var a=i("a4ee"),r=(i("e06a"),i("8d60")),s=i("c649"),n=i("b2b2"),l=i("59b2"),c=(i("b50f"),i("c120"),i("cea0"),i("d386")),o=i("1381"),h=(i("1fd7"),i("4cac")),p=i("4dc9");const u=new h["a"]({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[3.75,3.75],lineDashEnding:"HalfPattern",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:1.6,color:[255,255,255,255]},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:2,color:[0,0,0,255]}]}}}),b=new p["a"]({style:"circle",size:6,color:[127,127,127,1],outline:{color:[50,50,50],width:1}}),d=new p["a"]({style:"circle",size:6,color:[255,127,0,1],outline:{color:[50,50,50],width:1}});var y=i("ae3c"),O=i("e7e3"),m=i("5bab"),v=i("4ae5"),j=i("57dc");let g=class extends y["a"]{constructor(e){super(e),this._visualElementGraphics={outline:null,regularVertices:null,activeVertex:null},this.activeFillSymbol=null,this.type="draw-2d",this._visualElementSymbols={outline:Object(n["s"])(e.activeLineSymbol,u),regularVertices:Object(n["s"])(e.regularVerticesSymbol,b),activeVertex:Object(n["s"])(e.activeVertexSymbol,d),fill:Object(n["r"])(e.activeFillSymbol)}}normalizeCtorArgs(e){const t={...e};return delete t.activeFillSymbol,delete t.activeVertexSymbol,delete t.regularVerticesSymbol,delete t.activeLineSymbol,t}initializeGraphic(e){return Object(n["k"])(this._visualElementSymbols.fill)&&(e.symbol=this._visualElementSymbols.fill),null}makeDrawOperation(){const e=this.view;return new O["a"]({view:e,manipulators:this.manipulators,geometryType:Object(y["b"])(this.geometryType),drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:new m["b"](e),hasM:!1,snappingManager:this.snappingManager,snappingVisualizer:new o["a"](this.internalGraphicsLayer)})}onActiveVertexChanged(e){if("point"===this.geometryType)return null;const[t,i]=e,a=new v["a"]({x:t,y:i,spatialReference:this.view.spatialReference});return Object(n["k"])(this._visualElementGraphics.activeVertex)?(this._visualElementGraphics.activeVertex.geometry=a,null):(this._visualElementGraphics.activeVertex=new r["a"]({geometry:a,symbol:this._visualElementSymbols.activeVertex,attributes:{displayOrder:2}}),this.internalGraphicsLayer.add(this._visualElementGraphics.activeVertex),this.internalGraphicsLayer.graphics.sort(f),Object(s["c"])(()=>{Object(n["k"])(this._visualElementGraphics.activeVertex)&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.activeVertex),this._visualElementGraphics.activeVertex=Object(n["d"])(this._visualElementGraphics.activeVertex))}))}onOutlineChanged(e){const t=e.clone();if("polyline"===t.type){const e=t.paths[t.paths.length-1];e.splice(0,e.length-2)}return Object(n["k"])(this._visualElementGraphics.outline)?(this._visualElementGraphics.outline.geometry=t,null):(this._visualElementGraphics.outline=new r["a"]({geometry:t,symbol:this._visualElementSymbols.outline,attributes:{displayOrder:0}}),this.internalGraphicsLayer.add(this._visualElementGraphics.outline),this.internalGraphicsLayer.graphics.sort(f),Object(s["c"])(()=>{Object(n["k"])(this._visualElementGraphics.outline)&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.outline),this._visualElementGraphics.outline=Object(n["d"])(this._visualElementGraphics.outline))}))}onRegularVerticesChanged(e){const t=new j["a"]({points:e,spatialReference:this.view.spatialReference});return Object(n["k"])(this._visualElementGraphics.regularVertices)?(this._visualElementGraphics.regularVertices.geometry=t,null):(this._visualElementGraphics.regularVertices=new r["a"]({geometry:t,symbol:this._visualElementSymbols.regularVertices,attributes:{displayOrder:1}}),this.internalGraphicsLayer.add(this._visualElementGraphics.regularVertices),this.internalGraphicsLayer.graphics.sort(f),Object(s["c"])(()=>{Object(n["k"])(this._visualElementGraphics.regularVertices)&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.regularVertices),this._visualElementGraphics.regularVertices=Object(n["d"])(this._visualElementGraphics.regularVertices))}))}};function f(e,t){var i,a,r,s;return(null!=(i=null==(a=e.attributes)?void 0:a.displayOrder)?i:-1/0)-(null!=(r=null==(s=t.attributes)?void 0:s.displayOrder)?r:-1/0)}Object(a["a"])([Object(l["b"])()],g.prototype,"activeFillSymbol",void 0),Object(a["a"])([Object(l["b"])({readOnly:!0})],g.prototype,"type",void 0),Object(a["a"])([Object(l["b"])({constructOnly:!0,nonNullable:!0})],g.prototype,"view",void 0),g=Object(a["a"])([Object(c["a"])("esri.views.2d.interactive.draw.DrawGraphicTool2D")],g)},ae3c:function(e,t,i){"use strict";i.d(t,"a",(function(){return T})),i.d(t,"b",(function(){return U}));var a=i("a4ee"),r=i("8d60"),s=(i("c120"),i("ce6d")),n=i("9096"),l=i("c649"),c=i("b2b2"),o=i("59b2"),h=i("b50f"),p=(i("cea0"),i("d386")),u=i("ce0b"),b=(i("e06a"),i("7ffa")),d=i("8048"),y=i("b48e"),O=i("ea51"),m=i("32ed"),v=i("7f83"),j=i("a545"),g=i("57dc"),f=i("4ae5"),x=i("521c"),w=i("1219");function _(e,t){const i=new f["a"]({x:e[0],y:e[1],spatialReference:t});return e.length>2&&(i.z=e[2]),i}function V(e,t){return new g["a"]({points:e,spatialReference:t})}function G(e,t,i){const a=new x["a"]({paths:e,spatialReference:t});return i&&Object(m["j"])(a),a}function M(e,t,i,a=!0){const r=Object(b["a"])(e);r.forEach(e=>{const t=e[0],i=e[e.length-1];Object(h["d"])(t,i)&&1!==e.length||e.push(e[0])});let s=new w["a"]({rings:r,spatialReference:t});return s.rings.forEach(e=>{Object(m["h"])(e,!1,!1)||e.reverse()}),i&&Object(m["j"])(s),a&&s.isSelfIntersecting&&Object(v["l"])(t)&&(s=Object(O["simplify"])(s)),s}function S(e,t,i){const a=t.mapToLocalMultiple(e),r=[],s={x:a[0].x,y:a[0].y},n={x:a[1].x,y:a[1].y},l=Math.round(n.x-s.x),o=Math.round(n.y-s.y),h=Math.max(Math.abs(l),Math.abs(o));if(i){const e={x:s.x+h,y:s.y+h},t={x:s.x-h,y:s.y-h};r.push(Object(j["b"])(e.x,t.y),Object(j["b"])(t.x,t.y),Object(j["b"])(t.x,e.y),Object(j["b"])(e.x,e.y))}else{const e={x:l>0?s.x+h:s.x-h,y:o>0?s.y+h:s.y-h};r.push(Object(j["b"])(s.x,s.y),Object(j["b"])(e.x,s.y),Object(j["b"])(e.x,e.y),Object(j["b"])(s.x,e.y))}return M([Object(c["g"])(r.map(e=>t.localToMap(e)))],t.spatialReference,t.doUnnormalization,!0)}function E(e,t,i){let a=t.mapToLocalMultiple(e);if(1===a.length){const e=48,t=a[0];a=[Object(j["b"])(t.x-e,t.y+e),Object(j["b"])(t.x+e,t.y-e),Object(j["b"])(t.x+e,t.y-e),Object(j["b"])(t.x-e,t.y+e)]}const r=[],s={x:a[0].x,y:a[0].y},n={x:a[1].x,y:a[1].y};if(i){const e=Math.round(n.x-s.x),t=Math.round(n.y-s.y);r.push(Object(j["b"])(s.x-e,s.y-t),Object(j["b"])(n.x,s.y-t),Object(j["b"])(n.x,n.y),Object(j["b"])(s.x-e,n.y))}else r.push(Object(j["b"])(s.x,s.y),Object(j["b"])(n.x,s.y),Object(j["b"])(n.x,n.y),Object(j["b"])(s.x,n.y));return M([Object(c["g"])(r.map(e=>t.localToMap(e)))],t.spatialReference,t.doUnnormalization,!0)}function k(e,t,i,a){const r=t.mapToLocalMultiple(e);let s=null,n=null;if(i)s=r[0],n=r[1];else{const e=r[0],t=r[1],i=Math.round(t.x-e.x),a=Math.round(t.y-e.y),l=Math.max(Math.abs(i),Math.abs(a));s=Object(j["b"])(i>0?e.x+l/2:e.x-l/2,a>0?e.y+l/2:e.y-l/2),n=Object(j["b"])(Math.abs(i)>Math.abs(a)?s.x-l/2:s.x,Math.abs(i)>Math.abs(a)?s.y:s.y-l/2)}const l=t.localToMap(s),o=t.localToMap(n);if(Object(c["j"])(l)||Object(c["j"])(o))return null;t.doUnnormalization&&Object(m["k"])([[l,o]],t.spatialReference);const h=_(l,t.spatialReference),p=_(o,t.spatialReference),u=Object(d["f"])(t.spatialReference);let b=0;if(Object(v["l"])(t.spatialReference))b=u*Object(O["distance"])(h,p,null);else{const e=s.x-n.x,t=s.y-n.y;b=u*Math.sqrt(e*e+t*t)*(a||1)}const g=new y["a"]({center:h,radius:b,radiusUnit:"meters",spatialReference:t.spatialReference});return M(g.rings,g.spatialReference,!1)}function C(e,t,i){const a=t.mapToLocalMultiple(e),r=a[0],s=a[1],n=Math.round(s.x-r.x),l=Math.round(s.y-r.y),o=Object(j["b"])(i?r.x:r.x+n/2,i?r.y:r.y+l/2),h=i?n:n/2,p=i?l:l/2,u=60,b=[],d=2*Math.PI/u;for(let c=0;c<u;c++){const e=Math.cos(c*d),t=Math.sin(c*d),i=Object(j["b"])(h*e+o.x,p*t+o.y);b.push(i)}return b.push(b[0]),M([Object(c["g"])(b.map(e=>t.localToMap(e)))],t.spatialReference,t.doUnnormalization,!1)}var R=i("4772");let T=class extends(Object(n["b"])(s["a"].EventedMixin(R["a"]))){constructor(e){super(e),this._graphic=null,this.defaultZ=0,this.geometryType=null,this.hasZ=!0,this.mode=null,this.snappingManager=null,this.snapToScene=!1}initialize(){this.internalGraphicsLayer=new u["a"]({listMode:"hide",internal:!0}),this.view.map.layers.add(this.internalGraphicsLayer),this.drawOperation=this.makeDrawOperation(),this.handles.add([this.drawOperation.on("vertex-add",e=>this.onVertexAdd(e)),this.drawOperation.on("vertex-remove",e=>this.onVertexRemove(e)),this.drawOperation.on("vertex-update",e=>this.onVertexUpdate(e)),this.drawOperation.on("cursor-update",e=>this.onCursorUpdate(e)),this.drawOperation.on("complete",e=>this.onComplete(e))]),this.finishToolCreation()}destroy(){this.drawOperation=Object(c["d"])(this.drawOperation),this._destroyAllVisualisations(),this.view.map.remove(this.internalGraphicsLayer),this.internalGraphicsLayer=Object(c["d"])(this.internalGraphicsLayer),this._set("view",null)}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centered(e){this._set("centered",e),this._updateGraphic()}set enabled(e){this.drawOperation.interactive=e,this._set("enabled",e)}set forceUniformSize(e){this._set("forceUniformSize",e),this._updateGraphic()}get graphic(){return this._graphic}set graphicSymbol(e){this._set("graphicSymbol",e),Object(c["k"])(this._graphic)&&(this._graphic.symbol=e)}get updating(){var e,t;return null!=(e=null==(t=this.drawOperation)?void 0:t.updating)&&e}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(e){this.drawOperation.onInputEvent(e)}redo(){this.drawOperation.redo()}reset(){}undo(){this.drawOperation.undo()}_createGraphic(e){this._graphic=new r["a"]({...this.graphicProperties,geometry:e,symbol:this.graphicSymbol}),this.internalGraphicsLayer.add(this._graphic),this.handles.add(this.initializeGraphic(this._graphic)),this.notifyChange("graphic"),this.handles.add(Object(l["c"])(()=>{Object(c["k"])(this._graphic)&&(this.internalGraphicsLayer.remove(this._graphic),this._graphic=Object(c["d"])(this._graphic))}),L)}_destroyAllVisualisations(){this.handles.remove(z.outline),this.handles.remove(z.regularVertices),this.handles.remove(z.activeVertex),this.handles.remove(L)}_getCreateOperationGeometry(e={operationComplete:!1}){if(null==this.drawOperation||0===this.drawOperation.numVertices)return null;const t=this.drawOperation.stagedVertex,i=this.drawOperation.committedVertices,a=i.slice();Object(c["k"])(t)&&a.push(this.drawOperation.coordinateHelper.pointToArray(t));const r=Object(c["k"])(t)?this.drawOperation.coordinateHelper.pointToArray(t):i.splice(-1)[0],s={regularVertices:null,activeVertex:null,full:null,outline:null},n=a.length,l=this.view.spatialReference,o="3d"===this.view.type&&"global"===this.view.viewingMode;switch(this.geometryType){case"point":s.regularVertices=i,s.activeVertex=r,s.full=this.drawOperation.coordinateHelper.arrayToPoint(a[0]);break;case"multipoint":s.regularVertices=i,s.activeVertex=r,n>0&&(s.full=V(a,l));break;case"polyline":s.regularVertices=i,s.activeVertex=r,n>0&&(s.full=G([a],l,o));break;case"polygon":s.regularVertices=i,s.activeVertex=r,n>0&&(s.full=M([a],l,o,!0));break;case"circle":if(n>0){const t=Object(j["a"])(this.view,a[0]);if(1===n&&e.operationComplete){const e=a[0],i=t.makeMapPoint(e[0]+A*this.view.resolution,e[1]);s.full=k([e,i],t,!0)}else 2===n&&(s.full=this.forceUniformSize?k(a,t,this.centered):C(a,t,this.centered))}break;case"rectangle":if(n>0){const t=Object(j["a"])(this.view,a[0]);if(1===n&&e.operationComplete){const e=a[0],i=t.makeMapPoint(e[0]+A*this.view.resolution,e[1]);s.full=S([e,i],t,!0)}else 2===n&&(s.full=this.forceUniformSize?S(a,t,this.centered):E(a,t,this.centered))}break;default:return null}switch(this.geometryType){case"point":case"multipoint":break;case"polyline":case"polygon":n>1&&(s.outline=G([a],l,o));break;case"circle":case"rectangle":Object(c["k"])(s.full)&&"polygon"===s.full.type&&(s.outline=M(s.full.rings,l,o))}return s}initializeGraphic(e){return null}onComplete(e){this._updateGraphic();let t=null;if(this.drawOperation.isCompleted){const e=this._getCreateOperationGeometry({operationComplete:!0});Object(c["k"])(e)&&(Object(c["j"])(this._graphic)?this._createGraphic(e.full):this._graphic.geometry=e.full,t=Object(c["r"])(this._graphic).clone())}this.emit("complete",{graphic:t,...e})}onCursorUpdate(e){this._updateGraphic(),this.emit("cursor-update",e)}onDeactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel()}onVertexAdd(e){this._updateGraphic(),this.emit("vertex-add",e)}onVertexRemove(e){this._updateGraphic(),this.emit("vertex-remove",e)}onVertexUpdate(e){this._updateGraphic(),this.emit("vertex-update",e)}_updateGraphic(){const e=this._getCreateOperationGeometry();Object(c["j"])(e)?this._destroyAllVisualisations():(Object(c["k"])(e.outline)?this.handles.add(this.onOutlineChanged(e.outline),z.outline):this.handles.remove(z.outline),Object(c["k"])(e.regularVertices)?this.handles.add(this.onRegularVerticesChanged(e.regularVertices),z.regularVertices):this.handles.remove(z.regularVertices),Object(c["k"])(e.activeVertex)?this.handles.add(this.onActiveVertexChanged(e.activeVertex),z.activeVertex):this.handles.remove(z.activeVertex),Object(c["k"])(e.full)?Object(c["j"])(this._graphic)?this._createGraphic(e.full):this._graphic.geometry=e.full:this.handles.remove(L))}};Object(a["a"])([Object(o["b"])({value:!0})],T.prototype,"centered",null),Object(a["a"])([Object(o["b"])({nonNullable:!0})],T.prototype,"defaultZ",void 0),Object(a["a"])([Object(o["b"])()],T.prototype,"drawOperation",void 0),Object(a["a"])([Object(o["b"])({value:!0})],T.prototype,"enabled",null),Object(a["a"])([Object(o["b"])({value:!0})],T.prototype,"forceUniformSize",null),Object(a["a"])([Object(o["b"])({constructOnly:!0})],T.prototype,"geometryType",void 0),Object(a["a"])([Object(o["b"])()],T.prototype,"graphic",null),Object(a["a"])([Object(o["b"])({constructOnly:!0})],T.prototype,"graphicProperties",void 0),Object(a["a"])([Object(o["b"])()],T.prototype,"graphicSymbol",null),Object(a["a"])([Object(o["b"])({constructOnly:!0})],T.prototype,"hasZ",void 0),Object(a["a"])([Object(o["b"])({constructOnly:!0})],T.prototype,"mode",void 0),Object(a["a"])([Object(o["b"])()],T.prototype,"snappingManager",void 0),Object(a["a"])([Object(o["b"])()],T.prototype,"snapToScene",void 0),Object(a["a"])([Object(o["b"])({readOnly:!0})],T.prototype,"type",void 0),Object(a["a"])([Object(o["b"])({readOnly:!0})],T.prototype,"updating",null),Object(a["a"])([Object(o["b"])({constructOnly:!0,nonNullable:!0})],T.prototype,"view",void 0),T=Object(a["a"])([Object(p["a"])("esri.views.draw.DrawGraphicTool")],T);const L="create-operation-graphic",z={outline:"outline-visual",regularVertices:"regular-vertices-visual",activeVertex:"active-vertex-visual"};function U(e){switch(e){case"point":case"polyline":case"polygon":case"multipoint":return e;case"circle":case"rectangle":return"segment";default:return null}}const A=48}}]);
//# sourceMappingURL=chunk-000e2f33.53807ad4.js.map